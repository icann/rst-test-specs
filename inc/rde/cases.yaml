rde-01:
  Summary: validate deposit filename format
  Maturity: BETA
  Description: |
    * The deposit filename **MUST** conform to the format specified in the RA.
    * The type of the deposit **MUST** be `FULL`.
    * The TLD in the filename **MUST** be present in the list of TLDs
      associated with the test.
  Errors:
    - RDE_INVALID_FILENAME
rde-02:
  Summary: validate signature over deposit file
  Maturity: BETA
  Description: |
    The PGP signature **MUST** be valid for the deposit file and the RSP's
    key.
  Input-Parameters:
    - rde.publicKey
    - rde.signatureFile
  Errors:
    - RDE_INVALID_SIGNATURE
rde-03:
  Summary: decrypt deposit file(s)
  Maturity: BETA
  Description: |
    It **MUST** be possible to decrypt the deposit file using the RST key. The
    PGP public key for which the deposit **MUST** be encrypted may be found in
    the URL specified by the `rde.encryptionKey` resource.
  Resources:
    - rde.encryptionKey
  Errors:
    - RDE_DECRYPTION_FAILED
rde-04:
  Summary: validate XML/CSV
  Maturity: BETA
  Description: |
    * XML deposit files **MUST** be well-formed and validate against the XML
      schema.
    * CSV files **MUST** conform to RFC 4180.
    * Deposits **MUST NOT** contain a mix of XML and CSV files for the deposit
      contents.
  Errors:
    - RDE_INVALID_XML
    - RDE_INVALID_CSV
    - RDE_MIXED_TYPES
rde-05:
  Summary: validate object types
  Maturity: BETA
  Description: |
    The header object **MUST** reference the correct object XML namespace
    URIs.

    The correct URIs is determined by the `general.minimalPublicDataSet` and
    `epp.hostModel` input parameters.

    * if the `general.minimalPublicDataSet` input parameter is `true`, then the
      contact URI **MUST** be present. If the value is `false`, then it **MUST
      NOT** be present.

    * if the `epp.hostModel` input parameter is `true`, then the host URI
      **MUST** be present. If the value is `false`, then it **MUST NOT** be
      present.

    All expected URIs **MUST** be present in the header, and the header **MUST
    NOT** contain any unexpected URIs.
  Errors:
    - RDE_UNEXPECTED_OBJECT_URI
    - RDE_MISSING_OBJECT_URI

rde-06:
  Summary: validate object counts
  Maturity: BETA
  Description: |
    The number of each type of object **MUST** match the number of objects
    actually present in the deposit file.
  Errors:
    - RDE_OBJECT_COUNT_MISMATCH

rde-07:
  Summary: validate domain objects
  Maturity: BETA
  Description: |
    Domain objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    The required properties are:

    * `<domain:name>`
    * `<domain:roid>` (which **MUST** have a repository ID registered with
      IANA)
    * at least one `<domain:status>` element
    * `<domain:registrant>` (if `general.minimalPublicDataSet` is `false`)
    * `<domain:clID>` (sponsoring registrar ID)
    * `<domain:crDate>` (creation date)
    * `<domain:exDate>` (expiry date)

    Contact, host and registrar objects (including optional objects such as
    admin and tech contacts) which are referenced in domain objects **MUST**
    be present in the deposit.
  Errors:
    - RDE_DOMAIN_HAS_MISSING_NAME
    - RDE_DOMAIN_HAS_INVALID_NAME
    - RDE_DOMAIN_HAS_MISSING_ROID
    - RDE_DOMAIN_HAS_INVALID_ROID
    - RDE_DOMAIN_HAS_MISSING_STATUS
    - RDE_DOMAIN_HAS_INVALID_STATUS
    - RDE_DOMAIN_HAS_MISSING_REGISTRANT
    - RDE_DOMAIN_HAS_INVALID_REGISTRANT
    - RDE_DOMAIN_HAS_MISSING_CLID
    - RDE_DOMAIN_HAS_INVALID_CLID
    - RDE_DOMAIN_HAS_MISSING_CRDATE
    - RDE_DOMAIN_HAS_INVALID_CRDATE
    - RDE_DOMAIN_HAS_MISSING_EXDATE
    - RDE_DOMAIN_HAS_INVALID_EXDATE

rde-08:
  Summary: validate host objects (if applicable)
  Maturity: BETA
  Description: |
    Host objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    The required properties are:

    * `<host:name>`
    * `<host:roid>` (which **MUST** have a repository ID registered with
      IANA)
    * at least one `<domain:status>` element
    * one or more `<addr>` elements (if the host name is subordinate to
      the TLD)
    * `<host:clID>` (sponsoring registrar ID)

    If the applicant uses the host attribute model, then this test will be
    skipped.

    Registrar objects which are referenced in host objects **MUST**
    be present in the deposit.
  Errors:
    - RDE_HOST_HAS_MISSING_NAME
    - RDE_HOST_HAS_INVALID_NAME
    - RDE_HOST_HAS_MISSING_ROID
    - RDE_HOST_HAS_INVALID_ROID
    - RDE_HOST_HAS_MISSING_STATUS
    - RDE_HOST_HAS_INVALID_STATUS
    - RDE_HOST_HAS_MISSING_IP_ADDRESS
    - RDE_HOST_HAS_INVALID_IP_ADDRESS
    - RDE_HOST_HAS_MISSING_CLID
    - RDE_HOST_HAS_INVALID_CLID

rde-09:
  Summary: validate contact objects (if applicable)
  Maturity: BETA
  Description: |
    Contact objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    The required properties are:

    * `<contact:id>`
    * `<contact:roid>` (which **MUST** have a repository ID registered with
      IANA)
    * at least one `<contact:status>` element
    * 1-2 `<contact:postalInfo>` elements containing the following:
        * a "type" attribute of "int" or "loc"
        * `<contact:name>` element
        * an `<contact:addr>` element containing the following:
          * at least one 1 `<contact:street>` element
          * `<contact:city>` element
          * `<contact:cc>` element
    * `<contact:voice>`
    * `<contact:email>`
    * `<contact:clID>` (sponsoring registrar ID)

    If the value of the `general.minimalPublicDataSet` input parameter is
    `true`, then this test will be skipped.

    Registrar objects which are referenced in contact objects **MUST**
    be present in the deposit.
  Errors:
    - RDE_CONTACT_HAS_MISSING_ID
    - RDE_CONTACT_HAS_INVALID_ID
    - RDE_CONTACT_HAS_MISSING_ROID
    - RDE_CONTACT_HAS_INVALID_ROID
    - RDE_CONTACT_HAS_MISSING_STATUS
    - RDE_CONTACT_HAS_INVALID_STATUS
    - RDE_CONTACT_HAS_MISSING_POSTALINFO
    - RDE_CONTACT_HAS_INVALID_POSTALINFO_TYPE
    - RDE_CONTACT_HAS_MISSING_NAME
    - RDE_CONTACT_HAS_INVALID_NAME
    - RDE_CONTACT_HAS_MISSING_STREET
    - RDE_CONTACT_HAS_INVALID_STREET
    - RDE_CONTACT_HAS_MISSING_CITY
    - RDE_CONTACT_HAS_INVALID_CITY
    - RDE_CONTACT_HAS_MISSING_CC
    - RDE_CONTACT_HAS_INVALID_CC
    - RDE_CONTACT_HAS_MISSING_VOICE
    - RDE_CONTACT_HAS_INVALID_VOICE
    - RDE_CONTACT_HAS_MISSING_EMAIL
    - RDE_CONTACT_HAS_INVALID_EMAIL
    - RDE_CONTACT_HAS_MISSING_CLID
    - RDE_CONTACT_HAS_INVALID_CLID
rde-10:
  Summary: validate registrar objects
  Maturity: BETA
  Description: |
    Registrar objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    The required properties are:

    * `<rdeRegistrar:id>`
    * `<rdeRegistrar:name>`
    * `<rdeRegistrar:gurid>` (IANA ID)
  Errors:
    - RDE_REGISTRAR_HAS_MISSING_ID
    - RDE_REGISTRAR_HAS_INVALID_ID
    - RDE_REGISTRAR_HAS_MISSING_NAME
    - RDE_REGISTRAR_HAS_INVALID_NAME
    - RDE_REGISTRAR_HAS_MISSING_GURID
    - RDE_REGISTRAR_HAS_INVALID_GURID
rde-11:
  Summary: validate IDN table objects (if applicable)
  Maturity: BETA
  Description: |
    IDN table objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    All IDN table objects present in the deposit **MUST** correspond to IDN
    tables approved for the TLD, and all approved tables **MUST** have a
    corresponding object in the deposit.
  Errors:
    - RDE_IDN_OBJECT_INVALID
    - RDE_IDN_OBJECT_MISSING
    - RDE_IDN_OBJECT_UNEXPECTED
rde-12:
  Summary: validate NNDN objects
  Maturity: BETA
  Description: |
    NNDN table objects (whether CSV or XML) **MUST** have the required object
    properties, and the values of those object properties **MUST** be
    well-formed.

    The `aName` property of NNDN objects **MUST NOT** match the `name`
    property of a domain object.
  Errors:
    - RDE_NNDN_CONFLICTS_WITH_DOMAIN

rde-13:
  Summary: validate EPP parameters object
  Maturity: BETA
  Description: |
    The EPP Parameters object **MUST** match the `<greeting>` element returned
    by the EPP server.
  Resources:
    - epp.clientCertificate
    - epp.clientCSR
    - epp.clientACL
  Input-Parameters:
    - epp.hostName
    - epp.clid01
    - epp.pwd01
    - epp.serverIssuedClientCertificate01
  Errors:
    - RDE_GREETING_DOES_NOT_MATCH_EPP_SERVER
rde-14:
  Summary: validate policy object (if applicable)
  Maturity: BETA
  Description: |
    The object policies included in the `<rdePolicy:policy>` object **MUST**
    conform to the Registration Data Policy and the applicable data model.

    * If the `general.minimalPublicDataSet` input parameter is `true`, then
      contact objects **MUST NOT** be present in the deposit.
    * If the `epp.hostModel` input parameter is `attributes`, then
      host objects **MUST NOT** be present in the deposit.
  Errors:
    - RDE_POLICY_OBJECT_MISSING
    - RDE_POLICY_OBJECT_INVALID
    - RDE_POLICY_OBJECT_MISSING_OBJECTS
    - RDE_POLICY_OBJECT_UNEXPECTED_OBJECTS
