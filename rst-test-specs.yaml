---
RST-Test-Plan: 1.0
Version: 3.0
Last-Updated: 2023-09-27

Preamble: |
  The Test System consists of several *test plans*, each of which addresses a
  particular scenario. The test plans follow a standard structure and
  methodology derived from IEEE 829-2008 *(which has since been superseded by
  ISO/IEC 29119)*.

  Each *test plan* includes one or more *test suites* which in turn include
  one or more *test cases*. For a test to succeed, every test case has to pass.

  This file describes each test plan, suite and case in the RST system.

  ### 2.1. Key Acronyms

  RST
  : Registry System Testing

  PDT
  : Pre-Delegation Testing

  RSP
  : Registry Service Provider

  DNS
  : Domain Name System

  TLD
  : Top-level domain

  gTLD
  : generic top-level domain

  DNSSEC
  : DNS Security Extensions

  EPP
  : Extensible Provisioning Protocol

  SRS
  : Shared Registry System

  RDDS
  : Registration Data Directory Services

  RDAP
  : Registration Data Access Protocol

  RDE
  : Registry Data Escrow

  IDN
  : Internationalized Domain Name

  LGR
  : Label Generation Ruleset

  ### 2.2. Note about DNS and DNSSEC test suites

  The DNS and DNSSEC test plans are taken from the test plans that are part of
  the [Zonemaster software](https://github.com/zonemaster) (`Zonemaster::Engine`
  version v4.7.3). Test case IDs from this document can be mapped to the
  Zonemaster test IDs by removing the `dns-` or `dnssec-` prefix.

  Since Zonemaster is designed to perform testing of domain names anywhere in
  the DNS hierarchy, not all Zonemaster tests are applicable for TLDs and may
  not be listed in the test suites in this document.

  ### 2.3. Note about RDAP test suite

  The RDAP test suite is derived from the test specification of the [RDAP
  Conformance Tool](https://github.com/icann/rdap-conformance-tool/blob/master/doc/RDAPConformanceToolSpecifications.pdf).
  As with the DNS and DNSSEC tests, the test IDs can be mapped to the test IDs
  in this document by removing the `rdap-` prefix.

Contact:
  Name: GDS Technical Services
  Organization: Internet Corporation for Assigned Names and Numbers (ICANN)
  Email: rst@icann.org

Plans:
  StandardPreDelegationTest:
    Order: 1
    Name: Standard Pre-Delegation Test Plan
    Description: |
      The purpose of the Pre-Delegation Test is to verify that the applicant has
      met its commitment to establish registry operations in accordance with the
      technical and operational criteria described in the gTLD Applicant
      Guidebook (AGB). Each applicant will be required to complete PDT as a
      prerequisite to delegation into the root zone.

      The Pre-Delegation Test covers all critical registry services and IDNs,
      and therefore uses all test suites.

    Test-Suites:
      DNS:
        - dns-address01
        - dns-address02
        - dns-address03
        - dns-connectivity01
        - dns-connectivity02
        - dns-connectivity03
        - dns-connectivity04
        - dns-consistency01
        - dns-consistency02
        - dns-consistency03
        - dns-consistency04
        - dns-consistency05
        - dns-consistency06
        - dns-delegation01
        - dns-delegation02
        - dns-delegation03
        - dns-delegation04
        - dns-delegation05
        - dns-delegation06
        - dns-nameserver01
        - dns-nameserver02
        - dns-nameserver04
        - dns-nameserver05
        - dns-nameserver06
        - dns-nameserver07
        - dns-nameserver08
        - dns-nameserver09
        - dns-nameserver10
        - dns-nameserver11
        - dns-nameserver12
        - dns-nameserver13
        - dns-syntax05
        - dns-syntax06
        - dns-syntax07
        - dns-zone01
        - dns-zone02
        - dns-zone03
        - dns-zone04
        - dns-zone05
        - dns-zone06
        - dns-zone07
        - dns-zone10

      DNSSEC:
        - dnssec01
        - dnssec02
        - dnssec03
        - dnssec04
        - dnssec05
        - dnssec06
        - dnssec07
        - dnssec08
        - dnssec09
        - dnssec10
        - dnssec11
        - dnssec13
        - dnssec14
        - dnssec15
        - dnssec16
        - dnssec17
        - dnssec18

      RDDS:
        - rdap-ipv4Validation
        - rdap-ipv6Validation
        - rdap-domainNameValidation
        - rdap-webUriValidation
        - rdap-domainCaseFoldingValidation
        - rdap-Standard RDAP Common Data Structures Validations
        - rdap-stdRdapConformanceValidation
        - rdap-stdRdapLinksValidation
        - rdap-stdRdapNoticesRemarksValidation
        - rdap-stdRdapLanguageIdentifierValidation
        - rdap-stdRdapEventsValidation
        - rdap-stdRdapStatusValidation
        - rdap-stdRdapPort43WhoisServerValidation
        - rdap-stdRdapPublicIdsValidation
        - rdap-stdRdapAsEventActorValidation
        - rdap-stdRdapIpAddressesValidation
        - rdap-stdRdapVariantsValidation
        - rdap-stdRdapUnicodeNameValidation
        - rdap-stdRdapLdhNameValidation
        - rdap-stdRdapRolesValidation
        - rdap-stdRdapEntitiesValidation
        - rdap-stdRdapSecureDnsValidation
        - rdap-stdRdapErrorResponseBodyValidation
        - rdap-stdRdapDomainLookupValidation
        - rdap-stdRdapEntityLookupValidation
        - rdap-stdRdapNameserverLookupValidation
        - rdap-stdRdapHelpValidation
        - rdap-stdRdapNameserversSearchValidation
        - rdap-tigSection_1_2_Validation
        - rdap-tigSection_1_3_Validation
        - rdap-tigSection_1_6_Validation
        - rdap-tigSection_1_8_Validation
        - rdap-tigSection_1_13_Validation
        - rdap-tigSection_1_14_Validation
        - rdap-tigSection_3_3_and_3_4_Validation
        - rdap-tigSection_4_1_Validation
        - rdap-tigSection_7_1_and_7_2_Validation
        - rdap-tigSection_1_11_1_Validation
        - rdap-tigSection_3_2_Validation
        - rdap-tigSection_6_1_Validation publicIds property of registrar entity
        - rdap-rdapResponseProfile_1_2_2_Validation
        - rdap-rdapResponseProfile_1_3_Validation
        - rdap-rdapResponseProfile_1_4_Validation
        - rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation
        - rdap-rdapResponseProfile_2_1_Validation
        - rdap-rdapResponseProfile_2_2_Validation
        - rdap-rdapResponseProfile_2_3_1_1_Validation
        - rdap-rdapResponseProfile_2_3_1_2_Validation
        - rdap-rdapResponseProfile_notices_included_Validation
        - rdap-rdapResponseProfile_2_6_3_Validation
        - rdap-rdapResponseProfile_2_11_Validation
        - rdap-rdapResponseProfile_2_10_Validation
        - rdap-rdapResponseProfile_rfc5731_Validation
        - rdap-rdapResponseProfile_rfc3915_Validation
        - rdap-rdapResponseProfile_2_6_1_Validation
        - rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation
        - rdap-rdapResponseProfile_2_4_1_Validation
        - rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation
        - rdap-rdapResponseProfile_2_4_5_Validation
        - rdap-rdapResponseProfile_4_1_Validation
        - rdap-rdapResponseProfile_4_3_Validation
        - rdap-nameserver_status
        - rdap-rdapResponseProfile_2_7_5_3_Validation

      EPP:
      IDN:
      RDE:
        - rde-FileName01
        - rde-FileName02
        - rde-Verify01
        - rde-Verify02
        - rde-Content01
        - rde-Content02

  StandardRSPChangeTest:
    Order: 2
    Name: Standard RSP Change Test Plan
    Description: |
      A Registry Operator may apply to ICANN to change a Material Subcontracting
      Arrangement (MSA) and appoint a new Registry Services Provider. Before
      this change can be approved, the new RSP must complete Registry System
      Testing to ensure their systems comply with the technical and operational
      requirements of the Registry Agreement.

      The RSP Change Test covers all critical registry services and IDNs, and
      therefore uses all test suites.

    Test-Suites:
      DNS:
        - dns-address01
        - dns-address02
        - dns-address03
        - dns-connectivity01
        - dns-connectivity02
        - dns-connectivity03
        - dns-connectivity04
        - dns-consistency01
        - dns-consistency02
        - dns-consistency03
        - dns-consistency04
        - dns-consistency05
        - dns-consistency06
        - dns-delegation01
        - dns-delegation02
        - dns-delegation03
        - dns-delegation04
        - dns-delegation05
        - dns-delegation06
        - dns-nameserver01
        - dns-nameserver02
        - dns-nameserver04
        - dns-nameserver05
        - dns-nameserver06
        - dns-nameserver07
        - dns-nameserver08
        - dns-nameserver09
        - dns-nameserver10
        - dns-nameserver11
        - dns-nameserver12
        - dns-nameserver13
        - dns-syntax05
        - dns-syntax06
        - dns-syntax07
        - dns-zone01
        - dns-zone02
        - dns-zone03
        - dns-zone04
        - dns-zone05
        - dns-zone06
        - dns-zone07
        - dns-zone10

      DNSSEC:
        - dnssec01
        - dnssec02
        - dnssec03
        - dnssec04
        - dnssec05
        - dnssec06
        - dnssec07
        - dnssec08
        - dnssec09
        - dnssec10
        - dnssec11
        - dnssec13
        - dnssec14
        - dnssec15
        - dnssec16
        - dnssec17
        - dnssec18

      RDDS:
        - rdap-ipv4Validation
        - rdap-ipv6Validation
        - rdap-domainNameValidation
        - rdap-webUriValidation
        - rdap-domainCaseFoldingValidation
        - rdap-Standard RDAP Common Data Structures Validations
        - rdap-stdRdapConformanceValidation
        - rdap-stdRdapLinksValidation
        - rdap-stdRdapNoticesRemarksValidation
        - rdap-stdRdapLanguageIdentifierValidation
        - rdap-stdRdapEventsValidation
        - rdap-stdRdapStatusValidation
        - rdap-stdRdapPort43WhoisServerValidation
        - rdap-stdRdapPublicIdsValidation
        - rdap-stdRdapAsEventActorValidation
        - rdap-stdRdapIpAddressesValidation
        - rdap-stdRdapVariantsValidation
        - rdap-stdRdapUnicodeNameValidation
        - rdap-stdRdapLdhNameValidation
        - rdap-stdRdapRolesValidation
        - rdap-stdRdapEntitiesValidation
        - rdap-stdRdapSecureDnsValidation
        - rdap-stdRdapErrorResponseBodyValidation
        - rdap-stdRdapDomainLookupValidation
        - rdap-stdRdapEntityLookupValidation
        - rdap-stdRdapNameserverLookupValidation
        - rdap-stdRdapHelpValidation
        - rdap-stdRdapNameserversSearchValidation
        - rdap-tigSection_1_2_Validation
        - rdap-tigSection_1_3_Validation
        - rdap-tigSection_1_6_Validation
        - rdap-tigSection_1_8_Validation
        - rdap-tigSection_1_13_Validation
        - rdap-tigSection_1_14_Validation
        - rdap-tigSection_3_3_and_3_4_Validation
        - rdap-tigSection_4_1_Validation
        - rdap-tigSection_7_1_and_7_2_Validation
        - rdap-tigSection_1_11_1_Validation
        - rdap-tigSection_3_2_Validation
        - rdap-tigSection_6_1_Validation publicIds property of registrar entity
        - rdap-rdapResponseProfile_1_2_2_Validation
        - rdap-rdapResponseProfile_1_3_Validation
        - rdap-rdapResponseProfile_1_4_Validation
        - rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation
        - rdap-rdapResponseProfile_2_1_Validation
        - rdap-rdapResponseProfile_2_2_Validation
        - rdap-rdapResponseProfile_2_3_1_1_Validation
        - rdap-rdapResponseProfile_2_3_1_2_Validation
        - rdap-rdapResponseProfile_notices_included_Validation
        - rdap-rdapResponseProfile_2_6_3_Validation
        - rdap-rdapResponseProfile_2_11_Validation
        - rdap-rdapResponseProfile_2_10_Validation
        - rdap-rdapResponseProfile_rfc5731_Validation
        - rdap-rdapResponseProfile_rfc3915_Validation
        - rdap-rdapResponseProfile_2_6_1_Validation
        - rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation
        - rdap-rdapResponseProfile_2_4_1_Validation
        - rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation
        - rdap-rdapResponseProfile_2_4_5_Validation
        - rdap-rdapResponseProfile_4_1_Validation
        - rdap-rdapResponseProfile_4_3_Validation
        - rdap-nameserver_status
        - rdap-rdapResponseProfile_2_7_5_3_Validation

      EPP:
      IDN:
      RDE:
        - rde-FileName01
        - rde-FileName02
        - rde-Verify01
        - rde-Verify02
        - rde-Content01
        - rde-Content02

  DNSRSPChangeTest:
    Order: 3
    Name: DNS RSP Change Test Plan
    Description: |
      A Registry Operator may apply to ICANN to change a Material Subcontracting
      Arrangement (MSA) and appoint a new provider of authoritative DNS services
      instead of or in addition to any existing provider(s).

      Before this change can be approved, the new DNS provider must complete
      testing to ensure their systems comply with the technical and operational
      requirements of the Registry Agreement.

      The DNS RSP Change Test uses the DNS test suite only.

    Test-Suites:
      DNS:
        - dns-address01
        - dns-address02
        - dns-address03
        - dns-connectivity01
        - dns-connectivity02
        - dns-connectivity03
        - dns-connectivity04
        - dns-consistency01
        - dns-consistency02
        - dns-consistency03
        - dns-consistency04
        - dns-consistency05
        - dns-consistency06
        - dns-delegation01
        - dns-delegation02
        - dns-delegation03
        - dns-delegation04
        - dns-delegation05
        - dns-delegation06
        - dns-nameserver01
        - dns-nameserver02
        - dns-nameserver04
        - dns-nameserver05
        - dns-nameserver06
        - dns-nameserver07
        - dns-nameserver08
        - dns-nameserver09
        - dns-nameserver10
        - dns-nameserver11
        - dns-nameserver12
        - dns-nameserver13
        - dns-syntax05
        - dns-syntax06
        - dns-syntax07
        - dns-zone01
        - dns-zone02
        - dns-zone03
        - dns-zone04
        - dns-zone05
        - dns-zone06
        - dns-zone07
        - dns-zone10

      DNSSEC:
        - dnssec01
        - dnssec02
        - dnssec03
        - dnssec04
        - dnssec05
        - dnssec06
        - dnssec07
        - dnssec08
        - dnssec09
        - dnssec10
        - dnssec11
        - dnssec13
        - dnssec14
        - dnssec15
        - dnssec16
        - dnssec17
        - dnssec18

  IDNTest:
    Order: 4
    Name: IDN RST Test Plan
    Description: |
      A Registry Operator may apply to ICANN to amend its Registry Agreement
      to offer new scripts and/or languages for Internationalized Domain Names.

      The purpose of an IDN RST test is to verify that the Registry Operator’s
      registry system handles IDN registrations in accordance with the
      submitted policy statements and IDN tables.

      The IDN Test uses the IDN test suite only.
    Test-Suites:
      IDN:

  SRSGatewayTest:
    Order: 5
    Name: SRS Gateway Test Plan
    Description: |
      An SRS Gateway service is a Shared Registry System implementation that
      acts as a proxy between a subset of Registrars and the Registry. It uses
      a local cache to speed up EPP query commands, but forwards all EPP
      transform commands to the TLD Registry System. TLD registries need to
      deploy a proxy setup in order to operate in certain markets worldwide.

      The purpose of an SRS Gateway Test is to verify that the Registry
      Operator’s proxy setup operates in accordance with the technical and
      operational criteria for EPP systems described in the gTLD Applicant
      Guidebook (AGB). Furthermore, it must keep its own database synchronized
      with that of the TLD registry.

      The SRS Gateway Test Change Test uses the RDDS and EPP test suites.

    Test-Suites:
      RDDS:
      EPP:

  StandardRSPEvaluationTest:
    Order: 6
    Name: Standard RSP Evaluation Test
    Description: |
      For the Next Round of gTLD applications, Registry Service Providers can
      apply to be pre-evaluated before submission of applications.

      A "Standard" RSP is one which provides all of the critical registry
      services.

      As a result, this test plan is designed to cover all aspects of RSP
      operations, and is substantially similar to the Standard Pre-Delegation
      Test and Standard RSP Change Test.
    Test-Suites:
      DNS:
        - dns-address01
        - dns-address02
        - dns-address03
        - dns-connectivity01
        - dns-connectivity02
        - dns-connectivity03
        - dns-connectivity04
        - dns-consistency01
        - dns-consistency02
        - dns-consistency03
        - dns-consistency04
        - dns-consistency05
        - dns-consistency06
        - dns-delegation01
        - dns-delegation02
        - dns-delegation03
        - dns-delegation04
        - dns-delegation05
        - dns-delegation06
        - dns-nameserver01
        - dns-nameserver02
        - dns-nameserver04
        - dns-nameserver05
        - dns-nameserver06
        - dns-nameserver07
        - dns-nameserver08
        - dns-nameserver09
        - dns-nameserver10
        - dns-nameserver11
        - dns-nameserver12
        - dns-nameserver13
        - dns-syntax05
        - dns-syntax06
        - dns-syntax07
        - dns-zone01
        - dns-zone02
        - dns-zone03
        - dns-zone04
        - dns-zone05
        - dns-zone06
        - dns-zone07
        - dns-zone10

      DNSSEC:
        - dnssec01
        - dnssec02
        - dnssec03
        - dnssec04
        - dnssec05
        - dnssec06
        - dnssec07
        - dnssec08
        - dnssec09
        - dnssec10
        - dnssec11
        - dnssec13
        - dnssec14
        - dnssec15
        - dnssec16
        - dnssec17
        - dnssec18

      RDDS:
        - rdap-ipv4Validation
        - rdap-ipv6Validation
        - rdap-domainNameValidation
        - rdap-webUriValidation
        - rdap-domainCaseFoldingValidation
        - rdap-Standard RDAP Common Data Structures Validations
        - rdap-stdRdapConformanceValidation
        - rdap-stdRdapLinksValidation
        - rdap-stdRdapNoticesRemarksValidation
        - rdap-stdRdapLanguageIdentifierValidation
        - rdap-stdRdapEventsValidation
        - rdap-stdRdapStatusValidation
        - rdap-stdRdapPort43WhoisServerValidation
        - rdap-stdRdapPublicIdsValidation
        - rdap-stdRdapAsEventActorValidation
        - rdap-stdRdapIpAddressesValidation
        - rdap-stdRdapVariantsValidation
        - rdap-stdRdapUnicodeNameValidation
        - rdap-stdRdapLdhNameValidation
        - rdap-stdRdapRolesValidation
        - rdap-stdRdapEntitiesValidation
        - rdap-stdRdapSecureDnsValidation
        - rdap-stdRdapErrorResponseBodyValidation
        - rdap-stdRdapDomainLookupValidation
        - rdap-stdRdapEntityLookupValidation
        - rdap-stdRdapNameserverLookupValidation
        - rdap-stdRdapHelpValidation
        - rdap-stdRdapNameserversSearchValidation
        - rdap-tigSection_1_2_Validation
        - rdap-tigSection_1_3_Validation
        - rdap-tigSection_1_6_Validation
        - rdap-tigSection_1_8_Validation
        - rdap-tigSection_1_13_Validation
        - rdap-tigSection_1_14_Validation
        - rdap-tigSection_3_3_and_3_4_Validation
        - rdap-tigSection_4_1_Validation
        - rdap-tigSection_7_1_and_7_2_Validation
        - rdap-tigSection_1_11_1_Validation
        - rdap-tigSection_3_2_Validation
        - rdap-tigSection_6_1_Validation publicIds property of registrar entity
        - rdap-rdapResponseProfile_1_2_2_Validation
        - rdap-rdapResponseProfile_1_3_Validation
        - rdap-rdapResponseProfile_1_4_Validation
        - rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation
        - rdap-rdapResponseProfile_2_1_Validation
        - rdap-rdapResponseProfile_2_2_Validation
        - rdap-rdapResponseProfile_2_3_1_1_Validation
        - rdap-rdapResponseProfile_2_3_1_2_Validation
        - rdap-rdapResponseProfile_notices_included_Validation
        - rdap-rdapResponseProfile_2_6_3_Validation
        - rdap-rdapResponseProfile_2_11_Validation
        - rdap-rdapResponseProfile_2_10_Validation
        - rdap-rdapResponseProfile_rfc5731_Validation
        - rdap-rdapResponseProfile_rfc3915_Validation
        - rdap-rdapResponseProfile_2_6_1_Validation
        - rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation
        - rdap-rdapResponseProfile_2_4_1_Validation
        - rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation
        - rdap-rdapResponseProfile_2_4_5_Validation
        - rdap-rdapResponseProfile_4_1_Validation
        - rdap-rdapResponseProfile_4_3_Validation
        - rdap-nameserver_status
        - rdap-rdapResponseProfile_2_7_5_3_Validation

      EPP:
      IDN:
      RDE:
        - rde-FileName01
        - rde-FileName02
        - rde-Verify01
        - rde-Verify02
        - rde-Content01
        - rde-Content02

  DNSRSPEvaluationTest:
    Order: 7
    Name: DNS RSP Evaluation Test
    Description: |
      DNS RSPs provide primary or secondary authoritative DNS services.
      Therefore, this test plan only covers the DNS area.

      RSPs wishing to offer DNSSEC services in addition to authoritative DNS
      will also be evaluated using the DNSSEC RSP Evaluation Test below.

    Test-Suites:
      DNS:
        - dns-address01
        - dns-address02
        - dns-address03
        - dns-connectivity01
        - dns-connectivity02
        - dns-connectivity03
        - dns-connectivity04
        - dns-consistency01
        - dns-consistency02
        - dns-consistency03
        - dns-consistency04
        - dns-consistency05
        - dns-consistency06
        - dns-delegation01
        - dns-delegation02
        - dns-delegation03
        - dns-delegation04
        - dns-delegation05
        - dns-delegation06
        - dns-nameserver01
        - dns-nameserver02
        - dns-nameserver04
        - dns-nameserver05
        - dns-nameserver06
        - dns-nameserver07
        - dns-nameserver08
        - dns-nameserver09
        - dns-nameserver10
        - dns-nameserver11
        - dns-nameserver12
        - dns-nameserver13
        - dns-syntax05
        - dns-syntax06
        - dns-syntax07
        - dns-zone01
        - dns-zone02
        - dns-zone03
        - dns-zone04
        - dns-zone05
        - dns-zone06
        - dns-zone07
        - dns-zone10

      RDDS:
      EPP:
      IDN:
      RDE:

  DNSSECRSPEvaluationTest:
    Order: 8
    Name: DNSSEC RSP Evaluation Test
    Description: |
      DNSSEC RSPs provide signing of TLD zone files as a service. They do not
      provide primary or secondary authoritative DNS services.

      RSPs wishing to offer DNSSEC services in addition to authoritative DNS
      will also be evaluated using the DNSSEC RSP Evaluation Test below.

    Test-Suites:

      DNSSEC:
        - dnssec01
        - dnssec02
        - dnssec03
        - dnssec04
        - dnssec05
        - dnssec06
        - dnssec07
        - dnssec08
        - dnssec09
        - dnssec10
        - dnssec11
        - dnssec13
        - dnssec14
        - dnssec15
        - dnssec16
        - dnssec17
        - dnssec18

Test-Cases:
  dns-address01:
    Summary: Verify that IPv4 addresse are not in private networks
  dns-address02:
    Summary: Verify reverse DNS entries exist for nameserver IP addresses
  dns-address03:
    Summary: Verify that reverse DNS entries match nameserver names
  dns-connectivity01:
    Summary: Verify nameserver UDP port 53 reachability
  dns-connectivity02:
    Summary: Verify nameserver TCP port 53 reachability
  dns-connectivity03:
    Summary: Verify that all nameservers do not belong to the same AS
  dns-connectivity04:
    Summary: Verify that name servers are not announced in the same IP prefix
  dns-consistency01:
    Summary: Query all nameservers for SOA, and verify that they all have the same SOA serial number
  dns-consistency02:
    Summary: Query all nameservers for SOA, and verify that they all have the same SOA rname
  dns-consistency03:
    Summary: Query all nameservers for SOA, and verify that they all have the same time parameters (REFRESH/RETRY/EXPIRE/MINIMUM)
  dns-consistency04:
    Summary: Query all nameservers for the NS set, and verify that they have all the same content
  dns-consistency05:
    Summary: Verify that the glue records are consistent with authoritative data
  dns-consistency06:
    Summary: Query all nameservers for SOA, and verify that they all have the same SOA mname
  dns-delegation01:
    Summary: Verify that there are more than two nameservers
  dns-delegation02:
    Summary: Verify that name servers have distinct IP addresses
  dns-delegation03:
    Summary: Verify that there is no truncation on referrals
  dns-delegation04:
    Summary: Verify that nameservers are authoritative
  dns-delegation05:
    Summary: Verify that NS RRs do not point to CNAMEs
  dns-delegation06:
    Summary: Verify existence of SOA
  dns-nameserver01:
    Summary: Verify that nameserver does not provide recursive service
  dns-nameserver02:
    Summary: Verify EDNS0 support
  dns-nameserver04:
    Summary: Verify that replies from nameserver comes from the expected IP address
  dns-nameserver05:
    Summary: Verify behaviour against AAAA queries
  dns-nameserver06:
    Summary: Verify that each nameserver can be resolved to an IP address
  dns-nameserver07:
    Summary: Check whether authoritative name servers return an upward referral
  dns-nameserver08:
    Summary: Check whether authoritative name servers responses match the case of every letter in QNAME
  dns-nameserver09:
    Summary: Check whether authoritative name servers return same results for equivalent names with different cases in the request
  dns-nameserver10:
    Summary: Check whether authoritative name servers respond correctly to queries with undefined EDNS version
  dns-nameserver11:
    Summary: Check whether authoritative name servers responses doe not include unknown EDNS OPTION-CODE used in query
  dns-nameserver12:
    Summary: Check whether authoritative name servers responses has "Z" bits cleared even if they are set in the query
  dns-nameserver13:
    Summary: Verify that if the response to a query with an OPT record is truncated, then the response will contain an OPT record
  dns-syntax05:
    Summary: Verify that a SOA rname (Zonemaster::Engine::DNSName) given has a conform usage of at sign (@)
  dns-syntax06:
    Summary: Verify that a SOA rname (Zonemaster::Engine::DNSName) given is RFC822 compliant
  dns-syntax07:
    Summary: Verify that SOA mname of zone given conforms to syntax rules
  dns-zone01:
    Summary: Check that master nameserver in SOA is fully qualified
  dns-zone02:
    Summary: Verify SOA 'refresh' minimum value
  dns-zone03:
    Summary: Verify SOA 'retry' value is lower than SOA 'refresh' value
  dns-zone04:
    Summary: Verify SOA 'retry' minimum value
  dns-zone05:
    Summary: Verify SOA 'expire' minimum value
  dns-zone06:
    Summary: Verify SOA 'minimum' (default TTL) value
  dns-zone07:
    Summary: Verify that SOA master is not an alias (CNAME)
  dns-zone10:
    Summary: Verify that the zone of the domain to be tested return exactly one SOA record
  dnssec01:
    Summary: Verifies that all DS records have digest types registered with IANA
  dnssec02:
    Summary: Verifies that all DS records have a matching DNSKEY
  dnssec03:
    Summary: Check iteration counts for NSEC3
  dnssec04:
    Summary: Checks the durations of the signatures for the DNSKEY and SOA RRsets
  dnssec05:
    Summary: Check DNSKEY algorithms
  dnssec06:
    Summary: Check for DNSSEC extra processing at child nameservers
  dnssec07:
    Summary: Check that both DS and DNSKEY are present
  dnssec08:
    Summary: Check that the DNSKEY RRset is signed
  dnssec09:
    Summary: Check that the SOA RRset is signed
  dnssec10:
    Summary: Check for the presence of either NSEC or NSEC3, with proper coverage and signatures
  dnssec11:
    Summary: Check that the delegation step from parent is properly signed
  dnssec13:
    Summary: Check that all DNSKEY algorithms are used to sign the zone
  dnssec14:
    Summary: Check for valid RSA DNSKEY key size
  dnssec15:
    Summary: Check existence of CDS and CDNSKEY
  dnssec16:
    Summary: Validate CDS
  dnssec17:
    Summary: Validate CDNSKEY
  dnssec18:
    Summary: Validate trust from DS to CDS and CDNSKEY

  rdap-ipv4Validation:
    Summary: IPv4 address validation
  rdap-ipv6Validation:
    Summary: IPv6 address validation
  rdap-domainNameValidation:
    Summary: Domain Name validation
  rdap-webUriValidation:
    Summary: Web URI validation
  rdap-domainCaseFoldingValidation:
    Summary: Domain label case folding validation
  rdap-stdRdapConformanceValidation:
    Summary: RDAP Conformance validation
  rdap-stdRdapLinksValidation:
    Summary: Links validation
  rdap-stdRdapNoticesRemarksValidation:
    Summary: Notices and Remarks Validation
  rdap-stdRdapLanguageIdentifierValidation:
    Summary: Language Identifier Validation
  rdap-stdRdapEventsValidation:
    Summary: Events Validation
  rdap-stdRdapStatusValidation:
    Summary: Status validation
  rdap-stdRdapPort43WhoisServerValidation:
    Summary: Port 43 WHOIS Server
  rdap-stdRdapPublicIdsValidation:
    Summary: Public IDs validation
  rdap-stdRdapAsEventActorValidation:
    Summary: asEventActor Validation
  rdap-stdRdapIpAddressesValidation:
    Summary: IP Addresses Validation
  rdap-stdRdapVariantsValidation:
    Summary: Variants validation
  rdap-stdRdapUnicodeNameValidation:
    Summary: Unicode name
  rdap-stdRdapLdhNameValidation:
    Summary: LDH name
  rdap-stdRdapRolesValidation:
    Summary: Roles validation
  rdap-stdRdapEntitiesValidation:
    Summary: Entities validation
  rdap-stdRdapSecureDnsValidation:
    Summary: Secure DNS validation
  rdap-stdRdapErrorResponseBodyValidation:
    Summary: Error Response Body
  rdap-stdRdapDomainLookupValidation:
    Summary: Domain Lookup Validation
  rdap-stdRdapEntityLookupValidation:
    Summary: Entity lookup validation
  rdap-stdRdapNameserverLookupValidation:
    Summary: Nameserver lookup validation
  rdap-stdRdapHelpValidation:
    Summary: Help validation
  rdap-stdRdapNameserversSearchValidation:
    Summary: Nameservers search validation
  rdap-tigSection_1_2_Validation:
    Summary: use of HTTPS
  rdap-tigSection_1_3_Validation:
    Summary: use of obsolete SSL/TLS versions
  rdap-tigSection_1_6_Validation:
    Summary: support for HEAD
  rdap-tigSection_1_8_Validation:
    Summary: IPv4/IPv6 resolvability
  rdap-tigSection_1_13_Validation:
    Summary: Access-Control-Allow-Origin header
  rdap-tigSection_1_14_Validation:
    Summary: presence of "icann_rdap_technical_implementation_guide_0" in "rdapConformance"
  rdap-tigSection_3_3_and_3_4_Validation:
    Summary: presence of link object(s) in notice(s)
  rdap-tigSection_4_1_Validation:
    Summary: structured addresses in entity jCards
  rdap-tigSection_7_1_and_7_2_Validation:
    Summary: voice/fax type for tel nodes in entity jCards
  rdap-tigSection_1_11_1_Validation:
    Summary: bootstrap registration
  rdap-tigSection_3_2_Validation:
    Summary: rel="related" link in topmost object
  rdap-tigSection_6_1_Validation:
    Summary: publicIds property of registrar entity
  rdap-rdapResponseProfile_1_2_2_Validation:
    Summary: no JavaScript
  rdap-rdapResponseProfile_1_3_Validation:
    Summary: presence of "icann_rdap_response_profile_0" in "rdapConformance"
  rdap-rdapResponseProfile_1_4_Validation:
    Summary: empty country name parameter of entity jCards
  rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation:
    Summary: presence of "last update of RDAP database" event
  rdap-rdapResponseProfile_2_1_Validation:
    Summary: presence of ldhName/unicodeName property for A-label/U-label domain lookup responses, respectively
  rdap-rdapResponseProfile_2_2_Validation:
    Summary: format of handle property
  rdap-rdapResponseProfile_2_3_1_1_Validation:
    Summary: presence of "registration" event
  rdap-rdapResponseProfile_2_3_1_2_Validation:
    Summary: presence of "expiration" event
  rdap-rdapResponseProfile_notices_included_Validation:
    Summary: presence of "notices" property
  rdap-rdapResponseProfile_2_6_3_Validation:
    Summary: presence of "Status Codes" notice
  rdap-rdapResponseProfile_2_11_Validation:
    Summary: presence of "RDDS Inaccuracy Complaint Form" notice
  rdap-rdapResponseProfile_2_10_Validation:
    Summary: presence of secureDNS property
  rdap-rdapResponseProfile_rfc5731_Validation:
    Summary: domain status code validation
  rdap-rdapResponseProfile_rfc3915_Validation:
    Summary: RGP status code validation
  rdap-rdapResponseProfile_2_6_1_Validation:
    Summary: at least one status code
  rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation:
    Summary: presence and validity of ldhName, handle, status properties in domain nameservers
  rdap-rdapResponseProfile_2_4_1_Validation:
    Summary: presence and validity of the registrar entity
  rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation:
    Summary: validation of the publicIds and handle properties of the registrar entity
  rdap-rdapResponseProfile_2_4_5_Validation:
    Summary: abuse role for the registrar entity
  rdap-rdapResponseProfile_4_1_Validation:
    Summary: presence of ldhName/unicodeName property for A-label/U-label nameserver lookup responses, respectively
  rdap-rdapResponseProfile_4_3_Validation:
    Summary: presence and validity of the registrar entity
  rdap-nameserver_status:
    Summary: validation of nameserver status codes
  rdap-rdapResponseProfile_2_7_5_3_Validation:
    Summary: proper redaction of domain entities
  rde-FileName01:
    Summary: Verify file names, full escrow
    Description: |
      ## Objective

      The test will receive one full deposit of sample data. The objective is
      to verify file names.

      Requirements from the test plan: \[R21\], \[AGB1\], \[RS5\]

      ## Inputs

      The following information will be needed as input for this test case:

        ------------------------------------------------------------------------
        Id                      Description                         Type
        ----------------------- ----------------------------------- ------------
        TLD                     The ASCII compatible name of the    String
                                TLD

        DataFileFull-\[1..n\]   The files containing the full       Files
                                deposit

        DataSigFull-\[1..n\]    The files containing the signature  Files
        ------------------------------------------------------------------------

      ## Outcome(s)

      Files MUST be named according to the following convention:

      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      This test has no intercase dependencies.

      ## Ordered description of steps to be taken to execute the test case

      All of the checks are case insensitive.

      The data files MUST follow this format
      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      For each **\<DataFileFull\>**, check that:

      1.  {gTLD} is equal to **\<TLD\>**. If it is an IDN-TLD, then this MUST
          be the A-label.

      2.  {YYYY-MM-DD} is equal to year, month, and day. The file MUST be
          maximum 40 days old.

      3.  {type} is equal to "full".

      4.  {#} is a number greater than or equal to 1. Leading zeroes are not
          allowed.

      5.  {rev} is a number greater than or equal to 0. Leading zeroes are not
          allowed.

      6.  {ext} is equal to "ryde".

      The signature files MUST follow this format
      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      For each **\<DataSigFull\>**, check that:

      1.  {gTLD} is equal to **\<TLD\>**. If it is an IDN-TLD, then this MUST
          be the A-label.

      2.  {YYYY-MM-DD} is equal to year, month, and day. The file MUST be
          maximum 40 days old.

      3.  {type} is equal to "full".

      4.  {#} is a number greater than or equal to 1. Leading zeroes are not
          allowed.

      5.  {rev} is a number greater than or equal to 0. Leading zeroes are not
          allowed.

      6.  {ext} is equal to "sig".
  rde-FileName02:
    Summary: Verify file names, differential escrow
    Description: |
      ## Objective

      This test is optional and will only be performed if the Registry
      Operator has supplied a differential deposit.

      The test will receive one differential deposit of sample data. The
      objective is to verify file names.

      Requirements from the test plan: \[R21\], \[AGB2\], \[RS5\]

      ## Inputs

      The following information will be needed as input for this test case:

        ------------------------------------------------------------------------
        Id                      Description                         Type
        ----------------------- ----------------------------------- ------------
        TLD                     The ASCII compatible name of the    String
                                TLD

        DataFileDiff-\[1..n\]   The files containing the            Files
                                differential deposit

        DataSigDiff-\[1..n\]    The files containing the signature  Files
        ------------------------------------------------------------------------

      ## Outcome(s)

      Files MUST be named according to the following convention:

      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      This test has no intercase dependencies.

      ## Ordered description of steps to be taken to execute the test case

      All of the checks are case insensitive.

      The data files MUST follow this format
      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      For each **\<DataFileDiff\>**, check that:

      1.  {gTLD} is equal to **\<TLD\>**. If it is an IDN-TLD, then this MUST
          be the A-label.

      2.  {YYYY-MM-DD} is equal to year, month, and day. The file MUST be
          maximum 40 days old.

      3.  {type} is equal to "diff".

      4.  {#} is a number greater than or equal to 1. Leading zeroes are not
          allowed.

      5.  {rev} is a number greater than or equal to 0. Leading zeroes are not
          allowed.

      6.  {ext} is equal to "ryde".

      The signature files MUST follow this format
      {gTLD}\_{YYYY-MM-DD}\_{type}\_S{#}\_R{rev}.{ext}

      For each **\<DataSigDiff\>**, check that:

      1.  {gTLD} is equal to **\<TLD\>**. If it is an IDN-TLD, then this MUST
          be the A-label.

      2.  {YYYY-MM-DD} is equal to year, month, and day. The file MUST be
          maximum 40 days old.

      3.  {type} is equal to "diff".

      4.  {#} is a number greater than or equal to1. Leading zeroes are not
          allowed.

      5.  {rev} is a number greater than or equal to 0. Leading zeroes are not
          allowed.

      6.  {ext} is equal to "sig".
  rde-Verify01:
    Summary: Verify signatures, full escrow
    Description: |
      ## Objective

      The test will verify the signatures of the received files. If it is a
      multi-part transmission, then the files are reassembled. Decrypt and
      uncompress the result.

      Requirements from the test plan: \[R21\], \[AGB1\], \[RS4\], \[RS8-1\],
      \[RS8-2\], \[RS8-3\], \[ALGO\]

      ## Inputs

      The following information will be needed as input for this test case:

        ------------------------------------------------------------------------
        Id                      Description                         Type
        ----------------------- ----------------------------------- ------------
        DataFileFull-\[1..n\]   The files containing the full       Files
                                deposit

        DataSigFull-\[1..n\]    The files containing the signature  Files

        DataRegPubKey           The public key used for             File
                                verification
        ------------------------------------------------------------------------

      ## Outcome(s)

      -   The signature, encryption, and compression are done in accordance
          with RFC 4880.

      -   The files MUST be signed using RSA, DSA, or ECDSA with SHA1,
          RIPEMD160, SHA224, SHA256, SHA384, or SHA512.

      -   If multi-part files, then all files MUST be present.

      -   The files MUST be encrypted using RSA, Elgamal, or ECDH with IDEA,
          TripleDES, CAST5, Blowfish, AES128, AES192, AES256, or Twofish.

      -   The decrypted and uncompressed file will be used in upcoming test.

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      rde-FileName01 must first have been executed successfully.

      ## Ordered description of steps to be taken to execute the test case

      All operations are done in accordance with RFC 4880.

      For each **\<DataSigFull\>**:

      1.  Validate the signature. It MUST be possible to validate the
          **\<DataFileFull\>** using the signature and the
          **\<DataRegPubKey\>**.

      2.  Check the properties of the signature:

          a.  Digest algorithm SHA1, RIPEMD160, SHA224, SHA256, SHA384, or
              SHA512 MUST be used. MD5 is deprecated and MUST NOT be used.

          b.  Public key algorithm RSA, DSA or ECDSA MUST be used.

      If there is more than one **\<DataFileFull\>**:

      1.  All file parts MUST be present. See {#} in the file name and that
          they form a sequence of numbers starting with 1.

      2.  Concatenate the files in order.

      Decrypt and uncompress the (concatenated) file:

      1.  Decrypt the file using the private test key. The file will be
          uncompressed automatically by the client software.

      2.  Check the properties of the encrypted file:

          a.  Symmetric algorithm IDEA, TripleDES, CAST5, Blowfish, AES128,
              AES192, AES256, or Twofish MUST be used.

          b.  Public key algorithm RSA, Elgamal or ECDH MUST be used. (Note
              that this will always be RSA because of the RST Provider's
              public key.)

      3.  Check the original file name of the unencrypted file. It MUST be the
          same as the encrypted deposit but with extension tar.

      Untar the decrypted archive and check that there is an XML file. It MUST
      be named as the deposit but with the extension xml. The XML file MUST
      NOT be placed in any subdirectory within the archive.
  rde-Verify02:
    Summary: Verify signatures, differential escrow
    Description: |
      ## Objective

      This test is optional and will only be performed if the Registry
      Operator has supplied a differential deposit.

      The test will verify the signature of the received files. If it is a
      multi-part transmission, then the files are reassembled. Decrypt and
      uncompress the result.

      Requirements from the test plan: \[R21\], \[AGB2\], \[RS4\], \[RS8-1\],
      \[RS8-2\], \[RS8-3\], \[ALGO\]

      ## Inputs

      The following information will be needed as input for this test case:

        ------------------------------------------------------------------------
        Id                      Description                         Type
        ----------------------- ----------------------------------- ------------
        DataFileDiff-\[1..n\]   The files containing the            Files
                                differential deposit

        DataSigDiff-\[1..n\]    The files containing the signature  Files

        DataRegPubKey           The public key used for             File
                                verification
        ------------------------------------------------------------------------

      ## Outcome(s)

      -   The signature, encryption, and compression are done in accordance
          with RFC 4880.

      -   The files MUST be signed using RSA, DSA, or ECDSA with SHA1,
          RIPEMD160, SHA224, SHA256, SHA384, or SHA512.

      -   If multi-part files, then all files MUST be present.

      -   The files MUST be encrypted using RSA, Elgamal, or ECDH with IDEA,
          TripleDES, CAST5, Blowfish, AES128, AES192, AES256, or Twofish.

      -   The decrypted and uncompressed file will be used in upcoming test.

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      rde-FileName02 must first have been executed successfully.

      ## Ordered description of steps to be taken to execute the test case

      All operations are done in accordance with RFC 4880.

      For each **\<DataSigDiff\>**:

      1.  Validate the signature. It MUST be possible to validate the
          **\<DataFileDiff\>** using the signature and the
          **\<DataRegPubKey\>**.

      2.  Check the properties of the signature:

          a.  Digest algorithm SHA1, RIPEMD160, SHA224, SHA256, SHA384, or
              SHA512 MUST be used. MD5 is deprecated and MUST NOT be used.

          b.  Public key algorithm RSA, DSA or ECDSA MUST be used.

      If there is more than one **\<DataFileDiff\>**:

      1.  All file parts MUST be present. See {#} in the file name and that
          they form a sequence of numbers starting with 1.

      2.  Concatenate the files in order.

      Decrypt and uncompress the (concatenated) file:

      1.  Decrypt the file using the private test key. The file will be
          uncompressed automatically by the client software.

      2.  Check the properties of the encrypted file:

          a.  Symmetric algorithm IDEA, TripleDES, CAST5, Blowfish, AES128,
              AES192, AES256, or Twofish MUST be used.

          b.  Public key algorithm RSA, Elgamal or ECDH MUST be used. (Note
              that this will always be RSA because of the RST Provider's
              public key.)

      3.  Check the original file name of the unencrypted file. It MUST be the
          same as the encrypted deposit but with extension tar.

      Untar the decrypted archive and check that there is an XML file. It MUST
      be named as the deposit but with the extension xml. The XML file MUST
      NOT be placed in any subdirectory within the archive.
  rde-Content01:
    Summary: Validate content, full escrow
    Description: |
      ## Objective

      This test will validate the full deposit against the profile.

      Requirements from the test plan: \[R21\], \[R22\], \[AGB1\], \[RS3\],
      \[RS8-4\]

      ## Inputs

      The following information will be needed as input for this test case:

        -----------------------------------------------------------------------
        Id                     Description                         Type
        ---------------------- ----------------------------------- ------------
        DataFileFull           The unencrypted file containing the File
                               full deposit

        DataProfile            The data escrow profile described   XML file
                               using W3C XML Schema. Provided by
                               ICANN.
        -----------------------------------------------------------------------

      ## Outcome(s)

      The full deposit MUST have valid XML and contain required and valid
      attributes.

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      rde-Verify01 must first have been executed successfully.

      ## Ordered description of steps to be taken to execute the test case

      1.  Check if it is an XML or CSV deposit.

          a.  If CSV deposit, then the corresponding XML in the tests below.

      2.  Validate the **\<DataFileFull\>** XML file against the
          **\<DataProfile\>** XML schema provided by ICANN. The Registry
          Operator MUST use extensions which have been agreed upon with ICANN.

      3.  Check the content of the XML:

          a.  The type MUST be "FULL".

          b.  The date part of the watermark MUST match the date in the file
              name.

          c.  There MUST NOT be a "deletes" element in the file.
  rde-Content02:
    Summary: Validate content, differential escrow
    Description: |
      ## Objective

      This test is optional and will only be performed if the Registry
      Operator has supplied a differential deposit.

      This test will validate the differential deposit against the profile.

      Requirements from the test plan: \[R21\], \[R22\], \[AGB2\], \[RS3\],
      \[RS8-4\]

      ## Inputs

      The following information will be needed as input for this test case:

        -----------------------------------------------------------------------
        Id                     Description                         Type
        ---------------------- ----------------------------------- ------------
        DataFileDiff           The unencrypted file containing the File
                               differential deposit

        DataProfile            The data escrow profile described   XML file
                               using W3C XML Schema. Provided by
                               ICANN.
        -----------------------------------------------------------------------

      ## Outcome(s)

      The differential deposit MUST have valid XML and contain required and
      valid attributes.

      ## Environmental needs

      This test has no environmental needs.

      ## Special procedural requirements

      This test has no special procedural requirements.

      ## Intercase dependencies

      rde-Verify02 must first have been executed successfully.

      ## Ordered description of steps to be taken to execute the test case

      1.  Check if it is an XML or CSV deposit.

          a.  If CSV deposit, then the corresponding XML in the tests below.

      2.  Validate the **\<DataFilediff\>** XML file against the
          **\<DataProfile\>** XML schema provided by ICANN. The Registry
          Operator MUST use extensions which have been agreed upon with ICANN.

      3.  Check the content of the XML:

          a.  The type MUST be "DIFF".

          b.  The prevId attribute MUST be present.

          c.  The date part of the watermark MUST match the date in the file
              name.
