<!doctype html>
<html><head><meta charset="UTF-8" /><meta content="width=device-width" name="viewport" /><style>html {
    background-color: #fefefe;
    font-size: 15px;
}
html,body,p,div,ol,li,table,tr,td,th,input,button,select,option,textarea,* {
    font-family: "Noto Sans", sans-serif;
    font-weight: normal;
    line-height: 1.5;
    color: #333333;
}

a {
    color: #036aa6;
}

a:active,a:hover {
    text-decoration: none;
}

header {
    text-align:center;
}

strong,h1,h2,h3,h4,h5,h6 {
    font-weight: 600;
}

header,nav,body,main,section {
    padding:0 1em;
    border-bottom: 0.0625em solid #ddd;
}

body {
    max-width: 70ch;
    margin: 0.5em auto;
    padding: 1em;
    background-color: #f6f6f6;
    border:1px solid #ddd;
    border-radius: 0.5em;
}

dl {
    margin: auto 2em;
}

dt {
    font-weight:bold;
}

dt:after {
    content: ":";
}

dd {
    margin-bottom: 1em;
}

code,tt,pre {
    font-family: "Fira Code", "Menlo", "Consolas", "Andale Mono", "Courier New", Courier, monospace;
}

pre,.markdown-content {
    margin: auto auto auto 2em;
}

.toc-link {
    position:fixed;
    margin:0;
    padding: 0.25em;
    border-radius: 0.25em;
    top:1em;
    right:3em;
    font-size:50%;
    display:inline-block;
    line-height:100%;
    text-decoration:none;
    border: 1px solid #00c;
}
</style></head>
<body><header><h1>Registry System Testing - Test Specifications</h1><p>Version 3.0</p>
<p>Last Updated: 2023-10-02</p>
<p><a href="mailto:rst@icann.org">GDS Technical Services, Internet Corporation for Assigned Names and Numbers (ICANN)</a></p>
</header><nav><a name="table-of-contents"></a><h2>1. Table of Contents</h2><ol><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#preamble">Preamble</a></li><li><details><summary><a href="#test-plans">Test Plans</a></summary><ol><li><a href="#Test-Plan-StandardPreDelegationTest">Pre-Delegation Test</a></li><li><a href="#Test-Plan-StandardRSPChangeTest">RSP Change Test</a></li><li><a href="#Test-Plan-DNSRSPChangeTest">DNS Registry Service Provider Change Test</a></li><li><a href="#Test-Plan-IDNTest">Internationalized Domain Name Test</a></li><li><a href="#Test-Plan-SRSGatewayTest">SRS Gateway Test</a></li><li><a href="#Test-Plan-MainRSPEvaluationTest">Main RSP Evaluation Test</a></li><li><a href="#Test-Plan-DNSRSPEvaluationTest">DNS RSP Evaluation Test</a></li><li><a href="#Test-Plan-DNSSECRSPEvaluationTest">DNSSEC RSP Evaluation Test</a></li></ol></details></li><li><details><summary><a href="#test-cases">Test Suites</a></summary><ol><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-StandardIDN">Internationalized Domain Names (IDN)</a></li><li><a href="#Test-Suite-StandardSRSGateway">SRS Gateway</a></li><li><a href="#Test-Suite-DNSSECOperations">DNSSEC RSP - Operations</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ol></details></li><li><details><summary><a href="#test-cases">Test Cases</a></summary><ol><li><a href="#Test-Case-dns-address01">dns-address01 - Verify that IPv4 addresse are not in private networks</a></li><li><a href="#Test-Case-dns-address02">dns-address02 - Verify reverse DNS entries exist for nameserver IP addresses</a></li><li><a href="#Test-Case-dns-address03">dns-address03 - Verify that reverse DNS entries match nameserver names</a></li><li><a href="#Test-Case-dns-connectivity01">dns-connectivity01 - Verify nameserver UDP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity02">dns-connectivity02 - Verify nameserver TCP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity03">dns-connectivity03 - Verify that all nameservers do not belong to the same AS</a></li><li><a href="#Test-Case-dns-connectivity04">dns-connectivity04 - Verify that name servers are not announced in the same IP prefix</a></li><li><a href="#Test-Case-dns-consistency01">dns-consistency01 - Query all nameservers for SOA, and verify that they all have the same SOA serial number</a></li><li><a href="#Test-Case-dns-consistency02">dns-consistency02 - Query all nameservers for SOA, and verify that they all have the same SOA rname</a></li><li><a href="#Test-Case-dns-consistency03">dns-consistency03 - Query all nameservers for SOA, and verify that they all have the same time parameters (REFRESH/RETRY/EXPIRE/MINIMUM)</a></li><li><a href="#Test-Case-dns-consistency04">dns-consistency04 - Query all nameservers for the NS set, and verify that they have all the same content</a></li><li><a href="#Test-Case-dns-consistency05">dns-consistency05 - Verify that the glue records are consistent with authoritative data</a></li><li><a href="#Test-Case-dns-consistency06">dns-consistency06 - Query all nameservers for SOA, and verify that they all have the same SOA mname</a></li><li><a href="#Test-Case-dns-delegation01">dns-delegation01 - Verify that there are more than two nameservers</a></li><li><a href="#Test-Case-dns-delegation02">dns-delegation02 - Verify that name servers have distinct IP addresses</a></li><li><a href="#Test-Case-dns-delegation03">dns-delegation03 - Verify that there is no truncation on referrals</a></li><li><a href="#Test-Case-dns-delegation04">dns-delegation04 - Verify that nameservers are authoritative</a></li><li><a href="#Test-Case-dns-delegation05">dns-delegation05 - Verify that NS RRs do not point to CNAMEs</a></li><li><a href="#Test-Case-dns-delegation06">dns-delegation06 - Verify existence of SOA</a></li><li><a href="#Test-Case-dns-nameserver01">dns-nameserver01 - Verify that nameserver does not provide recursive service</a></li><li><a href="#Test-Case-dns-nameserver02">dns-nameserver02 - Verify EDNS0 support</a></li><li><a href="#Test-Case-dns-nameserver04">dns-nameserver04 - Verify that replies from nameserver comes from the expected IP address</a></li><li><a href="#Test-Case-dns-nameserver05">dns-nameserver05 - Verify behaviour against AAAA queries</a></li><li><a href="#Test-Case-dns-nameserver06">dns-nameserver06 - Verify that each nameserver can be resolved to an IP address</a></li><li><a href="#Test-Case-dns-nameserver07">dns-nameserver07 - Check whether authoritative name servers return an upward referral</a></li><li><a href="#Test-Case-dns-nameserver08">dns-nameserver08 - Check whether authoritative name servers responses match the case of every letter in QNAME</a></li><li><a href="#Test-Case-dns-nameserver09">dns-nameserver09 - Check whether authoritative name servers return same results for equivalent names with different cases in the request</a></li><li><a href="#Test-Case-dns-nameserver10">dns-nameserver10 - Check whether authoritative name servers respond correctly to queries with undefined EDNS version</a></li><li><a href="#Test-Case-dns-nameserver11">dns-nameserver11 - Check whether authoritative name servers responses doe not include unknown EDNS OPTION-CODE used in query</a></li><li><a href="#Test-Case-dns-nameserver12">dns-nameserver12 - Check whether authoritative name servers responses has &#34;Z&#34; bits cleared even if they are set in the query</a></li><li><a href="#Test-Case-dns-nameserver13">dns-nameserver13 - Verify that if the response to a query with an OPT record is truncated, then the response will contain an OPT record</a></li><li><a href="#Test-Case-dns-syntax05">dns-syntax05 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given has a conform usage of at sign (@)</a></li><li><a href="#Test-Case-dns-syntax06">dns-syntax06 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given is RFC822 compliant</a></li><li><a href="#Test-Case-dns-syntax07">dns-syntax07 - Verify that SOA mname of zone given conforms to syntax rules</a></li><li><a href="#Test-Case-dns-zone01">dns-zone01 - Check that master nameserver in SOA is fully qualified</a></li><li><a href="#Test-Case-dns-zone02">dns-zone02 - Verify SOA &#39;refresh&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone03">dns-zone03 - Verify SOA &#39;retry&#39; value is lower than SOA &#39;refresh&#39; value</a></li><li><a href="#Test-Case-dns-zone04">dns-zone04 - Verify SOA &#39;retry&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone05">dns-zone05 - Verify SOA &#39;expire&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone06">dns-zone06 - Verify SOA &#39;minimum&#39; (default TTL) value</a></li><li><a href="#Test-Case-dns-zone07">dns-zone07 - Verify that SOA master is not an alias (CNAME)</a></li><li><a href="#Test-Case-dns-zone10">dns-zone10 - Verify that the zone of the domain to be tested return exactly one SOA record</a></li><li><a href="#Test-Case-dnssec-01">dnssec-01 - Verifies that all DS records have digest types registered with IANA</a></li><li><a href="#Test-Case-dnssec-02">dnssec-02 - Verifies that all DS records have a matching DNSKEY</a></li><li><a href="#Test-Case-dnssec-03">dnssec-03 - Check iteration counts for NSEC3</a></li><li><a href="#Test-Case-dnssec-04">dnssec-04 - Checks the durations of the signatures for the DNSKEY and SOA RRsets</a></li><li><a href="#Test-Case-dnssec-05">dnssec-05 - Check DNSKEY algorithms</a></li><li><a href="#Test-Case-dnssec-06">dnssec-06 - Check for DNSSEC extra processing at child nameservers</a></li><li><a href="#Test-Case-dnssec-08">dnssec-08 - Check that the DNSKEY RRset is signed</a></li><li><a href="#Test-Case-dnssec-09">dnssec-09 - Check that the SOA RRset is signed</a></li><li><a href="#Test-Case-dnssec-10">dnssec-10 - Check for the presence of either NSEC or NSEC3, with proper coverage and signatures</a></li><li><a href="#Test-Case-dnssec-13">dnssec-13 - Check that all DNSKEY algorithms are used to sign the zone</a></li><li><a href="#Test-Case-dnssec-14">dnssec-14 - Check for valid RSA DNSKEY key size</a></li><li><a href="#Test-Case-dnssec-15">dnssec-15 - Check existence of CDS and CDNSKEY</a></li><li><a href="#Test-Case-dnssec-16">dnssec-16 - Validate CDS</a></li><li><a href="#Test-Case-dnssec-17">dnssec-17 - Validate CDNSKEY</a></li><li><a href="#Test-Case-dnssecRSP01-ZSKRollover">dnssecRSP01-ZSKRollover - ZSK rollover</a></li><li><a href="#Test-Case-dnssecRSP02-KSKRollover">dnssecRSP02-KSKRollover - KSK rollover</a></li><li><a href="#Test-Case-dnssecRSP03-AlgorithmRollover">dnssecRSP03-AlgorithmRollover - algorithm rollover</a></li><li><a href="#Test-Case-epp-01">epp-01 - EPP server must have at least one A record</a></li><li><a href="#Test-Case-epp-02">epp-02 - EPP server must have at least one AAAA record</a></li><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li><li><a href="#Test-Case-epp-04">epp-04 - All service ports support TLSv1.2 or higher</a></li><li><a href="#Test-Case-epp-05">epp-05 - All service ports must not support TLSv1.1 or earlier</a></li><li><a href="#Test-Case-epp-06">epp-06 - All service ports must offer a valid certificate issued by a trusted CA</a></li><li><a href="#Test-Case-epp-07">epp-07 - TLS certificate must be valid</a></li><li><a href="#Test-Case-epp-08">epp-08 - TLS certificate must be valid for the server name</a></li><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-10">epp-10 - All server responses must validate against the XML schema</a></li><li><a href="#Test-Case-epp-11">epp-11 - &lt;svID&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-12">epp-12 - &lt;svDate&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-13">epp-13 - &lt;version&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-14">epp-14 - &lt;lang&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li><li><a href="#Test-Case-epp-18">epp-18 - &lt;hello&gt; command must return a &lt;greeting&gt;</a></li><li><a href="#Test-Case-epp-19">epp-19 - domain &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-20">epp-20 - domain sunrise &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-21">epp-21 - domain trademark claims &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-22">epp-22 - host &lt;check&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-23">epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-24">epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-25">epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-26">epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-27">epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-28">epp-28 - host &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-29">epp-29 - host &lt;info&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-30">epp-30 - host &lt;update&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-31">epp-31 - host &lt;delete&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-32">epp-32 - domain &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-33">epp-33 - domain &lt;info&gt; command test</a></li><li><a href="#Test-Case-epp-34">epp-34 - domain &lt;update&gt; command test</a></li><li><a href="#Test-Case-epp-35">epp-35 - domain &lt;renew&gt; command test</a></li><li><a href="#Test-Case-epp-36">epp-36 - domain &lt;transfer&gt; command test</a></li><li><a href="#Test-Case-epp-37">epp-37 - domain &lt;delete&gt; command test</a></li><li><a href="#Test-Case-epp-38">epp-38 - host rename test (if applicable)</a></li><li><a href="#Test-Case-epp-39">epp-39 - domain restore test (if applicable)</a></li><li><a href="#Test-Case-eppLaunch-01">eppLaunch-01 - launch application sunrise &lt;info&gt; command test</a></li><li><a href="#Test-Case-eppLaunch-02">eppLaunch-02 - domain/launch application sunrise &lt;create&gt; command test
</a></li><li><a href="#Test-Case-eppLaunch-03">eppLaunch-03 - domain trademark claims &lt;create&gt; command test</a></li><li><a href="#Test-Case-eppLaunch-04">eppLaunch-04 - LORDN submission test</a></li><li><a href="#Test-Case-rdap-domainCaseFoldingValidation">rdap-domainCaseFoldingValidation - Domain label case folding validation</a></li><li><a href="#Test-Case-rdap-domainNameValidation">rdap-domainNameValidation - Domain Name validation</a></li><li><a href="#Test-Case-rdap-ipv4Validation">rdap-ipv4Validation - IPv4 address validation</a></li><li><a href="#Test-Case-rdap-ipv6Validation">rdap-ipv6Validation - IPv6 address validation</a></li><li><a href="#Test-Case-rdap-nameserver_status">rdap-nameserver_status - validation of nameserver status codes</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_2_2_Validation">rdap-rdapResponseProfile_1_2_2_Validation - no JavaScript</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_3_Validation">rdap-rdapResponseProfile_1_3_Validation - presence of &#34;icann_rdap_response_profile_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_4_Validation">rdap-rdapResponseProfile_1_4_Validation - empty country name parameter of entity jCards</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_6_contactReprestentation">rdap-rdapResponseProfile_1_6_contactReprestentation - validate use of jCard and presence of alternative format(s)</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_10_Validation">rdap-rdapResponseProfile_2_10_Validation - presence of secureDNS property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_11_Validation">rdap-rdapResponseProfile_2_11_Validation - presence of &#34;RDDS Inaccuracy Complaint Form&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_1_Validation">rdap-rdapResponseProfile_2_1_Validation - presence of ldhName/unicodeName property for A-label/U-label domain lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_2_Validation">rdap-rdapResponseProfile_2_2_Validation - format of handle property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_1_Validation">rdap-rdapResponseProfile_2_3_1_1_Validation - presence of &#34;registration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_2_Validation">rdap-rdapResponseProfile_2_3_1_2_Validation - presence of &#34;expiration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation">rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation - presence of &#34;last update of RDAP database&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_1_Validation">rdap-rdapResponseProfile_2_4_1_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation">rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation - validation of the publicIds and handle properties of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_5_Validation">rdap-rdapResponseProfile_2_4_5_Validation - abuse role for the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_6_registrarAboutLink">rdap-rdapResponseProfile_2_4_6_registrarAboutLink - presence of &#34;about&#34; link in registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_1_Validation">rdap-rdapResponseProfile_2_6_1_Validation - at least one status code</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_3_Validation">rdap-rdapResponseProfile_2_6_3_Validation - presence of &#34;Status Codes&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_7_5_3_Validation">rdap-rdapResponseProfile_2_7_5_3_Validation - proper redaction of domain entities</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation">rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation - presence and validity of ldhName, handle, status properties in domain nameservers</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_1_Validation">rdap-rdapResponseProfile_4_1_Validation - presence of ldhName/unicodeName property for A-label/U-label nameserver lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_3_Validation">rdap-rdapResponseProfile_4_3_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_notices_included_Validation">rdap-rdapResponseProfile_notices_included_Validation - presence of &#34;notices&#34; property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc3915_Validation">rdap-rdapResponseProfile_rfc3915_Validation - RGP status code validation</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc5731_Validation">rdap-rdapResponseProfile_rfc5731_Validation - domain status code validation</a></li><li><a href="#Test-Case-rdap-rdaptigSection_1_1_3_redactionExtension">rdap-rdaptigSection_1_1_3_redactionExtension - use of Redacted Fields extension, validation of redacted paths</a></li><li><a href="#Test-Case-rdap-rdaptigSection_3_3_3_termsOfService">rdap-rdaptigSection_3_3_3_termsOfService - presence of terms-of-service link</a></li><li><a href="#Test-Case-rdap-stdRdapAsEventActorValidation">rdap-stdRdapAsEventActorValidation - asEventActor Validation</a></li><li><a href="#Test-Case-rdap-stdRdapConformanceValidation">rdap-stdRdapConformanceValidation - RDAP Conformance validation</a></li><li><a href="#Test-Case-rdap-stdRdapDomainLookupValidation">rdap-stdRdapDomainLookupValidation - Domain Lookup Validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntitiesValidation">rdap-stdRdapEntitiesValidation - Entities validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntityLookupValidation">rdap-stdRdapEntityLookupValidation - Entity lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapErrorResponseBodyValidation">rdap-stdRdapErrorResponseBodyValidation - Error Response Body</a></li><li><a href="#Test-Case-rdap-stdRdapEventsValidation">rdap-stdRdapEventsValidation - Events Validation</a></li><li><a href="#Test-Case-rdap-stdRdapHelpValidation">rdap-stdRdapHelpValidation - Help validation</a></li><li><a href="#Test-Case-rdap-stdRdapIpAddressesValidation">rdap-stdRdapIpAddressesValidation - IP Addresses Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLanguageIdentifierValidation">rdap-stdRdapLanguageIdentifierValidation - Language Identifier Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLdhNameValidation">rdap-stdRdapLdhNameValidation - LDH name</a></li><li><a href="#Test-Case-rdap-stdRdapLinksValidation">rdap-stdRdapLinksValidation - Links validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserverLookupValidation">rdap-stdRdapNameserverLookupValidation - Nameserver lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserversSearchValidation">rdap-stdRdapNameserversSearchValidation - Nameservers search validation</a></li><li><a href="#Test-Case-rdap-stdRdapNoticesRemarksValidation">rdap-stdRdapNoticesRemarksValidation - Notices and Remarks Validation</a></li><li><a href="#Test-Case-rdap-stdRdapPort43WhoisServerValidation">rdap-stdRdapPort43WhoisServerValidation - Port 43 WHOIS Server</a></li><li><a href="#Test-Case-rdap-stdRdapPublicIdsValidation">rdap-stdRdapPublicIdsValidation - Public IDs validation</a></li><li><a href="#Test-Case-rdap-stdRdapRolesValidation">rdap-stdRdapRolesValidation - Roles validation</a></li><li><a href="#Test-Case-rdap-stdRdapSecureDnsValidation">rdap-stdRdapSecureDnsValidation - Secure DNS validation</a></li><li><a href="#Test-Case-rdap-stdRdapStatusValidation">rdap-stdRdapStatusValidation - Status validation</a></li><li><a href="#Test-Case-rdap-stdRdapUnicodeNameValidation">rdap-stdRdapUnicodeNameValidation - Unicode name</a></li><li><a href="#Test-Case-rdap-stdRdapVariantsValidation">rdap-stdRdapVariantsValidation - Variants validation</a></li><li><a href="#Test-Case-rdap-tigSection_1_11_1_Validation">rdap-tigSection_1_11_1_Validation - bootstrap registration</a></li><li><a href="#Test-Case-rdap-tigSection_1_13_Validation">rdap-tigSection_1_13_Validation - Access-Control-Allow-Origin header</a></li><li><a href="#Test-Case-rdap-tigSection_1_14_Validation">rdap-tigSection_1_14_Validation - presence of &#34;icann_rdap_technical_implementation_guide_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-tigSection_1_2_Validation">rdap-tigSection_1_2_Validation - use of HTTPS</a></li><li><a href="#Test-Case-rdap-tigSection_1_3_Validation">rdap-tigSection_1_3_Validation - use of obsolete SSL/TLS versions</a></li><li><a href="#Test-Case-rdap-tigSection_1_6_Validation">rdap-tigSection_1_6_Validation - support for HEAD</a></li><li><a href="#Test-Case-rdap-tigSection_1_8_Validation">rdap-tigSection_1_8_Validation - IPv4/IPv6 resolvability</a></li><li><a href="#Test-Case-rdap-tigSection_3_2_Validation">rdap-tigSection_3_2_Validation - rel=&#34;related&#34; link in topmost object</a></li><li><a href="#Test-Case-rdap-tigSection_3_3_and_3_4_Validation">rdap-tigSection_3_3_and_3_4_Validation - presence of link object(s) in notice(s)</a></li><li><a href="#Test-Case-rdap-tigSection_4_1_Validation">rdap-tigSection_4_1_Validation - structured addresses in entity jCards</a></li><li><a href="#Test-Case-rdap-tigSection_6_1_Validation">rdap-tigSection_6_1_Validation - publicIds property of registrar entity</a></li><li><a href="#Test-Case-rdap-tigSection_7_1_and_7_2_Validation">rdap-tigSection_7_1_and_7_2_Validation - voice/fax type for tel nodes in entity jCards</a></li><li><a href="#Test-Case-rdap-webUriValidation">rdap-webUriValidation - Web URI validation</a></li><li><a href="#Test-Case-rde-01">rde-01 - validate filename format</a></li><li><a href="#Test-Case-rde-02">rde-02 - validate signature(s)</a></li><li><a href="#Test-Case-rde-03">rde-03 - decrypt deposit file(s)</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-06">rde-06 - validate object counts</a></li><li><a href="#Test-Case-rde-07">rde-07 - validate domain objects</a></li><li><a href="#Test-Case-rde-08">rde-08 - validate host objects (if applicable)</a></li><li><a href="#Test-Case-rde-09">rde-09 - validate contact objects (if applicable)</a></li><li><a href="#Test-Case-rde-10">rde-10 - validate registrar objects</a></li><li><a href="#Test-Case-rde-11">rde-11 - validate IDN table objects</a></li><li><a href="#Test-Case-rde-12">rde-12 - validate NNDN objects</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li><li><a href="#Test-Case-rde-14">rde-14 - validate policy object</a></li></ol></details></li><li><details><summary><a href="#input-parameters">Input Parameters</a></summary><ol><li><a href="#Input-Parameter-epp.clid">epp.clid</a></li><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-epp.port">epp.port</a></li><li><a href="#Input-Parameter-epp.pwd">epp.pwd</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-general.sunriseModel">general.sunriseModel</a></li><li><a href="#Input-Parameter-idn.tableIDs">idn.tableIDs</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li><li><a href="#Input-Parameter-rde.signature">rde.signature</a></li></ol></details></li></ol><a class="toc-link" href="#table-of-contents" title="Table of Contents">● ━━<br />● ━━<br />● ━━</a></nav><main><section><a name="preamble"></a><h2>2. Preamble</h2><div class="markdown-content"><p>The Test System consists of several <em>test plans</em>, each of
which addresses a particular scenario. The test plans follow a standard
structure and methodology derived from ISO/IEC 29119 <em>(formerly IEEE
829-2008)</em>.</p>
<p>Each <em>test plan</em> includes one or more <em>test suites</em>,
which in turn include one or more <em>test cases</em>. For a test to
succeed, every test case has to pass.</p>
<p>This file describes each test plan, suite and case in the RST
system.</p>
<h3 id="key-acronyms-and-terms">2.1. Key acronyms and terms</h3>
<dl>
<dt>RST</dt>
<dd>
Registry System Testing. This system.
</dd>
<dt>PDT</dt>
<dd>
Pre-Delegation Test. A test carried out prior to the delegation of a new
TLD into the DNS root zone.
</dd>
<dt>RSP</dt>
<dd>
Registry Service Provider. A specialist provider of critical registry
services.
</dd>
<dt>DNS</dt>
<dd>
Domain Name System. The internet’s system of globally unique
identifiers.
</dd>
<dt>TLD</dt>
<dd>
Top-level domain. The highest level of the DNS namespace hierarchy.
</dd>
<dt>gTLD</dt>
<dd>
generic top-level domain.
</dd>
<dt>DNSSEC</dt>
<dd>
DNS Security Extensions.
</dd>
<dt>EPP</dt>
<dd>
Extensible Provisioning Protocol. The protocol used by registrars to
create and manage domain name registrations in an SRS.
</dd>
<dt>SRS</dt>
<dd>
Shared Registry System. A TLD registry in which registrations are
managed by one or more registrars, using EPP.
</dd>
<dt>RDDS</dt>
<dd>
Registration Data Directory Services. A service to provide access to
data about domain registrations to third parties.
</dd>
<dt>RDAP</dt>
<dd>
Registration Data Access Protocol. The protocol used to deliver the
RDDS.
</dd>
<dt>RDE</dt>
<dd>
Registry Data Escrow. A system whereby the registration data stored in a
Shared Registry System is backed up to a trusted third party.
</dd>
<dt>IDN</dt>
<dd>
Internationalized Domain Name. A domain name that contains characters
not in the ASCII character set.
</dd>
<dt>LGR</dt>
<dd>
Label Generation Ruleset. The rules by which IDN domain names are
validated.
</dd>
<dt>RO</dt>
<dd>
Registry Operator. The entity which ICANN has granted the right to
operate a gTLD.
</dd>
<dt>RA</dt>
<dd>
Registry Agreement. The contract between a Registry Operator and ICANN.
</dd>
<dt>KSK</dt>
<dd>
Key Signing Key. A cryptographic key which acts as the Secure Entry
Point for a DNS zone, and which signs a DNS zone’s ZSKs. A digest of
this key is published in the parent zone (ie. the root zone for a TLD).
</dd>
<dt>ZSK</dt>
<dd>
Zone Signing Key. A cryptographic key which signs a DNS zone’s resource
records.
</dd>
</dl>
</div></section><a name="test-plans"></a><h2>3. Test Plans</h2><section><a name="Test-Plan-StandardPreDelegationTest"></a><h3>3.1. Pre-Delegation Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>StandardPreDelegationTest</pre><h4>Description</h4><div class="markdown-content"><p>The purpose of the Pre-Delegation Test is to verify that the
applicant has met its commitment to establish registry operations in
accordance with the technical and operational criteria described in the
gTLD Applicant Guidebook (AGB). Each applicant will be required to
complete PDT as a prerequisite to delegation into the root zone.</p>
<p>The Pre-Delegation Test covers all critical registry services and
IDNs, and therefore uses all test suites.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-StandardIDN">Internationalized Domain Names (IDN)</a></li><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li></ol></section><section><a name="Test-Plan-StandardRSPChangeTest"></a><h3>3.2. RSP Change Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>StandardRSPChangeTest</pre><h4>Description</h4><div class="markdown-content"><p>A Registry Operator may apply to ICANN to change a Material
Subcontracting Arrangement (MSA) and appoint a new Registry Services
Provider. Before this change can be approved, the new RSP must complete
Registry System Testing to ensure their systems comply with the
technical and operational requirements of the Registry Agreement.</p>
<p>The RSP Change Test covers all critical registry services and IDNs,
and therefore uses all test suites.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-StandardIDN">Internationalized Domain Names (IDN)</a></li><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li></ol></section><section><a name="Test-Plan-DNSRSPChangeTest"></a><h3>3.3. DNS Registry Service Provider Change Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>DNSRSPChangeTest</pre><h4>Description</h4><div class="markdown-content"><p>A Registry Operator may apply to ICANN to change a Material
Subcontracting Arrangement (MSA) and appoint a new provider of
authoritative DNS services instead of or in addition to any existing
provider(s).</p>
<p>Before this change can be approved, the new DNS provider must
complete testing to ensure their systems comply with the technical and
operational requirements of the Registry Agreement.</p>
<p>The DNS RSP Change Test uses the DNS test suite only.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li></ol></section><section><a name="Test-Plan-IDNTest"></a><h3>3.4. Internationalized Domain Name Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>IDNTest</pre><h4>Description</h4><div class="markdown-content"><p>A Registry Operator may apply to ICANN to amend its Registry
Agreement to offer new scripts and/or languages for Internationalized
Domain Names.</p>
<p>The purpose of an IDN RST test is to verify that the Registry
Operator’s registry system handles IDN registrations in accordance with
the submitted policy statements and IDN tables.</p>
<p>The IDN Test uses the IDN test suite only.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardIDN">Internationalized Domain Names (IDN)</a></li></ol></section><section><a name="Test-Plan-SRSGatewayTest"></a><h3>3.5. SRS Gateway Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>SRSGatewayTest</pre><h4>Description</h4><div class="markdown-content"><p>An SRS Gateway service is a Shared Registry System implementation
that acts as a proxy between a subset of Registrars and the Registry. It
uses a local cache to speed up EPP query commands, but forwards all EPP
transform commands to the TLD Registry System. TLD registries need to
deploy a proxy setup in order to operate in certain markets
worldwide.</p>
<p>The purpose of an SRS Gateway Test is to verify that the Registry
Operator’s proxy setup operates in accordance with the technical and
operational criteria for EPP systems described in the gTLD Applicant
Guidebook (AGB). Furthermore, it must keep its own database synchronized
with that of the TLD registry.</p>
<p>The SRS Gateway Test Change Test uses the RDDS and EPP test
suites.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardSRSGateway">SRS Gateway</a></li></ol></section><section><a name="Test-Plan-MainRSPEvaluationTest"></a><h3>3.6. Main RSP Evaluation Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>MainRSPEvaluationTest</pre><h4>Description</h4><div class="markdown-content"><p>The Main RSP is responsible for the creation and maintenance of
domain name registrations in a Shared Registration System (SRS). This
encompasses the lifecycle of a domain name registration using domain
registrars and protocols such as the Extensible Provisioning Protocol
(EPP) and adherence to policies regarding the use and transparency
domain name registrations through reporting, the Registration Data
Access Protocol (RDAP), and other mechanisms.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-StandardIDN">Internationalized Domain Names (IDN)</a></li><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li></ol></section><section><a name="Test-Plan-DNSRSPEvaluationTest"></a><h3>3.7. DNS RSP Evaluation Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>DNSRSPEvaluationTest</pre><h4>Description</h4><div class="markdown-content"><p>DNS RSPs provide primary or secondary authoritative DNS services.
Therefore, this test plan only covers the DNS area.</p>
<p>RSPs wishing to offer DNSSEC services in addition to authoritative
DNS will also be evaluated using the DNSSEC RSP Evaluation Test
below.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li></ol></section><section><a name="Test-Plan-DNSSECRSPEvaluationTest"></a><h3>3.8. DNSSEC RSP Evaluation Test</h3><h4>Plan ID</h4><p>The following Test Plan ID may be used with the RST API:</p>
<pre>DNSSECRSPEvaluationTest</pre><h4>Description</h4><div class="markdown-content"><p>DNSSEC RSPs provide signing of TLD zone files as a service. They do
not provide primary or secondary authoritative DNS services.</p>
<p>RSPs wishing to offer DNSSEC services in addition to authoritative
DNS will also be evaluated using the DNSSEC RSP Evaluation Test
below.</p>
</div><h4>Test suites</h4><p>This plan uses the following test suites:</p>
<ol><li><a href="#Test-Suite-DNSSECOperations">DNSSEC RSP - Operations</a></li><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li></ol></section><a name="test-suites"></a><h2>4. Test Suites</h2><section><a name="Test-Suite-StandardDNS"></a><h3>4.1. Authoritative DNS</h3><h4>Description</h4><div class="markdown-content"><p>The DNS test suite validates the authoritative DNS services for the
TLD or RSP.</p>
<p>The DNS test suite is taken from the test plans that are part of the
<a href="https://github.com/zonemaster">Zonemaster software</a>
(<code>Zonemaster::Engine</code> version v4.7.3). Test case IDs from
this document can be mapped to the Zonemaster test IDs by removing the
<code>dns-</code> prefix.</p>
<p>Since Zonemaster is designed to perform testing of domain names
anywhere in the DNS hierarchy, not all Zonemaster tests are applicable
for TLDs and may not be listed in the test suites in this document.</p>
<h4
id="testing-of-anycast-networks-using-multiple-vantage-points">Testing
of Anycast networks using multiple vantage points</h4>
<p>In order to test anycast networks without requiring RSPs to provide
the unicast adresses of their nodes, all tests carried out over the
network will be performed from multiple vantage points. All vantage
points must receive the same response in order for the tests to
pass.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-dns-address01">dns-address01 - Verify that IPv4 addresse are not in private networks</a></li><li><a href="#Test-Case-dns-address02">dns-address02 - Verify reverse DNS entries exist for nameserver IP addresses</a></li><li><a href="#Test-Case-dns-address03">dns-address03 - Verify that reverse DNS entries match nameserver names</a></li><li><a href="#Test-Case-dns-connectivity01">dns-connectivity01 - Verify nameserver UDP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity02">dns-connectivity02 - Verify nameserver TCP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity03">dns-connectivity03 - Verify that all nameservers do not belong to the same AS</a></li><li><a href="#Test-Case-dns-connectivity04">dns-connectivity04 - Verify that name servers are not announced in the same IP prefix</a></li><li><a href="#Test-Case-dns-consistency01">dns-consistency01 - Query all nameservers for SOA, and verify that they all have the same SOA serial number</a></li><li><a href="#Test-Case-dns-consistency02">dns-consistency02 - Query all nameservers for SOA, and verify that they all have the same SOA rname</a></li><li><a href="#Test-Case-dns-consistency03">dns-consistency03 - Query all nameservers for SOA, and verify that they all have the same time parameters (REFRESH/RETRY/EXPIRE/MINIMUM)</a></li><li><a href="#Test-Case-dns-consistency04">dns-consistency04 - Query all nameservers for the NS set, and verify that they have all the same content</a></li><li><a href="#Test-Case-dns-consistency05">dns-consistency05 - Verify that the glue records are consistent with authoritative data</a></li><li><a href="#Test-Case-dns-consistency06">dns-consistency06 - Query all nameservers for SOA, and verify that they all have the same SOA mname</a></li><li><a href="#Test-Case-dns-delegation01">dns-delegation01 - Verify that there are more than two nameservers</a></li><li><a href="#Test-Case-dns-delegation02">dns-delegation02 - Verify that name servers have distinct IP addresses</a></li><li><a href="#Test-Case-dns-delegation03">dns-delegation03 - Verify that there is no truncation on referrals</a></li><li><a href="#Test-Case-dns-delegation04">dns-delegation04 - Verify that nameservers are authoritative</a></li><li><a href="#Test-Case-dns-delegation05">dns-delegation05 - Verify that NS RRs do not point to CNAMEs</a></li><li><a href="#Test-Case-dns-delegation06">dns-delegation06 - Verify existence of SOA</a></li><li><a href="#Test-Case-dns-nameserver01">dns-nameserver01 - Verify that nameserver does not provide recursive service</a></li><li><a href="#Test-Case-dns-nameserver02">dns-nameserver02 - Verify EDNS0 support</a></li><li><a href="#Test-Case-dns-nameserver04">dns-nameserver04 - Verify that replies from nameserver comes from the expected IP address</a></li><li><a href="#Test-Case-dns-nameserver05">dns-nameserver05 - Verify behaviour against AAAA queries</a></li><li><a href="#Test-Case-dns-nameserver06">dns-nameserver06 - Verify that each nameserver can be resolved to an IP address</a></li><li><a href="#Test-Case-dns-nameserver07">dns-nameserver07 - Check whether authoritative name servers return an upward referral</a></li><li><a href="#Test-Case-dns-nameserver08">dns-nameserver08 - Check whether authoritative name servers responses match the case of every letter in QNAME</a></li><li><a href="#Test-Case-dns-nameserver09">dns-nameserver09 - Check whether authoritative name servers return same results for equivalent names with different cases in the request</a></li><li><a href="#Test-Case-dns-nameserver10">dns-nameserver10 - Check whether authoritative name servers respond correctly to queries with undefined EDNS version</a></li><li><a href="#Test-Case-dns-nameserver11">dns-nameserver11 - Check whether authoritative name servers responses doe not include unknown EDNS OPTION-CODE used in query</a></li><li><a href="#Test-Case-dns-nameserver12">dns-nameserver12 - Check whether authoritative name servers responses has &#34;Z&#34; bits cleared even if they are set in the query</a></li><li><a href="#Test-Case-dns-nameserver13">dns-nameserver13 - Verify that if the response to a query with an OPT record is truncated, then the response will contain an OPT record</a></li><li><a href="#Test-Case-dns-syntax05">dns-syntax05 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given has a conform usage of at sign (@)</a></li><li><a href="#Test-Case-dns-syntax06">dns-syntax06 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given is RFC822 compliant</a></li><li><a href="#Test-Case-dns-syntax07">dns-syntax07 - Verify that SOA mname of zone given conforms to syntax rules</a></li><li><a href="#Test-Case-dns-zone01">dns-zone01 - Check that master nameserver in SOA is fully qualified</a></li><li><a href="#Test-Case-dns-zone02">dns-zone02 - Verify SOA &#39;refresh&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone03">dns-zone03 - Verify SOA &#39;retry&#39; value is lower than SOA &#39;refresh&#39; value</a></li><li><a href="#Test-Case-dns-zone04">dns-zone04 - Verify SOA &#39;retry&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone05">dns-zone05 - Verify SOA &#39;expire&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone06">dns-zone06 - Verify SOA &#39;minimum&#39; (default TTL) value</a></li><li><a href="#Test-Case-dns-zone07">dns-zone07 - Verify that SOA master is not an alias (CNAME)</a></li><li><a href="#Test-Case-dns-zone10">dns-zone10 - Verify that the zone of the domain to be tested return exactly one SOA record</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-StandardDNSSEC"></a><h3>4.2. DNS Security Extensions (DNSSEC)</h3><h4>Description</h4><div class="markdown-content"><p>The DNSSEC test suite validates the DNSSEC signing service for the
TLD or RSP.</p>
<p>The DNSSEC test suite is taken from the test plans that are part of
the <a href="https://github.com/zonemaster">Zonemaster software</a>
(<code>Zonemaster::Engine</code> version v4.7.3). Test case IDs from
this document can be mapped to the Zonemaster test IDs by removing the
<code>dnssec-</code> prefix.</p>
<p>Since Zonemaster is designed to perform testing of domain names
anywhere in the DNS hierarchy, not all Zonemaster tests are applicable
for TLDs and may not be listed in the test suites in this document.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-dnssec-01">dnssec-01 - Verifies that all DS records have digest types registered with IANA</a></li><li><a href="#Test-Case-dnssec-02">dnssec-02 - Verifies that all DS records have a matching DNSKEY</a></li><li><a href="#Test-Case-dnssec-03">dnssec-03 - Check iteration counts for NSEC3</a></li><li><a href="#Test-Case-dnssec-04">dnssec-04 - Checks the durations of the signatures for the DNSKEY and SOA RRsets</a></li><li><a href="#Test-Case-dnssec-05">dnssec-05 - Check DNSKEY algorithms</a></li><li><a href="#Test-Case-dnssec-06">dnssec-06 - Check for DNSSEC extra processing at child nameservers</a></li><li><a href="#Test-Case-dnssec-08">dnssec-08 - Check that the DNSKEY RRset is signed</a></li><li><a href="#Test-Case-dnssec-09">dnssec-09 - Check that the SOA RRset is signed</a></li><li><a href="#Test-Case-dnssec-10">dnssec-10 - Check for the presence of either NSEC or NSEC3, with proper coverage and signatures</a></li><li><a href="#Test-Case-dnssec-13">dnssec-13 - Check that all DNSKEY algorithms are used to sign the zone</a></li><li><a href="#Test-Case-dnssec-14">dnssec-14 - Check for valid RSA DNSKEY key size</a></li><li><a href="#Test-Case-dnssec-15">dnssec-15 - Check existence of CDS and CDNSKEY</a></li><li><a href="#Test-Case-dnssec-16">dnssec-16 - Validate CDS</a></li><li><a href="#Test-Case-dnssec-17">dnssec-17 - Validate CDNSKEY</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-StandardRDDS"></a><h3>4.3. Registration Data Directory Services (RDDS)</h3><h4>Description</h4><div class="markdown-content"><p>The DNSSEC test suite validates the RDDS service(s) of the TLD or
RSP.</p>
<p>The RDAP test suite is derived from the test specification of the <a
href="https://github.com/icann/rdap-conformance-tool/blob/master/doc/RDAPConformanceToolSpecifications.pdf">RDAP
Conformance Tool</a>. As with the DNS and DNSSEC tests, the test IDs can
be mapped to the test IDs in this document by removing the
<code>rdap-</code> prefix.</p>
<p>Due to the upcoming retirement of Nicname/Whois, port-43 services are
not tested.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-rdap-domainCaseFoldingValidation">rdap-domainCaseFoldingValidation - Domain label case folding validation</a></li><li><a href="#Test-Case-rdap-domainNameValidation">rdap-domainNameValidation - Domain Name validation</a></li><li><a href="#Test-Case-rdap-ipv4Validation">rdap-ipv4Validation - IPv4 address validation</a></li><li><a href="#Test-Case-rdap-ipv6Validation">rdap-ipv6Validation - IPv6 address validation</a></li><li><a href="#Test-Case-rdap-nameserver_status">rdap-nameserver_status - validation of nameserver status codes</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_2_2_Validation">rdap-rdapResponseProfile_1_2_2_Validation - no JavaScript</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_3_Validation">rdap-rdapResponseProfile_1_3_Validation - presence of &#34;icann_rdap_response_profile_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_4_Validation">rdap-rdapResponseProfile_1_4_Validation - empty country name parameter of entity jCards</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_6_contactReprestentation">rdap-rdapResponseProfile_1_6_contactReprestentation - validate use of jCard and presence of alternative format(s)</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_10_Validation">rdap-rdapResponseProfile_2_10_Validation - presence of secureDNS property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_11_Validation">rdap-rdapResponseProfile_2_11_Validation - presence of &#34;RDDS Inaccuracy Complaint Form&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_1_Validation">rdap-rdapResponseProfile_2_1_Validation - presence of ldhName/unicodeName property for A-label/U-label domain lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_2_Validation">rdap-rdapResponseProfile_2_2_Validation - format of handle property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_1_Validation">rdap-rdapResponseProfile_2_3_1_1_Validation - presence of &#34;registration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_2_Validation">rdap-rdapResponseProfile_2_3_1_2_Validation - presence of &#34;expiration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation">rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation - presence of &#34;last update of RDAP database&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_1_Validation">rdap-rdapResponseProfile_2_4_1_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation">rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation - validation of the publicIds and handle properties of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_5_Validation">rdap-rdapResponseProfile_2_4_5_Validation - abuse role for the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_6_registrarAboutLink">rdap-rdapResponseProfile_2_4_6_registrarAboutLink - presence of &#34;about&#34; link in registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_1_Validation">rdap-rdapResponseProfile_2_6_1_Validation - at least one status code</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_3_Validation">rdap-rdapResponseProfile_2_6_3_Validation - presence of &#34;Status Codes&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_7_5_3_Validation">rdap-rdapResponseProfile_2_7_5_3_Validation - proper redaction of domain entities</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation">rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation - presence and validity of ldhName, handle, status properties in domain nameservers</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_1_Validation">rdap-rdapResponseProfile_4_1_Validation - presence of ldhName/unicodeName property for A-label/U-label nameserver lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_3_Validation">rdap-rdapResponseProfile_4_3_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_notices_included_Validation">rdap-rdapResponseProfile_notices_included_Validation - presence of &#34;notices&#34; property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc3915_Validation">rdap-rdapResponseProfile_rfc3915_Validation - RGP status code validation</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc5731_Validation">rdap-rdapResponseProfile_rfc5731_Validation - domain status code validation</a></li><li><a href="#Test-Case-rdap-rdaptigSection_1_1_3_redactionExtension">rdap-rdaptigSection_1_1_3_redactionExtension - use of Redacted Fields extension, validation of redacted paths</a></li><li><a href="#Test-Case-rdap-rdaptigSection_3_3_3_termsOfService">rdap-rdaptigSection_3_3_3_termsOfService - presence of terms-of-service link</a></li><li><a href="#Test-Case-rdap-stdRdapAsEventActorValidation">rdap-stdRdapAsEventActorValidation - asEventActor Validation</a></li><li><a href="#Test-Case-rdap-stdRdapConformanceValidation">rdap-stdRdapConformanceValidation - RDAP Conformance validation</a></li><li><a href="#Test-Case-rdap-stdRdapDomainLookupValidation">rdap-stdRdapDomainLookupValidation - Domain Lookup Validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntitiesValidation">rdap-stdRdapEntitiesValidation - Entities validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntityLookupValidation">rdap-stdRdapEntityLookupValidation - Entity lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapErrorResponseBodyValidation">rdap-stdRdapErrorResponseBodyValidation - Error Response Body</a></li><li><a href="#Test-Case-rdap-stdRdapEventsValidation">rdap-stdRdapEventsValidation - Events Validation</a></li><li><a href="#Test-Case-rdap-stdRdapHelpValidation">rdap-stdRdapHelpValidation - Help validation</a></li><li><a href="#Test-Case-rdap-stdRdapIpAddressesValidation">rdap-stdRdapIpAddressesValidation - IP Addresses Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLanguageIdentifierValidation">rdap-stdRdapLanguageIdentifierValidation - Language Identifier Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLdhNameValidation">rdap-stdRdapLdhNameValidation - LDH name</a></li><li><a href="#Test-Case-rdap-stdRdapLinksValidation">rdap-stdRdapLinksValidation - Links validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserverLookupValidation">rdap-stdRdapNameserverLookupValidation - Nameserver lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserversSearchValidation">rdap-stdRdapNameserversSearchValidation - Nameservers search validation</a></li><li><a href="#Test-Case-rdap-stdRdapNoticesRemarksValidation">rdap-stdRdapNoticesRemarksValidation - Notices and Remarks Validation</a></li><li><a href="#Test-Case-rdap-stdRdapPort43WhoisServerValidation">rdap-stdRdapPort43WhoisServerValidation - Port 43 WHOIS Server</a></li><li><a href="#Test-Case-rdap-stdRdapPublicIdsValidation">rdap-stdRdapPublicIdsValidation - Public IDs validation</a></li><li><a href="#Test-Case-rdap-stdRdapRolesValidation">rdap-stdRdapRolesValidation - Roles validation</a></li><li><a href="#Test-Case-rdap-stdRdapSecureDnsValidation">rdap-stdRdapSecureDnsValidation - Secure DNS validation</a></li><li><a href="#Test-Case-rdap-stdRdapStatusValidation">rdap-stdRdapStatusValidation - Status validation</a></li><li><a href="#Test-Case-rdap-stdRdapUnicodeNameValidation">rdap-stdRdapUnicodeNameValidation - Unicode name</a></li><li><a href="#Test-Case-rdap-stdRdapVariantsValidation">rdap-stdRdapVariantsValidation - Variants validation</a></li><li><a href="#Test-Case-rdap-tigSection_1_11_1_Validation">rdap-tigSection_1_11_1_Validation - bootstrap registration</a></li><li><a href="#Test-Case-rdap-tigSection_1_13_Validation">rdap-tigSection_1_13_Validation - Access-Control-Allow-Origin header</a></li><li><a href="#Test-Case-rdap-tigSection_1_14_Validation">rdap-tigSection_1_14_Validation - presence of &#34;icann_rdap_technical_implementation_guide_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-tigSection_1_2_Validation">rdap-tigSection_1_2_Validation - use of HTTPS</a></li><li><a href="#Test-Case-rdap-tigSection_1_3_Validation">rdap-tigSection_1_3_Validation - use of obsolete SSL/TLS versions</a></li><li><a href="#Test-Case-rdap-tigSection_1_6_Validation">rdap-tigSection_1_6_Validation - support for HEAD</a></li><li><a href="#Test-Case-rdap-tigSection_1_8_Validation">rdap-tigSection_1_8_Validation - IPv4/IPv6 resolvability</a></li><li><a href="#Test-Case-rdap-tigSection_3_2_Validation">rdap-tigSection_3_2_Validation - rel=&#34;related&#34; link in topmost object</a></li><li><a href="#Test-Case-rdap-tigSection_3_3_and_3_4_Validation">rdap-tigSection_3_3_and_3_4_Validation - presence of link object(s) in notice(s)</a></li><li><a href="#Test-Case-rdap-tigSection_4_1_Validation">rdap-tigSection_4_1_Validation - structured addresses in entity jCards</a></li><li><a href="#Test-Case-rdap-tigSection_6_1_Validation">rdap-tigSection_6_1_Validation - publicIds property of registrar entity</a></li><li><a href="#Test-Case-rdap-tigSection_7_1_and_7_2_Validation">rdap-tigSection_7_1_and_7_2_Validation - voice/fax type for tel nodes in entity jCards</a></li><li><a href="#Test-Case-rdap-webUriValidation">rdap-webUriValidation - Web URI validation</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-StandardEPP"></a><h3>4.4. Extensible Provisioning Protocol (EPP)</h3><h4>Description</h4><div class="markdown-content"><p>The EPP test suite validates the EPP service of the TLD or RSP.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-epp-01">epp-01 - EPP server must have at least one A record</a></li><li><a href="#Test-Case-epp-02">epp-02 - EPP server must have at least one AAAA record</a></li><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li><li><a href="#Test-Case-epp-04">epp-04 - All service ports support TLSv1.2 or higher</a></li><li><a href="#Test-Case-epp-05">epp-05 - All service ports must not support TLSv1.1 or earlier</a></li><li><a href="#Test-Case-epp-06">epp-06 - All service ports must offer a valid certificate issued by a trusted CA</a></li><li><a href="#Test-Case-epp-07">epp-07 - TLS certificate must be valid</a></li><li><a href="#Test-Case-epp-08">epp-08 - TLS certificate must be valid for the server name</a></li><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-10">epp-10 - All server responses must validate against the XML schema</a></li><li><a href="#Test-Case-epp-11">epp-11 - &lt;svID&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-12">epp-12 - &lt;svDate&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-13">epp-13 - &lt;version&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-14">epp-14 - &lt;lang&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li><li><a href="#Test-Case-epp-18">epp-18 - &lt;hello&gt; command must return a &lt;greeting&gt;</a></li><li><a href="#Test-Case-epp-19">epp-19 - domain &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-20">epp-20 - domain sunrise &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-21">epp-21 - domain trademark claims &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-22">epp-22 - host &lt;check&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-23">epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-24">epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-25">epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-26">epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-27">epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-28">epp-28 - host &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-29">epp-29 - host &lt;info&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-30">epp-30 - host &lt;update&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-31">epp-31 - host &lt;delete&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-32">epp-32 - domain &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-33">epp-33 - domain &lt;info&gt; command test</a></li><li><a href="#Test-Case-epp-34">epp-34 - domain &lt;update&gt; command test</a></li><li><a href="#Test-Case-epp-35">epp-35 - domain &lt;renew&gt; command test</a></li><li><a href="#Test-Case-epp-36">epp-36 - domain &lt;transfer&gt; command test</a></li><li><a href="#Test-Case-epp-37">epp-37 - domain &lt;delete&gt; command test</a></li><li><a href="#Test-Case-epp-38">epp-38 - host rename test (if applicable)</a></li><li><a href="#Test-Case-epp-39">epp-39 - domain restore test (if applicable)</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol><li><a href="#Input-Parameter-epp.clid">epp.clid</a></li><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-epp.port">epp.port</a></li><li><a href="#Input-Parameter-epp.pwd">epp.pwd</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ol></section><section><a name="Test-Suite-StandardRDE"></a><h3>4.5. Registry Data Escrow (RDE)</h3><h4>Description</h4><div class="markdown-content"><p>The RDE test suite validates Registry Data Escrow deposits generated
for the TLD or RSP.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-rde-01">rde-01 - validate filename format</a></li><li><a href="#Test-Case-rde-02">rde-02 - validate signature(s)</a></li><li><a href="#Test-Case-rde-03">rde-03 - decrypt deposit file(s)</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-06">rde-06 - validate object counts</a></li><li><a href="#Test-Case-rde-07">rde-07 - validate domain objects</a></li><li><a href="#Test-Case-rde-08">rde-08 - validate host objects (if applicable)</a></li><li><a href="#Test-Case-rde-09">rde-09 - validate contact objects (if applicable)</a></li><li><a href="#Test-Case-rde-10">rde-10 - validate registrar objects</a></li><li><a href="#Test-Case-rde-11">rde-11 - validate IDN table objects</a></li><li><a href="#Test-Case-rde-12">rde-12 - validate NNDN objects</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li><li><a href="#Test-Case-rde-14">rde-14 - validate policy object</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-idn.tableIDs">idn.tableIDs</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li><li><a href="#Input-Parameter-rde.signature">rde.signature</a></li></ol></section><section><a name="Test-Suite-StandardIDN"></a><h3>4.6. Internationalized Domain Names (IDN)</h3><h4>Description</h4><div class="markdown-content"><p>The RDE test suite validates the IDN table(s) for a TLD or RSP.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-StandardSRSGateway"></a><h3>4.7. SRS Gateway</h3><h4>Description</h4><div class="markdown-content"><p>The SRS Gateway test suite validates the conformance of the Gateway
registry infrastructure of a TLD or RSP, and the synchronisation between
primary and gateway systems.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-DNSSECOperations"></a><h3>4.8. DNSSEC RSP - Operations</h3><h4>Description</h4><div class="markdown-content"><p>This test suite verifies the ability of an RSP to carry out standard
DNSSEC operational procedures while maintaining a chain of trust to the
parent zone.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-dnssecRSP01-ZSKRollover">dnssecRSP01-ZSKRollover - ZSK rollover</a></li><li><a href="#Test-Case-dnssecRSP02-KSKRollover">dnssecRSP02-KSKRollover - KSK rollover</a></li><li><a href="#Test-Case-dnssecRSP03-AlgorithmRollover">dnssecRSP03-AlgorithmRollover - algorithm rollover</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol></ol></section><section><a name="Test-Suite-LaunchExtensionAndTMCH"></a><h3>4.9. Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</h3><h4>Description</h4><div class="markdown-content"><p>This test suite verifies an RSP’s support for the Launch Extension
(RFC 8334) and the Trademark Clearinghouse.</p>
</div><h4>Test cases</h4><p>This suite uses the following test cases:</p>
<ol><li><a href="#Test-Case-dns-address01">dns-address01 - Verify that IPv4 addresse are not in private networks</a></li><li><a href="#Test-Case-dns-address02">dns-address02 - Verify reverse DNS entries exist for nameserver IP addresses</a></li><li><a href="#Test-Case-dns-address03">dns-address03 - Verify that reverse DNS entries match nameserver names</a></li><li><a href="#Test-Case-dns-connectivity01">dns-connectivity01 - Verify nameserver UDP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity02">dns-connectivity02 - Verify nameserver TCP port 53 reachability</a></li><li><a href="#Test-Case-dns-connectivity03">dns-connectivity03 - Verify that all nameservers do not belong to the same AS</a></li><li><a href="#Test-Case-dns-connectivity04">dns-connectivity04 - Verify that name servers are not announced in the same IP prefix</a></li><li><a href="#Test-Case-dns-consistency01">dns-consistency01 - Query all nameservers for SOA, and verify that they all have the same SOA serial number</a></li><li><a href="#Test-Case-dns-consistency02">dns-consistency02 - Query all nameservers for SOA, and verify that they all have the same SOA rname</a></li><li><a href="#Test-Case-dns-consistency03">dns-consistency03 - Query all nameservers for SOA, and verify that they all have the same time parameters (REFRESH/RETRY/EXPIRE/MINIMUM)</a></li><li><a href="#Test-Case-dns-consistency04">dns-consistency04 - Query all nameservers for the NS set, and verify that they have all the same content</a></li><li><a href="#Test-Case-dns-consistency05">dns-consistency05 - Verify that the glue records are consistent with authoritative data</a></li><li><a href="#Test-Case-dns-consistency06">dns-consistency06 - Query all nameservers for SOA, and verify that they all have the same SOA mname</a></li><li><a href="#Test-Case-dns-delegation01">dns-delegation01 - Verify that there are more than two nameservers</a></li><li><a href="#Test-Case-dns-delegation02">dns-delegation02 - Verify that name servers have distinct IP addresses</a></li><li><a href="#Test-Case-dns-delegation03">dns-delegation03 - Verify that there is no truncation on referrals</a></li><li><a href="#Test-Case-dns-delegation04">dns-delegation04 - Verify that nameservers are authoritative</a></li><li><a href="#Test-Case-dns-delegation05">dns-delegation05 - Verify that NS RRs do not point to CNAMEs</a></li><li><a href="#Test-Case-dns-delegation06">dns-delegation06 - Verify existence of SOA</a></li><li><a href="#Test-Case-dns-nameserver01">dns-nameserver01 - Verify that nameserver does not provide recursive service</a></li><li><a href="#Test-Case-dns-nameserver02">dns-nameserver02 - Verify EDNS0 support</a></li><li><a href="#Test-Case-dns-nameserver04">dns-nameserver04 - Verify that replies from nameserver comes from the expected IP address</a></li><li><a href="#Test-Case-dns-nameserver05">dns-nameserver05 - Verify behaviour against AAAA queries</a></li><li><a href="#Test-Case-dns-nameserver06">dns-nameserver06 - Verify that each nameserver can be resolved to an IP address</a></li><li><a href="#Test-Case-dns-nameserver07">dns-nameserver07 - Check whether authoritative name servers return an upward referral</a></li><li><a href="#Test-Case-dns-nameserver08">dns-nameserver08 - Check whether authoritative name servers responses match the case of every letter in QNAME</a></li><li><a href="#Test-Case-dns-nameserver09">dns-nameserver09 - Check whether authoritative name servers return same results for equivalent names with different cases in the request</a></li><li><a href="#Test-Case-dns-nameserver10">dns-nameserver10 - Check whether authoritative name servers respond correctly to queries with undefined EDNS version</a></li><li><a href="#Test-Case-dns-nameserver11">dns-nameserver11 - Check whether authoritative name servers responses doe not include unknown EDNS OPTION-CODE used in query</a></li><li><a href="#Test-Case-dns-nameserver12">dns-nameserver12 - Check whether authoritative name servers responses has &#34;Z&#34; bits cleared even if they are set in the query</a></li><li><a href="#Test-Case-dns-nameserver13">dns-nameserver13 - Verify that if the response to a query with an OPT record is truncated, then the response will contain an OPT record</a></li><li><a href="#Test-Case-dns-syntax05">dns-syntax05 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given has a conform usage of at sign (@)</a></li><li><a href="#Test-Case-dns-syntax06">dns-syntax06 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given is RFC822 compliant</a></li><li><a href="#Test-Case-dns-syntax07">dns-syntax07 - Verify that SOA mname of zone given conforms to syntax rules</a></li><li><a href="#Test-Case-dns-zone01">dns-zone01 - Check that master nameserver in SOA is fully qualified</a></li><li><a href="#Test-Case-dns-zone02">dns-zone02 - Verify SOA &#39;refresh&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone03">dns-zone03 - Verify SOA &#39;retry&#39; value is lower than SOA &#39;refresh&#39; value</a></li><li><a href="#Test-Case-dns-zone04">dns-zone04 - Verify SOA &#39;retry&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone05">dns-zone05 - Verify SOA &#39;expire&#39; minimum value</a></li><li><a href="#Test-Case-dns-zone06">dns-zone06 - Verify SOA &#39;minimum&#39; (default TTL) value</a></li><li><a href="#Test-Case-dns-zone07">dns-zone07 - Verify that SOA master is not an alias (CNAME)</a></li><li><a href="#Test-Case-dns-zone10">dns-zone10 - Verify that the zone of the domain to be tested return exactly one SOA record</a></li><li><a href="#Test-Case-dnssec-01">dnssec-01 - Verifies that all DS records have digest types registered with IANA</a></li><li><a href="#Test-Case-dnssec-02">dnssec-02 - Verifies that all DS records have a matching DNSKEY</a></li><li><a href="#Test-Case-dnssec-03">dnssec-03 - Check iteration counts for NSEC3</a></li><li><a href="#Test-Case-dnssec-04">dnssec-04 - Checks the durations of the signatures for the DNSKEY and SOA RRsets</a></li><li><a href="#Test-Case-dnssec-05">dnssec-05 - Check DNSKEY algorithms</a></li><li><a href="#Test-Case-dnssec-06">dnssec-06 - Check for DNSSEC extra processing at child nameservers</a></li><li><a href="#Test-Case-dnssec-08">dnssec-08 - Check that the DNSKEY RRset is signed</a></li><li><a href="#Test-Case-dnssec-09">dnssec-09 - Check that the SOA RRset is signed</a></li><li><a href="#Test-Case-dnssec-10">dnssec-10 - Check for the presence of either NSEC or NSEC3, with proper coverage and signatures</a></li><li><a href="#Test-Case-dnssec-13">dnssec-13 - Check that all DNSKEY algorithms are used to sign the zone</a></li><li><a href="#Test-Case-dnssec-14">dnssec-14 - Check for valid RSA DNSKEY key size</a></li><li><a href="#Test-Case-dnssec-15">dnssec-15 - Check existence of CDS and CDNSKEY</a></li><li><a href="#Test-Case-dnssec-16">dnssec-16 - Validate CDS</a></li><li><a href="#Test-Case-dnssec-17">dnssec-17 - Validate CDNSKEY</a></li><li><a href="#Test-Case-dnssecRSP01-ZSKRollover">dnssecRSP01-ZSKRollover - ZSK rollover</a></li><li><a href="#Test-Case-dnssecRSP02-KSKRollover">dnssecRSP02-KSKRollover - KSK rollover</a></li><li><a href="#Test-Case-dnssecRSP03-AlgorithmRollover">dnssecRSP03-AlgorithmRollover - algorithm rollover</a></li><li><a href="#Test-Case-epp-01">epp-01 - EPP server must have at least one A record</a></li><li><a href="#Test-Case-epp-02">epp-02 - EPP server must have at least one AAAA record</a></li><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li><li><a href="#Test-Case-epp-04">epp-04 - All service ports support TLSv1.2 or higher</a></li><li><a href="#Test-Case-epp-05">epp-05 - All service ports must not support TLSv1.1 or earlier</a></li><li><a href="#Test-Case-epp-06">epp-06 - All service ports must offer a valid certificate issued by a trusted CA</a></li><li><a href="#Test-Case-epp-07">epp-07 - TLS certificate must be valid</a></li><li><a href="#Test-Case-epp-08">epp-08 - TLS certificate must be valid for the server name</a></li><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-10">epp-10 - All server responses must validate against the XML schema</a></li><li><a href="#Test-Case-epp-11">epp-11 - &lt;svID&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-12">epp-12 - &lt;svDate&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-13">epp-13 - &lt;version&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-14">epp-14 - &lt;lang&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li><li><a href="#Test-Case-epp-18">epp-18 - &lt;hello&gt; command must return a &lt;greeting&gt;</a></li><li><a href="#Test-Case-epp-19">epp-19 - domain &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-20">epp-20 - domain sunrise &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-21">epp-21 - domain trademark claims &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-22">epp-22 - host &lt;check&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-23">epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-24">epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-25">epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-26">epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-27">epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-28">epp-28 - host &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-29">epp-29 - host &lt;info&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-30">epp-30 - host &lt;update&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-31">epp-31 - host &lt;delete&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-32">epp-32 - domain &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-33">epp-33 - domain &lt;info&gt; command test</a></li><li><a href="#Test-Case-epp-34">epp-34 - domain &lt;update&gt; command test</a></li><li><a href="#Test-Case-epp-35">epp-35 - domain &lt;renew&gt; command test</a></li><li><a href="#Test-Case-epp-36">epp-36 - domain &lt;transfer&gt; command test</a></li><li><a href="#Test-Case-epp-37">epp-37 - domain &lt;delete&gt; command test</a></li><li><a href="#Test-Case-epp-38">epp-38 - host rename test (if applicable)</a></li><li><a href="#Test-Case-epp-39">epp-39 - domain restore test (if applicable)</a></li><li><a href="#Test-Case-eppLaunch-01">eppLaunch-01 - launch application sunrise &lt;info&gt; command test</a></li><li><a href="#Test-Case-eppLaunch-02">eppLaunch-02 - domain/launch application sunrise &lt;create&gt; command test
</a></li><li><a href="#Test-Case-eppLaunch-03">eppLaunch-03 - domain trademark claims &lt;create&gt; command test</a></li><li><a href="#Test-Case-eppLaunch-04">eppLaunch-04 - LORDN submission test</a></li><li><a href="#Test-Case-rdap-domainCaseFoldingValidation">rdap-domainCaseFoldingValidation - Domain label case folding validation</a></li><li><a href="#Test-Case-rdap-domainNameValidation">rdap-domainNameValidation - Domain Name validation</a></li><li><a href="#Test-Case-rdap-ipv4Validation">rdap-ipv4Validation - IPv4 address validation</a></li><li><a href="#Test-Case-rdap-ipv6Validation">rdap-ipv6Validation - IPv6 address validation</a></li><li><a href="#Test-Case-rdap-nameserver_status">rdap-nameserver_status - validation of nameserver status codes</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_2_2_Validation">rdap-rdapResponseProfile_1_2_2_Validation - no JavaScript</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_3_Validation">rdap-rdapResponseProfile_1_3_Validation - presence of &#34;icann_rdap_response_profile_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_4_Validation">rdap-rdapResponseProfile_1_4_Validation - empty country name parameter of entity jCards</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_1_6_contactReprestentation">rdap-rdapResponseProfile_1_6_contactReprestentation - validate use of jCard and presence of alternative format(s)</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_10_Validation">rdap-rdapResponseProfile_2_10_Validation - presence of secureDNS property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_11_Validation">rdap-rdapResponseProfile_2_11_Validation - presence of &#34;RDDS Inaccuracy Complaint Form&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_1_Validation">rdap-rdapResponseProfile_2_1_Validation - presence of ldhName/unicodeName property for A-label/U-label domain lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_2_Validation">rdap-rdapResponseProfile_2_2_Validation - format of handle property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_1_Validation">rdap-rdapResponseProfile_2_3_1_1_Validation - presence of &#34;registration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_2_Validation">rdap-rdapResponseProfile_2_3_1_2_Validation - presence of &#34;expiration&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation">rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation - presence of &#34;last update of RDAP database&#34; event</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_1_Validation">rdap-rdapResponseProfile_2_4_1_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation">rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation - validation of the publicIds and handle properties of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_5_Validation">rdap-rdapResponseProfile_2_4_5_Validation - abuse role for the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_4_6_registrarAboutLink">rdap-rdapResponseProfile_2_4_6_registrarAboutLink - presence of &#34;about&#34; link in registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_1_Validation">rdap-rdapResponseProfile_2_6_1_Validation - at least one status code</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_6_3_Validation">rdap-rdapResponseProfile_2_6_3_Validation - presence of &#34;Status Codes&#34; notice</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_7_5_3_Validation">rdap-rdapResponseProfile_2_7_5_3_Validation - proper redaction of domain entities</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation">rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation - presence and validity of ldhName, handle, status properties in domain nameservers</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_1_Validation">rdap-rdapResponseProfile_4_1_Validation - presence of ldhName/unicodeName property for A-label/U-label nameserver lookup responses, respectively</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_4_3_Validation">rdap-rdapResponseProfile_4_3_Validation - presence and validity of the registrar entity</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_notices_included_Validation">rdap-rdapResponseProfile_notices_included_Validation - presence of &#34;notices&#34; property</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc3915_Validation">rdap-rdapResponseProfile_rfc3915_Validation - RGP status code validation</a></li><li><a href="#Test-Case-rdap-rdapResponseProfile_rfc5731_Validation">rdap-rdapResponseProfile_rfc5731_Validation - domain status code validation</a></li><li><a href="#Test-Case-rdap-rdaptigSection_1_1_3_redactionExtension">rdap-rdaptigSection_1_1_3_redactionExtension - use of Redacted Fields extension, validation of redacted paths</a></li><li><a href="#Test-Case-rdap-rdaptigSection_3_3_3_termsOfService">rdap-rdaptigSection_3_3_3_termsOfService - presence of terms-of-service link</a></li><li><a href="#Test-Case-rdap-stdRdapAsEventActorValidation">rdap-stdRdapAsEventActorValidation - asEventActor Validation</a></li><li><a href="#Test-Case-rdap-stdRdapConformanceValidation">rdap-stdRdapConformanceValidation - RDAP Conformance validation</a></li><li><a href="#Test-Case-rdap-stdRdapDomainLookupValidation">rdap-stdRdapDomainLookupValidation - Domain Lookup Validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntitiesValidation">rdap-stdRdapEntitiesValidation - Entities validation</a></li><li><a href="#Test-Case-rdap-stdRdapEntityLookupValidation">rdap-stdRdapEntityLookupValidation - Entity lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapErrorResponseBodyValidation">rdap-stdRdapErrorResponseBodyValidation - Error Response Body</a></li><li><a href="#Test-Case-rdap-stdRdapEventsValidation">rdap-stdRdapEventsValidation - Events Validation</a></li><li><a href="#Test-Case-rdap-stdRdapHelpValidation">rdap-stdRdapHelpValidation - Help validation</a></li><li><a href="#Test-Case-rdap-stdRdapIpAddressesValidation">rdap-stdRdapIpAddressesValidation - IP Addresses Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLanguageIdentifierValidation">rdap-stdRdapLanguageIdentifierValidation - Language Identifier Validation</a></li><li><a href="#Test-Case-rdap-stdRdapLdhNameValidation">rdap-stdRdapLdhNameValidation - LDH name</a></li><li><a href="#Test-Case-rdap-stdRdapLinksValidation">rdap-stdRdapLinksValidation - Links validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserverLookupValidation">rdap-stdRdapNameserverLookupValidation - Nameserver lookup validation</a></li><li><a href="#Test-Case-rdap-stdRdapNameserversSearchValidation">rdap-stdRdapNameserversSearchValidation - Nameservers search validation</a></li><li><a href="#Test-Case-rdap-stdRdapNoticesRemarksValidation">rdap-stdRdapNoticesRemarksValidation - Notices and Remarks Validation</a></li><li><a href="#Test-Case-rdap-stdRdapPort43WhoisServerValidation">rdap-stdRdapPort43WhoisServerValidation - Port 43 WHOIS Server</a></li><li><a href="#Test-Case-rdap-stdRdapPublicIdsValidation">rdap-stdRdapPublicIdsValidation - Public IDs validation</a></li><li><a href="#Test-Case-rdap-stdRdapRolesValidation">rdap-stdRdapRolesValidation - Roles validation</a></li><li><a href="#Test-Case-rdap-stdRdapSecureDnsValidation">rdap-stdRdapSecureDnsValidation - Secure DNS validation</a></li><li><a href="#Test-Case-rdap-stdRdapStatusValidation">rdap-stdRdapStatusValidation - Status validation</a></li><li><a href="#Test-Case-rdap-stdRdapUnicodeNameValidation">rdap-stdRdapUnicodeNameValidation - Unicode name</a></li><li><a href="#Test-Case-rdap-stdRdapVariantsValidation">rdap-stdRdapVariantsValidation - Variants validation</a></li><li><a href="#Test-Case-rdap-tigSection_1_11_1_Validation">rdap-tigSection_1_11_1_Validation - bootstrap registration</a></li><li><a href="#Test-Case-rdap-tigSection_1_13_Validation">rdap-tigSection_1_13_Validation - Access-Control-Allow-Origin header</a></li><li><a href="#Test-Case-rdap-tigSection_1_14_Validation">rdap-tigSection_1_14_Validation - presence of &#34;icann_rdap_technical_implementation_guide_0&#34; in &#34;rdapConformance&#34;</a></li><li><a href="#Test-Case-rdap-tigSection_1_2_Validation">rdap-tigSection_1_2_Validation - use of HTTPS</a></li><li><a href="#Test-Case-rdap-tigSection_1_3_Validation">rdap-tigSection_1_3_Validation - use of obsolete SSL/TLS versions</a></li><li><a href="#Test-Case-rdap-tigSection_1_6_Validation">rdap-tigSection_1_6_Validation - support for HEAD</a></li><li><a href="#Test-Case-rdap-tigSection_1_8_Validation">rdap-tigSection_1_8_Validation - IPv4/IPv6 resolvability</a></li><li><a href="#Test-Case-rdap-tigSection_3_2_Validation">rdap-tigSection_3_2_Validation - rel=&#34;related&#34; link in topmost object</a></li><li><a href="#Test-Case-rdap-tigSection_3_3_and_3_4_Validation">rdap-tigSection_3_3_and_3_4_Validation - presence of link object(s) in notice(s)</a></li><li><a href="#Test-Case-rdap-tigSection_4_1_Validation">rdap-tigSection_4_1_Validation - structured addresses in entity jCards</a></li><li><a href="#Test-Case-rdap-tigSection_6_1_Validation">rdap-tigSection_6_1_Validation - publicIds property of registrar entity</a></li><li><a href="#Test-Case-rdap-tigSection_7_1_and_7_2_Validation">rdap-tigSection_7_1_and_7_2_Validation - voice/fax type for tel nodes in entity jCards</a></li><li><a href="#Test-Case-rdap-webUriValidation">rdap-webUriValidation - Web URI validation</a></li><li><a href="#Test-Case-rde-01">rde-01 - validate filename format</a></li><li><a href="#Test-Case-rde-02">rde-02 - validate signature(s)</a></li><li><a href="#Test-Case-rde-03">rde-03 - decrypt deposit file(s)</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-06">rde-06 - validate object counts</a></li><li><a href="#Test-Case-rde-07">rde-07 - validate domain objects</a></li><li><a href="#Test-Case-rde-08">rde-08 - validate host objects (if applicable)</a></li><li><a href="#Test-Case-rde-09">rde-09 - validate contact objects (if applicable)</a></li><li><a href="#Test-Case-rde-10">rde-10 - validate registrar objects</a></li><li><a href="#Test-Case-rde-11">rde-11 - validate IDN table objects</a></li><li><a href="#Test-Case-rde-12">rde-12 - validate NNDN objects</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li><li><a href="#Test-Case-rde-14">rde-14 - validate policy object</a></li></ol><h4>Input parameters</h4><p>The test cases used by this suite require the following input parameters:</p>
<ol><li><a href="#Input-Parameter-epp.clid">epp.clid</a></li><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-epp.port">epp.port</a></li><li><a href="#Input-Parameter-epp.pwd">epp.pwd</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-general.sunriseModel">general.sunriseModel</a></li><li><a href="#Input-Parameter-idn.tableIDs">idn.tableIDs</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li><li><a href="#Input-Parameter-rde.signature">rde.signature</a></li></ol></section><a name="test-cases"></a><h2>5. Test Cases</h2><section><a name="Test-Case-dns-address01"></a><h3>5.1. dns-address01 - Verify that IPv4 addresse are not in private networks</h3><h4>Description</h4><div class="markdown-content"><p>In order for the domain and its resources to be accessible,
authoritative name servers must have addresses in the routable public
addressing space.</p>
<p>IANA is responsible for global coordination of the IP addressing
system. Aside its address allocation activities, it maintains reserved
address ranges for special uses. These ranges can be categorized into
three types : <a
href="https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xml">Special
purpose IPv4 addresses</a>, <a
href="https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xml">Special
purpose IPv6 addresses</a> and <a
href="https://www.iana.org/assignments/multicast-addresses/multicast-addresses.xml">Multicast
reserved addresses</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li><p>Obtain the IP addresses of each name server of the domain from
the parent using <a href="../Methods.md">Method4</a> and child using <a
href="../Methods.md">Method5</a></p></li>
<li><p>If any IP address (IPv4 or IPv6) falls within any of the blocks
in the below mentioned IANA links, the test case fails:</p>
<ul>
<li><a
href="https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml"
class="uri">https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml</a></li>
<li><a
href="https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml"
class="uri">https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml</a></li>
</ul></li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If one name server has one of its addresses matches a forbidden
address block, the test fails. If all the name server addresses are
outside these forbidden blocks, the test case succeeds.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>The registries listed in bullet 2 above must be fetched prior to
testing</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-address02"></a><h3>5.2. dns-address02 - Verify reverse DNS entries exist for nameserver IP addresses</h3><h4>Description</h4><div class="markdown-content"><p>Some anti-spam techniques use reverse DNS lookup to allow incoming
traffic. In order to prevent name servers to be blocked or blacklisted,
DNS administrators should publish PTR records associated to name server
addresses.</p>
<p>[technical reference to be found]</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li><p>Obtain the glue address records of the domain checked using <a
href="../Methods.md">Method4</a></p></li>
<li><p>Obtain the IP addresses of each name server of the domain checked
using <a href="../Methods.md">Method5</a></p></li>
<li><p>For each IP address, a recursive PTR query must be
performed.</p></li>
<li><p>If any answer of the queries performed in step 3 contains an
RCODE other than NOERROR or if the answer does not include a PTR record,
this test case fails.</p></li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the test case succeeds, its result is a list of addresses with
corresponding hostnames which are the result of the PTR queries
performed. The result could be represented as a hash table where the
keys are the IP addresses and the values their corresponding
hostnames.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-dns-address03">dns-address03 - Verify that reverse DNS entries match nameserver names</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-address03"></a><h3>5.3. dns-address03 - Verify that reverse DNS entries match nameserver names</h3><h4>Description</h4><div class="markdown-content"><p>Some anti-spam techniques use reverse DNS lookup to allow incoming
traffic. In order to prevent name servers to be blocked or blacklisted,
DNS administrators should publish PTR records associated with the name
server addresses.</p>
<p>Moreover, as mentioned in paragraph 2.1 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a> when a
PTR record exists, it must match the host name.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li><p>Obtain the IP addresses of each name server of the domain from
the child using <a href="../Methods.md">Method5</a>. These IP addresses
can be associated to the name servers through a hash table where each
address is a key and the name server it’s unique value. Let’s call this
hash table HASH1.</p></li>
<li><p>Obtain the reverse DNS entries associated to name servers names
as described in test case <a href="address02.md">ADDRESS02</a>. Let’s
call its outcome HASH2 which consists of IP adresses as keys and
hostnames as values. As multiple PTR records are allowed, an IP address
can have several corresponding hostnames.</p></li>
<li><p>Compare HASH2 to HASH1.</p>
<p>Parse the address list of HASH1.</p>
<p>For an address (a) of HASH1, take the corresponding hostname (h) in
HASH1. If this hostname (h) is present in the hostnames list associated
to this address (a) in HASH2, then the test succeeds for address
(a).</p>
<p>If the hostname (h) does not match any hostnames associated to
address (a) in HASH2, then the test fails for address (a).</p>
<p>If the test fails for one IP address, the whole test case fails. ###
Outcome(s)</p></li>
</ol>
<p>Multiple addresses and multiple PTR records are allowed. The test
succeeds if every name server address has one or more PTR records and
one of these records matches the server name. If one address doesn’t
match, the whole test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-dns-address02">dns-address02 - Verify reverse DNS entries exist for nameserver IP addresses</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-connectivity01"></a><h3>5.4. dns-connectivity01 - Verify nameserver UDP port 53 reachability</h3><h4>Description</h4><div class="markdown-content"><p>UDP is the fundamental protocol to reach a general purpose name
server hosting a zone, “DNS servers MUST be able to service UDP […]”
([RFC 1123], section 6.1.3.2, page 75), also restated in [RFC 7766][RFC
7766#5], section 5.</p>
<p>This Test Case will verify if the name servers of <em>Child Zone</em>
are reachable over UDP. The name servers tested are both those in the
delegation of <em>Child Zone</em> and those in the NS records in the
<em>Child Zone</em> itself.</p>
<p>Most Zonemaster Test Cases will query the name servers in the
delegation or the name servers appointed by the NS records in the zone
for the NS or SOA record, or both. It is crucial that problems are
reported, but instead of letting several Test Cases report the same
problems found, most Test Cases assume that this test case is run. Only
this Test Case will report problems found in the following areas over
UDP:</p>
<ul>
<li>Name Server not responding to a query without EDNS.</li>
<li>Name Server not including SOA record of <em>Child Zone</em> in the
answer section in the response on a SOA query for <em>Child
Zone</em>.</li>
<li>Name Server not including NS record of <em>Child Zone</em> in the
answer section in the response on an NS query for <em>Child
Zone</em>.</li>
<li>Name Server not setting the AA flag in a response with SOA or NS in
answer section.</li>
<li>Name Server responding with unexpected [RCODE Name] (any except
“NoError”) on query for SOA or NS for <em>Child Zone</em>.</li>
</ul>
<p>In addition, this test case will output a message if transport over
IPv4 or IPv6 has been disabled.</p>
<h4 id="scope">Scope</h4>
<p>The only UDP port defined for DNS is port 53 ([RFC 1035][RFC
1035#4.2.1], section 4.2.1), and that is the only port used by this and
other Test Cases for DNS queries to the name servers. ## Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested. ## Summary</li>
</ul>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 4%" />
<col style="width: 7%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Message ID for message tag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CN01_IPV4_DISABLED</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_list</td>
<td style="text-align: left;">IPv4 is disabled. No DNS queries are sent
to these name servers: “{ns_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_IPV6_DISABLED</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_list</td>
<td style="text-align: left;">IPv6 is disabled. No DNS queries are sent
to these name servers: “{ns_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_MISSING_NS_RECORD_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} reponds to a NS query with
no NS records in the answer section over UDP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_MISSING_SOA_RECORD_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} reponds to a SOA query
with no SOA records in the answer section over UDP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_NO_RESPONSE_NS_QUERY_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to NS
queries over UDP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_NO_RESPONSE_SOA_QUERY_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to SOA
queries over UDP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_NO_RESPONSE_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to any
queries over UDP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_NS_RECORD_NOT_AA_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not give an
authoritative response on an NS query over UDP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_SOA_RECORD_NOT_AA_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not give an
authoritative response on an SOA query over UDP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_UNEXPECTED_RCODE_NS_QUERY_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, rcode</td>
<td style="text-align: left;">Nameserver {ns} responds with an
unexpected RCODE ({rcode}) on an NS query over UDP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_UNEXPECTED_RCODE_SOA_QUERY_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, rcode</td>
<td style="text-align: left;">Nameserver {ns} responds with an
unexpected RCODE ({rcode}) on an SOA query over UDP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN01_WRONG_NS_RECORD_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, domain_found, domain_expected</td>
<td style="text-align: left;">Nameserver {ns} responds with a wrong
owner name ({domain_found} instead of {domain_expected}) on NS queries
over UDP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN01_WRONG_SOA_RECORD_UDP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, domain_found, domain_expected</td>
<td style="text-align: left;">Nameserver {ns} responds with a wrong
owner name ({domain_found} instead of {domain_expected}) on SOA queries
over UDP.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<p>In this section and unless otherwise specified below, the term “[DNS
Query]” follows the specification for DNS queries as specified in [DNS
Query and Response Defaults]. The handling of the DNS responses on the
DNS queries follow, unless otherwise specified below, what is specified
for [DNS Response] in the same specification.</p>
<ol type="1">
<li><p>Create [DNS Queries][DNS Query]:</p>
<ol type="1">
<li>Query type SOA and query name <em>Child Zone</em> (“SOA
Query”).</li>
<li>Query type NS and query name <em>Child Zone</em> (“NS Query”).</li>
</ol></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>If IPv4 is disabled then do:</p>
<ol type="1">
<li>Extract all name servers with IPv4 address from <em>Name Server
IP</em>.</li>
<li>If the set of IPv4 name servers is non-empty then output
<em>[CN01_IPV4_DISABLED]</em> with the set of IPv4 name servers (names
and IP addresses).</li>
</ol></li>
<li><p>If IPv6 is disabled then do:</p>
<ol type="1">
<li>Extract all name servers with IPv6 address from <em>Name Server
IP</em>.</li>
<li>If the set of IPv6 name servers is non-empty then output
<em>[CN01_IPV6_DISABLED]</em> with the set of IPv6 name servers (names
and IP addresses).</li>
</ol></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send <em>SOA Query</em> and <em>NS Query</em> to the name server and
collect the [DNS Responses][DNS Response].</li>
<li>If there is no DNS response on neither query, then:
<ol type="1">
<li>Output <em>[CN01_NO_RESPONSE_UDP]</em> with name and IP address of
the name server.</li>
<li>Go to next name server.</li>
</ol></li>
<li>Else:
<ol type="1">
<li>Process the response on <em>SOA Query</em>:
<ol type="1">
<li>If there is no [DNS response], then output
<em>[CN01_NO_RESPONSE_SOA_QUERY_UDP]</em> with name and IP address of
the name server.</li>
<li>Else, if [RCODE Name] is not “NoError” then output
<em>[CN01_UNEXPECTED_RCODE_SOA_QUERY_UDP]</em> with [RCODE Name] and
name and IP address of the name server.</li>
<li>Else, if there is no SOA record in the answer section, then output
<em>[CN01_MISSING_SOA_RECORD_UDP]</em> with name and IP address of the
name server.</li>
<li>Else, if the SOA record has owner name other than <em>Child
Zone</em> then output <em>[CN01_WRONG_SOA_RECORD_UDP]</em> with name and
IP address of the name server, the SOA record owner name and <em>Child
Zone</em>.</li>
<li>Else, if AA flag is unset, then output
<em>[CN01_SOA_RECORD_NOT_AA_UDP]</em> with name and IP address of the
name server.</li>
</ol></li>
<li>Process the response on <em>NS Query</em>:
<ol type="1">
<li>If there is no [DNS Response], then output
<em>[CN01_NO_RESPONSE_NS_QUERY_UDP]</em> with name and IP address of the
name server.</li>
<li>Else, if [RCODE Name] is not “NoError” then output
<em>[CN01_UNEXPECTED_RCODE_NS_QUERY_UDP]</em> with [RCODE Name] and name
and IP address of the name server.</li>
<li>Else, if there is no NS record in the answer section, then output
<em>[CN01_MISSING_NS_RECORD_UDP]</em> with name and IP address of the
name server.</li>
<li>Else, if the NS record has owner name other than <em>Child Zone</em>
then output <em>[CN01_WRONG_NS_RECORD_UDP]</em> with name and IP address
of the name server, the NS record owner name and <em>Child
Zone</em>.</li>
<li>Else, if AA flag is unset, then output
<em>[CN01_NS_RECORD_NOT_AA_UDP]</em> with name and IP address of the
name server. ## Outcome(s)</li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, skip sending queries
over that transport protocol.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-connectivity02"></a><h3>5.5. dns-connectivity02 - Verify nameserver TCP port 53 reachability</h3><h4>Description</h4><div class="markdown-content"><p>TCP is a protocol to reach a general purpose name server hosting a
zone, “All general-purpose DNS implementations MUST support […] TCP
transport” ([RFC 7766][RFC 7766#5], section 5).</p>
<p>This Test Case will verify if the name servers of <em>Child Zone</em>
are reachable over TCP. The name servers tested are both those in the
delegation of <em>Child Zone</em> and those in the NS records in the
<em>Child Zone</em> itself.</p>
<p>This Test Case will mimic the tests done by [Connectivity01], but
over TCP instead:</p>
<ul>
<li>Name Server responding to a query.</li>
<li>Name Server including SOA record of <em>Child Zone</em> in the
answer section in the response on a SOA query for <em>Child
Zone</em>.</li>
<li>Name Server including NS record of <em>Child Zone</em> in the answer
section in the response on an NS query for <em>Child Zone</em>.</li>
<li>Name Server setting the AA flag in a response with SOA or NS in
answer section.</li>
<li>Name Server responding with expected [RCODE Name] (“NoError”) on
query for SOA or NS for <em>Child Zone</em>. ## Scope</li>
</ul>
<p>The only TCP port defined for DNS is port 53 ([RFC 1035][RFC
1035#4.2.1], section 4.2.1), and that is the only port used by this and
other Test Cases for DNS queries to the name servers.</p>
<p>UDP connectivity is tested by Test Case [Connectivity01]. ##
Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested. ## Summary</li>
</ul>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 4%" />
<col style="width: 7%" />
<col style="width: 61%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Message ID for message tag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CN02_MISSING_NS_RECORD_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} reponds to a NS query with
no NS records in the answer section over TCP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN02_MISSING_SOA_RECORD_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} reponds to a SOA query
with no SOA records in the answer section over TCP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN02_NO_RESPONSE_NS_QUERY_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to NS
queries over TCP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN02_NO_RESPONSE_SOA_QUERY_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to SOA
queries over TCP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN02_NO_RESPONSE_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not respond to any
queries over TCP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN02_NS_RECORD_NOT_AA_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not give an
authoritative response on an NS query over TCP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN02_SOA_RECORD_NOT_AA_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">Nameserver {ns} does not give an
authoritative response on an SOA query over TCP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN02_UNEXPECTED_RCODE_NS_QUERY_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, rcode</td>
<td style="text-align: left;">Nameserver {ns} responds with an
unexpected RCODE ({rcode}) on an NS query over TCP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN02_UNEXPECTED_RCODE_SOA_QUERY_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, rcode</td>
<td style="text-align: left;">Nameserver {ns} responds with an
unexpected RCODE ({rcode}) on an SOA query over TCP.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN02_WRONG_NS_RECORD_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, , domain_found, domain_expected</td>
<td style="text-align: left;">Nameserver {ns} responds with a wrong
owner name ({domain_found} instead of {domain_expected}) on NS queries
over TCP.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN02_WRONG_SOA_RECORD_TCP</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, , domain_found, domain_expected</td>
<td style="text-align: left;">Nameserver {ns} responds with a wrong
owner name ({domain_found} instead of {domain_expected}) on SOA queries
over TCP.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<p>In this section and unless otherwise specified below, the term “[DNS
Query]” follows the specification for DNS queries as specified in [DNS
Query and Response Defaults]. The handling of the DNS responses on the
DNS queries follow, unless otherwise specified below, what is specified
for [DNS Response] in the same specification.</p>
<ol type="1">
<li><p>Create [DNS Queries][DNS Query]:</p>
<ol type="1">
<li>Query type SOA and query name <em>Child Zone</em> over TCP (“SOA
Query TCP”).</li>
<li>Query type NS and query name <em>Child Zone</em> over TCP (“NS Query
TCP”).</li>
</ol></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send <em>SOA Query TCP</em> and <em>NS Query TCP</em> to the name
server and collect the [DNS Responses][DNS Response].</li>
<li>If there is no DNS response on neither query, then:
<ol type="1">
<li>Output <em>[CN02_NO_RESPONSE_TCP]</em> with name and IP address of
the name server.</li>
<li>Go to next name server.</li>
</ol></li>
<li>Else:
<ol type="1">
<li>Process the response on <em>SOA Query TCP</em>:
<ol type="1">
<li>If there is no [DNS response], then output
<em>[CN02_NO_RESPONSE_SOA_QUERY_TCP]</em> with name and IP address of
the name server.</li>
<li>Else, if [RCODE Name] is not “NoError” then output
<em>[CN02_UNEXPECTED_RCODE_SOA_QUERY_TCP]</em> with [RCODE Name] and
name and IP address of the name server.</li>
<li>Else, if there is no SOA record in the answer section, then output
<em>[CN02_MISSING_SOA_RECORD_TCP]</em> with name and IP address of the
name server.</li>
<li>Else, if the SOA record has owner name other than <em>Child
Zone</em> then output <em>[CN02_WRONG_SOA_RECORD_TCP]</em> with name and
IP address of the name server, the SOA record owner name and <em>Child
Zone</em>.</li>
<li>Else, if AA flag is unset, then output
<em>[CN02_SOA_RECORD_NOT_AA_TCP]</em> with name and IP address of the
name server.</li>
</ol></li>
<li>Process the response on <em>NS Query TCP</em>:
<ol type="1">
<li>If there is no [DNS Response], then output
<em>[CN02_NO_RESPONSE_NS_QUERY_TCP]</em> with name and IP address of the
name server.</li>
<li>Else, if [RCODE Name] is not “NoError” then output
<em>[CN02_UNEXPECTED_RCODE_NS_QUERY_TCP]</em> with [RCODE Name] and name
and IP address of the name server.</li>
<li>Else, if there is no NS record in the answer section, then output
<em>[CN02_MISSING_NS_RECORD_TCP]</em> with name and IP address of the
name server.</li>
<li>Else, if the NS record has owner name other than <em>Child Zone</em>
then output <em>[CN02_WRONG_NS_RECORD_TCP]</em> with name and IP address
of the name server, the NS record owner name and <em>Child
Zone</em>.</li>
<li>Else, if AA flag is unset, then output
<em>[CN02_NS_RECORD_NOT_AA_TCP]</em> with name and IP address of the
name server. ## Outcome(s)</li>
</ol></li>
</ol></li>
</ol></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, skip sending queries
over that transport protocol.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-connectivity03"></a><h3>5.6. dns-connectivity03 - Verify that all nameservers do not belong to the same AS</h3><h4>Description</h4><div class="markdown-content"><p>The objective in this test is to verify that all IP addresses of the
domain’s authoritative name servers are announced from different ASNs
(autonomous system number). See [RFC 1930] and [Wikipedia] for an
explanation of AS (autonomous system).</p>
<p>This test is done separately on IPv4 and IPv6, and both must match
the criterion.</p>
<p>[RFC 2182][RFC 2182#3.1], section 3.1, clearly specifies that
distinct authoritative name servers for a child domain should be placed
in different topological and geographical locations. The objective is to
minimise the likelihood of a single failure disabling all of them. ##
Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
<li>“ASN Database” - The database of ASN data to be used. Possible
values are “RIPE” and “Cymru” (the default value).</li>
<li>“Cymru Base Name” - If the <em>ASN Database</em> is “Cymru”, the
default value is “asnlookup.zonemaster.net”.</li>
<li>“Ris Whois Server” - If the <em>ASN Database</em> is “RIPE”, the
default value is “riswhois.ripe.net”. ## Ordered description of steps to
be taken to execute the test case</li>
</ul>
<ol type="1">
<li><p>Obtain the total set of IP addresses of the name servers for the
<em>Child Zone</em> using [Method4] and [Method5] and split those IP
addresses into one set of IPv4 addresses (“NS IPv4”) and one set of IPv6
addresses (“NS IPv6”). (One of two sets may be empty.)</p></li>
<li><p>For each IP address in the set <em>NS IPv4</em> and <em>NS
IPv6</em>, respectively, determine the ASN set announcing the IP address
using either the <em>[Cymru database]</em> or the <em>[RIPE
database]</em> as described in separate sections below. Create two sets
of ASN data (“NS IPv4 ASN” and “NS IPv6 ASN”, respectively).</p></li>
<li><p>Analyze the <em>NS IPv4 ASN</em> set:</p>
<ol type="1">
<li>If <em>NS IPv4 ASN</em> is empty (no IPv4 address) do nothing.</li>
<li>Else, if all IPv4 addresses are announced from one and the same ASN,
output <em>[IPV4_ONE_ASN]</em>.</li>
<li>Else, if all IPv4 addresses are announced from the same set of
multiple ASNs, output <em>[IPV4_SAME_ASN]</em>.</li>
<li>Else, output <em>[IPV4_DIFFERENT_ASN]</em>.</li>
</ol></li>
<li><p>Analyze the <em>NS IPv6 ASN</em> set:</p>
<ol type="1">
<li>If <em>NS IPv6 ASN</em> is empty (no IPv6 address) do nothing.</li>
<li>Else, if all IPv6 addresses are announced from one and the same ASN,
output <em>[IPV6_ONE_ASN]</em>.</li>
<li>Else, if all IPv6 addresses are announced from the same set of
multiple ASNs, output <em>[IPV6_SAME_ASN]</em>.</li>
<li>Else, output <em>[IPV6_DIFFERENT_ASN]</em>.</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level ERROR or CRITICAL.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level WARNING, but no message with severity
level ERROR or CRITICAL.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">EMPTY_ASN_SET</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">ERROR_ASN_DATABASE</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPV4_ONE_ASN</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPV4_SAME_ASN</td>
<td style="text-align: left;">NOTICE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPV4_DIFFERENT_ASN</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPV6_ONE_ASN</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IPV6_SAME_ASN</td>
<td style="text-align: left;">NOTICE</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPV6_DIFFERENT_ASN</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>This test case is dependent on one of two possible services that can
provide ASN lookup, RIPE or Cymru. The service must be available over
the network. ### Cymru ASN lookup</p>
<p>The Cymru lookup method is described on the Team Cymru [IP to ASN
Mapping] using DNS lookup.</p>
<ol type="1">
<li>Prepend the <em>Cymru Base Name</em> with the label “origin” (IPv4)
or “origin6” (IPv6). Example of expanded basenames (“expanded base
name”):</li>
</ol>
<pre><code>origin.asnlookup.zonemaster.net
origin6.asnlookup.zonemaster.net</code></pre>
<ol start="2" type="1">
<li><p>Reverse the IP address with the same method as is used for
reverse lookup. For description see [RFC 1035][RFC 1035#3.5], section
3.5, for IPv4 and [RFC 3596][RFC 3596#2.5], section 2.5, for
IPv6.</p></li>
<li><p>Prepend the <em>expanded base name</em> with the reversed IP
address. For description see [IP to ASN Mapping].</p></li>
<li><p>Send a DNS query for the TXT record of the full name created in
step 3.</p></li>
<li><p>If either the DNS response has RCODE “NXDOMAIN” or the DNS
response has RCODE “NOERROR” but empty answer section, output
<em>[EMPTY_ASN_SET]</em> and end these steps for Cymru look-up of the
specific IP address.</p></li>
<li><p>If there is no response (timeout) or the DNS response does not
have the RCODE “NOERROR”, output <em>[ERROR_ASN_DATABASE]</em> and end
these steps for Cymru look-up of the specific IP address.</p></li>
<li><p>The expected response is a non-empty string in the TXT record or
records. See [IP to ASN Mapping] for examples.</p></li>
<li><p>Do the following:</p>
<ol type="1">
<li>Split the string or strings into fields.</li>
<li>If there are multiple strings (TXT records), ignore all strings
except for the string with the most specific subnet.</li>
<li>Extract the ASN or ASNs.</li>
<li>If it was not possible to extract the ASN or ASNs, output
<em>[ERROR_ASN_DATABASE]</em> and end these steps for Cymru look-up of
the specific IP address (the response was malformed).</li>
</ol></li>
<li><p>Create the ASN set, for the IP address, from the ASN or ASNs from
the steps above and use it for the further processing.</p></li>
</ol>
<h5 id="ripe-asn-lookup">RIPE ASN lookup</h5>
<p>The RIPE ASN lookup is described on the RIPE [RISwhois] page.</p>
<ol type="1">
<li><p>Construct a query string by prepending the IP adress with ” -F -M
“. Using”192.0.2.10” as an example, the query string will be the
following (the leading space is intentional)</p>
<pre><code>&quot; -F -M 192.0.2.10&quot;</code></pre></li>
<li><p>Send the query string to the <em>Ris Whois Server</em> on port 43
with the nicname (whois) protocol. Example of command line command on
unix:</p></li>
</ol>
<pre><code>whois -h riswhois.ripe.net &quot; -F -M 192.0.2.10&quot;</code></pre>
<ol start="3" type="1">
<li>Do the following:
<ol type="1">
<li>The non-empty line not prepended with “%” contains the string with
data (no or one such line).</li>
<li>Check if there is no string with data (empty reply). If so, output
<em>[EMPTY_ASN_SET]</em> and end these steps for RIPE look-up of the
specific IP address.</li>
<li>If there is no response from the <em>Ris Whois Server</em>, output
<em>[ERROR_ASN_DATABASE]</em> and end these steps for RIPE look-up of
the specific IP address.</li>
<li>The first field has the ASN or list of ASNs. Split that into
ASNs.</li>
<li>If it was not possible to extrac the ASN or ASNs, output
<em>[ERROR_ASN_DATABASE]</em> and end these steps (the response was
malformed).</li>
</ol></li>
<li>Create the ASN set, for the IP address, from the ASN or ASNs from
the steps above and use it for the further processing.</li>
</ol>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-connectivity04"></a><h3>5.7. dns-connectivity04 - Verify that name servers are not announced in the same IP prefix</h3><h4>Description</h4><div class="markdown-content"><p>The objective in this Test Case is to verify that all IP addresses of
the domain’s authoritative name servers are announced from different IP
prefixes.</p>
<p>This Test is done separately on IPv4 and IPv6, and both must match
the criterion.</p>
<p>[RFC 2182, section 3.1][RFC 2182#3.1], clearly specifies that
distinct authoritative name servers for a child domain should be placed
in different topological and geographical locations. The objective is to
minimise the likelihood of a single failure disabling all of them.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested and reported by
[Connectivity01]. This Test Case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
<li>“Prefix Database” - The database of IP Prefix data to be used.
Possible values are “RIPE” and “Cymru” (the default value).</li>
<li>“Cymru Base Name” - If the <em>Prefix Database</em> is “Cymru”, the
default value is “asnlookup.zonemaster.net”.</li>
<li>“RIS Whois Server” - If the <em>Prefix Database</em> is “RIPE”, the
default value is “riswhois.ripe.net”.</li>
</ul>
<h4 id="summary">Summary</h4>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 17%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Message ID for message tag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CN04_EMPTY_PREFIX_SET</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip</td>
<td style="text-align: left;">Prefix database returned no information
for IP address {ns_ip}.</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN04_ERROR_PREFIX_DATABASE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip</td>
<td style="text-align: left;">Prefix database error. No data to analyze
for IP address {ns_ip}.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN04_IPV4_SAME_PREFIX</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_list, ip_prefix</td>
<td style="text-align: left;">The following name server(s) are announced
in the same IPv4 prefix ({ip_prefix}): “{ns_list}”</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN04_IPV4_DIFFERENT_PREFIX</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">ns_list</td>
<td style="text-align: left;">The following name server(s) are announced
in unique IPv4 prefix(es): “{ns_list}”</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN04_IPV6_SAME_PREFIX</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_list, ip_prefix</td>
<td style="text-align: left;">The following name server(s) are announced
in the same IPv6 prefix ({ip_prefix}): “{ns_list}”</td>
</tr>
<tr class="even">
<td style="text-align: left;">CN04_IPV6_DIFFERENT_PREFIX</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">ns_list</td>
<td style="text-align: left;">The following name server(s) are announced
in unique IPv6 prefix(es): “{ns_list}”</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
Profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [Argument
List].</p>
<h4 id="test-procedure">Test procedure</h4>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server name and IP address (“NS IPv4”)</li>
<li>Name server name and IP address (“NS IPv6”)</li>
<li>IP prefix, name server name and IP address (“IPv4 Prefix”)</li>
<li>IP prefix, name server name and IP address (“IPv6 Prefix”)</li>
</ol></li>
<li><p>Obtain the set of name server names and IP addresses using
[Method4] and [Method5] (“Name Servers”).</p></li>
<li><p>For each name server IP address in <em>Name Servers</em> do:</p>
<ol type="1">
<li>Add IPv4 addresses with name server name to the <em>NS IPv4</em>
set.</li>
<li>Add IPv6 addresses with name server name to the <em>NS IPv6</em>
set.</li>
</ol></li>
<li><p>For each IP address in <em>NS IPv4</em> and <em>NS IPv6</em> (“NS
IP Address”), respectively, do:</p>
<ol type="1">
<li>Determine the IP prefix in which <em>NS IP Address</em> is announced
using <em>Prefix Database</em>. See <a
href="#prefix-lookup-methods">Prefix Lookup Methods</a> section
below.</li>
<li>Add found IP prefix, if any, with <em>NS IP Address</em> and name
server name to the <em>IPv4 Prefix</em> and <em>IPv6 Prefix</em> sets,
respectively.</li>
</ol></li>
<li><p>If the <em>IPv4 Prefix</em> set is non-empty, then do:</p>
<ol type="1">
<li>For each IP prefix in the set that has two or more members, output
<em>[CN04_IPV4_SAME_PREFIX]</em> with the prefix and list of all members
(name server names and IP addresses) for that prefix.</li>
<li>For all IP prefixes in the set that have exactly one member, output
<em>[CN04_IPV4_DIFFERENT_PREFIX]</em> with the combined set of their
associated members (name server names and IP addresses).</li>
</ol></li>
<li><p>If the <em>IPv6 Prefix</em> set is non-empty, then do:</p>
<ol type="1">
<li>For each IP prefix in the set that has two or more members, output
<em>[CN04_IPV6_SAME_PREFIX]</em> with the prefix and list of all members
(name server names and IP addresses) for that prefix.</li>
<li>For all IP prefixes in the set that have exactly one member, output
<em>[CN04_IPV6_DIFFERENT_PREFIX]</em> with the combined set of their
associated members (name server names and IP addresses).</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>This Test Case is dependent on one of two possible services that can
provide ASN lookup (Cymru or RIPE RIS). The service must be available
over the network.</p>
<p>The <em>Child Zone</em> must be a valid name meeting “[Requirements
and normalization of domain names in input]”.</p>
<h4 id="prefix-lookup-methods">Prefix lookup methods</h4>
<p>Use the prefix method set in <em>Prefix Database</em> in “Inputs” and
refer to the appropriate section below.</p>
<h5 id="cymru-prefix-lookup">Cymru prefix lookup</h5>
<p>The Cymru prefix lookup is described on the Team Cymru [IP to ASN
Mapping] using DNS lookup.</p>
<ol type="1">
<li>Prepend the <em>Cymru Base Name</em> with the label “origin” (IPv4)
or “origin6” (IPv6) (“Expanded Base Name”). Example of expanded
basenames :</li>
</ol>
<pre><code>origin.asnlookup.zonemaster.net
origin6.asnlookup.zonemaster.net</code></pre>
<ol start="2" type="1">
<li><p>Reverse the IP address with the same method as is used for
reverse lookup (“Reverse IP”). For description see [RFC 1035][RFC
1035#3.5], section 3.5, for IPv4 and [RFC 3596][RFC 3596#2.5], section
2.5, for IPv6.</p></li>
<li><p>Prepend the <em>Expanded Base Name</em> with <em>Reverse IP</em>
(“Query Name”). See [IP to ASN Mapping] for details.</p></li>
<li><p>Create a [DNS Query] with query type TXT and query name <em>Query
Name</em>. (“TXT Query”).</p></li>
<li><p>[Send] <em>TXT Query</em> to the <em>Cymru Base
Name</em>.</p></li>
<li><p>If at least one of the following criteria is met, output
<em>[CN04_EMPTY_PREFIX_SET]</em> and exit this lookup:</p>
<ol type="1">
<li>The [DNS Response] has the [RCODE Name] NXDomain.</li>
<li>The [DNS Response] has the [RCODE Name] NoError and an empty answer
section.</li>
</ol></li>
<li><p>If at least one of the following criteria is met, output
<em>[CN04_ERROR_PREFIX_DATABASE]</em> and exit this lookup:</p>
<ol type="1">
<li>There is no DNS response.</li>
<li>The [DNS Response] does not have the [RCODE Name] NoError or
NXDomain.</li>
</ol></li>
<li><p>Extract the TXT record(s) from the response (see [IP to ASN
Mapping] for examples), and do:</p>
<ol type="1">
<li>If there are multiple strings (i.e., TXT records), ignore all
strings except for the string with the most specific subnet.</li>
<li>Extract and [concatenate] the IP prefix from the string.</li>
<li>If it was not possible to extract the IP prefix (i.e., malformed
response), output <em>[CN04_ERROR_PREFIX_DATABASE]</em> and exit this
lookup.</li>
</ol></li>
<li><p>Return the IP prefix.</p></li>
</ol>
<h5 id="ripe-prefix-lookup">RIPE prefix lookup</h5>
<p>The RIPE Prefix lookup is described on the RIPE [RISwhois] page.</p>
<ol type="1">
<li><p>Create a query string by prepending the IP address with ” -F -M ”
(“WHOIS String”). E.g., using IP address “192.0.2.10”:</p>
<pre><code>&quot; -F -M 192.0.2.10&quot;</code></pre></li>
<li><p>Create a WHOIS query (port 43 with the nicname ((whois))
protocol) using the <em>WHOIS String</em> (“WHOIS Query”). E.g., on
Linux:</p></li>
</ol>
<pre><code>whois -h riswhois.ripe.net &quot; -F -M 192.0.2.10&quot;</code></pre>
<ol start="3" type="1">
<li><p>[Send] <em>WHOIS Query</em> to the <em>RIS Whois
Server</em>.</p></li>
<li><p>If there is no response, output
<em>[CN04_ERROR_PREFIX_DATABASE]</em> and exit this lookup.</p></li>
<li><p>Extract the string (non-empty line not prepended with “%”) from
the response, and do:</p>
<ol type="1">
<li>If there is no such string, output <em>[CN04_EMPTY_PREFIX_SET]</em>
and exit this lookup.</li>
<li>Extract the IP prefix from the second field of the string.</li>
<li>If it was not possible to extract the IP prefix (i.e., malformed
response), output <em>[CN04_ERROR_PREFIX_DATABASE]</em> and exit this
lookup.</li>
</ol></li>
<li><p>Return the IP prefix.</p></li>
</ol>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency01"></a><h3>5.8. dns-consistency01 - Query all nameservers for SOA, and verify that they all have the same SOA serial number</h3><h4>Description</h4><div class="markdown-content"><p>For the data served by the authoritative name servers for a
designated zone to be consistent, all authoritative name servers must
serve the same SOA record for the designated zone.</p>
<p>If the serial number (explained in 3.3.13. of [RFC 1035]), which is
part of the SOA record, is not consistent between authoritative servers,
there is a possibility that the data served is inconsistent. The reasons
for this inconsistency may be different - such as misconfiguration, or
as a result of slow propagation to the secondary name servers.</p>
<p>The objective of this test is to verify that the serial number is
consistent between different authoritative name servers.</p>
<p>For reference purposes : [RFC 1982] explains the serial number
arithmetic, and section 4.3.5 of [RFC 1034] explains the importance of
serial number consistency.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested</li>
<li>“Accepted Serial Difference” - Accepted difference between SOA
serial values from SOA records of different name servers for <em>Child
Zone</em>. Default value is 0, i.e. no difference.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the list of name server IPs for the <em>Child Zone</em>
from [Method4] and [Method5] (“Name Server IP”).</p></li>
<li><p>Create an SOA query for <em>Child Zone</em> name (the top of the
zone).</p></li>
<li><p>Create an empty set of pair of retrieved SOA serials and name
server name and IP (“SOA Serial Set”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li><p>Send the SOA query to the name server.</p></li>
<li><p>If the name server does not respond with a DNS response, then
output <em>[NO_RESPONSE]</em>.</p></li>
<li><p>Or, if the name server returns a DNS response, but no SOA record
is included, then output <em>[NO_RESPONSE_SOA_QUERY]</em>.</p></li>
<li><p>Or, retrieve the SOA SERIAL from the response and add it to
<em>SOA Serial Set</em> (unless it is already there) and update the set
with the name server name and IP.</p></li>
</ol></li>
<li><p>If <em>SOA Serial Set</em> has exactly one SOA serial value, then
output <em>[ONE_SOA_SERIAL]</em>.</p></li>
<li><p>Or, if <em>SOA Serial Set</em> has at least two SOA serials
values, then do:</p>
<ol type="1">
<li>Order the serial number values from <em>SOA Serial Set</em> from
smallest to largest following the arithmetic for serial number, if
possible.</li>
<li>If there is not a single, uniquely defined order of the serial
numbers, then output <em>[SOA_SERIAL_VARIATION]</em> and
<em>[MULTIPLE_SOA_SERIALS]</em>.</li>
<li>Or, if the difference between the first and the last serial number
is larger than <em>Accepted Serial Difference</em>, using arithmetic for
serial number, then output <em>[SOA_SERIAL_VARIATION]</em> and
<em>[MULTIPLE_SOA_SERIALS]</em>.</li>
<li>Or, if the difference between the first and the last serial number
is not larger than <em>Accepted Serial Difference</em>, using arithmetic
for serial number, output <em>[MULTIPLE_SOA_SERIALS_OK]</em>.</li>
</ol></li>
<li><p>For each SOA serial value in <em>SOA Serial Set</em>, output
<em>[SOA_SERIAL]</em> with the serial number and a semicolon separated
list of name server names and IP address pairs (name/IP). ##
Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_SOA_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONE_SOA_SERIAL</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">MULTIPLE_SOA_SERIALS</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MULTIPLE_SOA_SERIALS_OK</td>
<td style="text-align: left;">NOTICE</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOA_SERIAL</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOA_SERIAL_VARIATION</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>A manual inspection of the SOA serial may be needed to determine if
the zone updates work properly or not, and if the serial values are
within a reasonable range, then the test is OK.</p>
<p>When comparing SOA serial it must be done using the arithmetic
defined in [RFC 1982].</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency02"></a><h3>5.9. dns-consistency02 - Query all nameservers for SOA, and verify that they all have the same SOA rname</h3><h4>Description</h4><div class="markdown-content"><p>All authoritative name servers must serve the same SOA record for the
tested domain (section 4.2.1 of [RFC 1034]). As per section 3.3.13 of
[RFC 1035], the RNAME field in the SOA RDATA refers to the
administrative contact. An inconsistency in the administrative contact
for the domain might result in operational failures being reported to
different persons.</p>
<p>The objective of this test is to verify that the administrative
contact is consistent between different authoritative name servers.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>The domain name to be tested (“Child Zone”)</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li>Obtain the list of name server IPs for the <em>Child Zone</em> from
[Method4] and [Method5].</li>
<li>Create an SOA query for <em>Child Zone</em> apex and send it to all
name server IPs.</li>
<li>Retrieve the SOA RR from the responses from all name server
IPs.</li>
<li>If a name server does not respond, emit <em>[NO_RESPONSE]</em>.</li>
<li>If a name server responds but does not include a SOA record in the
response, emit <em>[NO_RESPONSE_SOA_QUERY]</em>.</li>
<li>If at least one SOA record has been retrieved and RNAME is identical
in all SOA records, emit <em>[ONE_SOA_RNAME]</em>.</li>
<li>If RNAME is not identical in all SOA records, emit
<em>[MULTIPLE_SOA_RNAMES]</em>.</li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_SOA_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONE_SOA_RNAME</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">MULTIPLE_SOA_RNAMES</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency03"></a><h3>5.10. dns-consistency03 - Query all nameservers for SOA, and verify that they all have the same time parameters (REFRESH/RETRY/EXPIRE/MINIMUM)</h3><h4>Description</h4><div class="markdown-content"><p>All SOA record timer fields must be consistent across all
authoritative name servers. An inconsistency in these fields might
result in operational inconsistencies for the designated zone.</p>
<p>There are other test cases that provide consistency tests for the
other SOA fields:</p>
<ul>
<li>[CONSISTENCY01] (SOA Serial)</li>
<li>[CONSISTENCY02] (RNAME)</li>
<li>[CONSISTENCY06] (MNAME)</li>
</ul>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>The domain name to be tested (“Child Zone”).</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create an SOA query for <em>Child Zone</em> apex.</p></li>
<li><p>Obtain the list of name server IPs for the <em>Child Zone</em>
from [Method4] and [Method5].</p></li>
<li><p>Send the SOA query to all name server IPs.</p></li>
<li><p>If a name server does not respond, emit
<em>[NO_RESPONSE]</em>.</p></li>
<li><p>If a name server responds but no SOA record is included in the
response, emit <em>[NO_RESPONSE_SOA_QUERY]</em>.</p></li>
<li><p>Retrieve the SOA RR from the responses from all name server
IPs.</p></li>
<li><p>Emit <em>[ONE_SOA_TIME_PARAMETER_SET]</em> if at least one SOA
record has been retrieved and all SOA records have:</p>
<ol type="1">
<li>the same REFRESH value,</li>
<li>the same RETRY value,</li>
<li>the same EXPIRE value, and</li>
<li>the same MINIMUM value.</li>
</ol></li>
<li><p>Emit <em>[MULTIPLE_SOA_TIME_PARAMETER_SET]</em> if any two SOA
records had different values in previous step.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 47%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_SOA_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONE_SOA_TIME_PARAMETER_SET</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">MULTIPLE_SOA_TIME_PARAMETER_SET</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency04"></a><h3>5.11. dns-consistency04 - Query all nameservers for the NS set, and verify that they have all the same content</h3><h4>Description</h4><div class="markdown-content"><p>All authoritative name servers must serve the same NS record set for
the tested domain, child zone ([RFC 1034], section 4.2.2). Any
inconsistencies in NS records described in [RFC 1035], section 3.3.11,
might result in operational failures.</p>
<p>The objective of this test is to verify that the NS records are
consistent between all authoritative name servers of the child zone.</p>
<p>Two NS RR sets are considered to be equal if both sets have the same
number of NS records, and for each NS record in one of the sets there is
exactly one NS record with identical owner name, class, TTL and RDATA in
the other NS set.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>The domain name to be tested (“Child Zone”).</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the set of name server IPs for the <em>Child Zone</em>
using [Method4] and [Method5].</p></li>
<li><p>Create an NS query for the apex of the <em>Child
Zone</em>.</p></li>
<li><p>Send the NS query to each of the retrieved name server
IPs.</p></li>
<li><p>If a name server IP does not respond, emit
<em>[NO_RESPONSE]</em>.</p></li>
<li><p>If the response from a name server IP does not include an NS RR
set for the <em>Child Zone</em> with the AA flag set, emit
<em>[NO_RESPONSE_NS_QUERY]</em>.</p></li>
<li><p>If all retreived NS RR sets are equal, emit
<em>[ONE_NS_SET]</em>. Otherwise, emit <em>[MULTIPLE_NS_SET]</em>. ##
Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_NS_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONE_NS_SET</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">MULTIPLE_NS_SET</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency05"></a><h3>5.12. dns-consistency05 - Verify that the glue records are consistent with authoritative data</h3><h4>Description</h4><div class="markdown-content"><p>For name servers that have IP addresses listed as glue, the IP
addresses must match the authoritative A and AAAA records for that host.
This is an IANA [name server requirement].</p>
<p>The objective of this test is to verify that the <a
href="#terminology">glue records</a> in the delegation are consistent
with authoritative data.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the set of name server names from the NS records in the
delegation of <em>Child Zone</em> using [Method2] and any glue IP
addresses from the same delegation using [Method4].</p>
<ol type="1">
<li><p>Extract the <a href="#terminology">in-bailiwick</a> name server
names and create the set “Delegation Strict Glue”, where each name
server name is matched with its IP address or addresses, if available.
(The set may be empty.)</p></li>
<li><p>Extract the <a href="#terminology">out-of-bailiwick</a> name
server names and create the set “Delegation Extended Glue”, where each
name server name is matched with its IP address or addresses, if
available. (The set may be empty.)</p></li>
</ol></li>
<li><p>Obtain the set of name server names for the <em>Child Zone</em>
using [Method2] and [Method3] and extract the <a
href="#terminology">in-bailiwick</a> name server names, “IB NS Name
Set”. (The set may be empty.)</p></li>
<li><p>Create an empty set of name server name with associated IP
address or addresses, “Address Records From Child”.</p></li>
<li><p>If <em>IB NS Name Set</em> is non-empty, obtain the set of name
server IP addresses, “NS IP”, for <em>Child Zone</em> using [Method4]
and [Method5].</p></li>
<li><p>If <em>IB NS Name Set</em> is non-empty, then for each name
server name in that set do:</p>
<ol type="1">
<li><p>Create one A query and one AAAA query with the RD flag unset and
name server name as owner name.</p></li>
<li><p>For each name server in <em>NS IP</em> and for each record types
(A, AAAA):</p>
<ol type="1">
<li>Send the address query to the name server.</li>
<li>If there is no DNS response from the server, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Or, if the response is a delegation (referral) to a sub-zone of
<em>Child Zone</em>, then:
<ol type="1">
<li>Copy the adress query (A, AAAA) that gave the referral
response.</li>
<li>Set the RD flag in the copied query (from unset to set).</li>
<li>Do a <a href="#terminology">DNS Lookup</a> of the the query.</li>
<li>If the lookup returns the relevant address record or records, A for
A record query and AAAA for AAAA record query, and with the same owner
name as in the query (i.e. CNAME should not be followed), then extract
those and add to <em>Address Records From Child</em> with name and IP
address or addresses.</li>
</ol></li>
<li>Or, if the response has the AA flag unset, then output
<em>[CHILD_NS_FAILED]</em>.</li>
<li>Or, if the RCODE of the response is neither NOERROR nor NXDOMAIN,
then output <em>[CHILD_NS_FAILED]</em>.</li>
<li>Or, if the RCODE is NOERROR (with the AA flag set), then extract any
address records (A, AAAA) from the answer section whose owner name
matches the owner name of the query (i.e. CNAME should not be followed)
and add that or those to <em>Address Records From Child</em> with name
and IP.</li>
<li>Else, there is nothing to do (i.e. RCODE is NXDOMAIN).</li>
</ol></li>
<li><p>If all servers outputted <em>[NO_RESPONSE]</em> or
<em>[CHILD_NS_FAILED]</em>, then output <em>[CHILD_ZONE_LAME]</em> and
completely stop processing this test case.</p></li>
</ol></li>
<li><p>Compare the IP address for the name servers from <em>Delegation
Strict Glue</em> with <em>Address Records From Child</em> (i.e. <a
href="#terminology">in-bailiwick</a> only).</p>
<ol type="1">
<li><p>If an IP from <em>Delegation Strict Glue</em> is not listed in
<em>Address Records From Child</em> with that same name server name,
then output <em>[IN_BAILIWICK_ADDR_MISMATCH]</em>.</p></li>
<li><p>If an IP from <em>Address Records From Child</em> is not listed
in <em>Delegation Strict Glue</em> with that same name server name, then
output <em>[EXTRA_ADDRESS_CHILD]</em>.</p></li>
</ol></li>
<li><p>For each name server name in <em>Delegation Extended Glue</em>
(i.e. <a href="#terminology">out-of-bailiwick</a> only) (“DEG Name
Server Name”) do:</p>
<ol type="1">
<li><p>Do two <a href="#terminology">DNS Lookups</a>, one record type A
and one record type AAAA, for <em>DEG Name Server Name</em> on public
DNS and create a set of the IP addresses from the A and AAAA records,
respectively, from the answer sections of the responses and that matches
the owner name of the query (i.e. CNAME should not be followed). (The
set will be empty if there are no relevant records in the answer
sections or if there is no response, e.g. SERVFAIL.)</p></li>
<li><p>For each IP address for <em>DEG Name Server Name</em> in
<em>Delegation Extended Glue</em> do:</p>
<ol type="1">
<li>If the address is not member of the IP address set created in the
previous DNS lookups, output
<em>[OUT_OF_BAILIWICK_ADDR_MISMATCH]</em>.</li>
</ol></li>
</ol></li>
<li><p>If none of <em>[IN_BAILIWICK_ADDR_MISMATCH]</em>,
<em>[EXTRA_ADDRESS_CHILD]</em> or
<em>[OUT_OF_BAILIWICK_ADDR_MISMATCH]</em> has been outputted, output
<em>[ADDRESSES_MATCH]</em>. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test case is “pass” in all other cases.</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (when message is
outputted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CHILD_NS_FAILED</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHILD_ZONE_LAME</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">IN_BAILIWICK_ADDR_MISMATCH</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OUT_OF_BAILIWICK_ADDR_MISMATCH</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">EXTRA_ADDRESS_CHILD</td>
<td style="text-align: left;">NOTICE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADDRESSES_MATCH</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol and log a
message reporting the ignored result.</p>
<p>If the test is an [undelegated test] then [Method2] and [Method4]
will include the provided input data instead of data from any real
delegation and authoritative data.</p>
<p>For an [undelegated test] it is possible to intentionally insert data
for <a href="#terminology">out-of-bailiwick</a> name servers that do not
match what is found in public DNS. This Test Case will then report this
as an ERROR which may not match the users expectation.</p>
<p>It is assumed that the name servers of the parent zone behave the
same way for the parent zone as when [BASIC01] was run.</p>
<h4 id="terminology">Terminology</h4>
<p>The terms “in-bailiwick” and “out-of-bailiwick” are used as defined
in [RFC 7719], section 6, page 15.</p>
<p>The term “glue records” is defined in [RFC 7719], section 6, page 15.
Here we use “glue” in the wider sense.</p>
<p>When the term “using Method” is used, names and IP addresses are
fetched using the defined [Methods].</p>
<p>The term “send” (to an IP address) is used when a DNS query is sent
to a specific name server.</p>
<p>The term “DNS Lookup” is used when a recursive lookup is used, though
any changes to the DNS tree introduced by an [undelegated test] must be
respected.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-consistency06"></a><h3>5.13. dns-consistency06 - Query all nameservers for SOA, and verify that they all have the same SOA mname</h3><h4>Description</h4><div class="markdown-content"><p>All authoritative name servers must serve the same SOA record
(section 4.2.1) of [RFC 1034] for the tested domain. As per section
3.3.13 of [RFC 1035] the MNAME field in the SOA RDATA refers to the name
of “the name server that was the original or primary source of data for
this zone”. Inconsistency in MNAME of the domain might result in
operational failures for applications that uses MNAME.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the set of name server IPs for the <em>Child Zone</em>
from [Method4] and [Method5] (“Name Server IP”).</p></li>
<li><p>Create an SOA query for <em>Child Zone</em> apex.</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send the query to name server.</li>
<li>If the name server does not respond with a DNS response, emit
<em>[NO_RESPONSE]</em> for that name server and go to next server.</li>
<li>If the DNS response does not include a SOA record in the answer
section then emit <em>[NO_RESPONSE_SOA_QUERY]</em> for that server and
go to next server.</li>
<li>Retrieve the MNAME field from the SOA RR from the DNS response and
save that to compare it with the MNAME from the other name servers.</li>
</ol></li>
<li><p>Compare the MNAME fields retreived from all name
servers.</p></li>
<li><p>If at least one name server has responded with a SOA record and
the MNAME is identical in all SOA records retrieved, emit
<em>[ONE_SOA_MNAME]</em>.</p></li>
<li><p>If MNAME is not identical in all SOA records retrieved, emit
<em>[MULTIPLE_SOA_MNAMES]</em>.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_SOA_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONE_SOA_MNAME</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">MULTIPLE_SOA_MNAMES</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation01"></a><h3>5.14. dns-delegation01 - Verify that there are more than two nameservers</h3><h4>Description</h4><div class="markdown-content"><p>Section 4.1 of [RFC 1034] specifies that there must be a minimum of
two name servers for a domain. This test is done to verify this
condition.</p>
<p>The RFC ([RFC 1034]) predates IPv6. Since IPv4 and IPv6 work as
separate networks, this test case has been extended to test for two name
servers that resolve into IPv4 addresses and IPv6 addresses
respectively.</p>
<p>Both [RFC 3901] (section 3) and [RFC 4472] (section 1.3) states that
a domain (zone) should be available over IPv4 for the time being.
Therefore, it is by the default level in this test case considered to be
more problematic not being available over IPv4 than not being available
over IPv6.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested</p>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Using [Method2], obtain the complete set of names of the name
servers from the delegation of the <em>Child Zone</em>.</p></li>
<li><p>Count the name server names:</p>
<ol type="1">
<li>If zero or one, emit <em>[NOT_ENOUGH_NS_DEL]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_NS_DEL]</em>.</li>
</ol></li>
<li><p>Using [Method4], obtain the IP addresses for the name servers of
the delegation of the <em>Child Zone</em>.</p></li>
<li><p>Count the number of name server names that resolve into at least
one IPv4 address:</p>
<ol type="1">
<li>If zero, emit <em>[NO_IPV4_NS_DEL]</em>.</li>
<li>If one, emit <em>[NOT_ENOUGH_IPV4_NS_DEL]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_IPV4_NS_DEL]</em>.</li>
</ol></li>
<li><p>Count the number of name server names that resolve into at least
one IPv6 address:</p>
<ol type="1">
<li>If zero, emit <em>[NO_IPV6_NS_DEL]</em>.</li>
<li>If one, emit <em>[NOT_ENOUGH_IPV6_NS_DEL]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_IPV6_NS_DEL]</em>.</li>
</ol></li>
<li><p>Using [Method3], obtain the complete set of names of the name
servers from the <em>Child Zone</em> for the <em>Child
Zone</em>.</p></li>
<li><p>Count the name server names:</p>
<ol type="1">
<li>If zero or one, emit <em>[NOT_ENOUGH_NS_CHILD]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_NS_CHILD]</em>.</li>
</ol></li>
<li><p>Using [Method5], obtain the IP addresses for the name servers
from the <em>Child Zone</em> for the <em>Child Zone</em>.</p></li>
<li><p>Count the number of name server names that resolve into at least
one IPv4 address:</p>
<ol type="1">
<li>If zero, emit <em>[NO_IPV4_NS_CHILD]</em>.</li>
<li>If one, emit <em>[NOT_ENOUGH_IPV4_NS_CHILD]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_IPV4_NS_CHILD]</em>.</li>
</ol></li>
<li><p>Count the number of name server names that resolve into at least
one IPv6 address:</p>
<ol type="1">
<li>If zero, emit <em>[NO_IPV6_NS_CHILD]</em>.</li>
<li>If one, emit <em>[NOT_ENOUGH_IPV6_NS_CHILD]</em>.</li>
<li>If two or more, emit <em>[ENOUGH_IPV6_NS_CHILD]</em>.</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>Else the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ENOUGH_IPV4_NS_CHILD</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENOUGH_IPV4_NS_DEL</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ENOUGH_IPV6_NS_CHILD</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENOUGH_IPV6_NS_DEL</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ENOUGH_NS_CHILD</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENOUGH_NS_DEL</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOT_ENOUGH_IPV4_NS_CHILD</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NOT_ENOUGH_IPV4_NS_DEL</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOT_ENOUGH_IPV6_NS_CHILD</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NOT_ENOUGH_IPV6_NS_DEL</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NOT_ENOUGH_NS_CHILD</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NOT_ENOUGH_NS_DEL</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NO_IPV4_NS_CHILD</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_IPV4_NS_DEL</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NO_IPV6_NS_CHILD</td>
<td style="text-align: left;">NOTICE</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_IPV6_NS_DEL</td>
<td style="text-align: left;">NOTICE</td>
</tr>
</tbody>
</table>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation02"></a><h3>5.15. dns-delegation02 - Verify that name servers have distinct IP addresses</h3><h4>Description</h4><div class="markdown-content"><p>If the domain’s name servers use several different names, they can
all be using the same IP address. This may be due to a configuration
error, or a workaround for a certain policy restriction. This test case
checks that the name servers used do not reuse the same IP
addresses.</p>
<p>Section 4.1 of [RFC 1034] says at least two name servers must be used
for a delegation.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested.</p>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the complete set of name server names in the delegation of
the <em>Child Zone</em> using [Method2] and the IP addresses for each
name using [Method4].</p></li>
<li><p>If the same IP address is found for two or more name server
names, emit <em>[DEL_NS_SAME_IP]</em> for each repeated address, else
emit <em>[DEL_DISTINCT_NS_IP]</em>.</p></li>
<li><p>Obtain the complete set of name server names from the <em>Child
Zone</em> using [Method3] and the IP addresses for each name using
[Method5].</p></li>
<li><p>If the same IP address is found for two or more name server
names, emit <em>[CHILD_NS_SAME_IP]</em> for each repeated address, else
emit <em>[CHILD_DISTINCT_NS_IP]</em>.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DEL_NS_SAME_IP</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">CHILD_NS_SAME_IP</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DEL_DISTINCT_NS_IP</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="even">
<td style="text-align: left;">CHILD_DISTINCT_NS_IP</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation03"></a><h3>5.16. dns-delegation03 - Verify that there is no truncation on referrals</h3><h4>Description</h4><div class="markdown-content"><p>The Domain Name System defaults to using UDP for queries and answers
with a DNS payload limit of 512 octets (bytes). Larger replies cause an
initial truncation indication leading to a subsequent handling via TCP
with substantially higher overhead. EDNS0 is used to allow for larger
UDP responses thus reducing the need for use of TCP.</p>
<p>But <a
href="https://www.iana.org/help/nameserver-requirements">IANA</a> still
maintains that referrals from the parent zone name servers must fit into
a non-EDNS0 UDP DNS packet.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create a DNS packet with a maximally long subdomain under the
<em>Child Zone</em> apex (that is, 255 octets including label
separators) in the Query section.</p></li>
<li><p>Obtain the set of name server names from the delegation of the
<em>Child Zone</em> from the parent using [Method2].</p></li>
<li><p>For each name server name obtained in the previous step:</p>
<ol type="1">
<li>Create an NS record with the <em>Child Zone</em> apex as owner name
and the name server name as RDATA.</li>
<li>Add the NS record to the Authority section of the DNS packet created
above using the message compression schema defined in section 4.1.4 of
<a href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>
where applicable.</li>
</ol></li>
<li><p>Using [Method1], get the parent zone of <em>Child
Zone</em>.</p></li>
<li><p>Obtain the name server IP addresses per name server name for the
delegation using [Method4].</p></li>
<li><p>Make a set of the name server names that resolve into at least
one IPv4 address (“IPv4 Name Server Set”).</p></li>
<li><p>If the <em>IPv4 Name Server Set</em> is not empty and all name
server names in it are <a href="#in-bailiwick-of-parent">In-Bailiwick of
Parent</a> then:</p>
<ol type="1">
<li>Create an A record using one of the name server names and any IPv4
address.</li>
<li>Add the A record to the Additional section of the DNS packet created
above using the message compression schema defined in section 4.1.4 of
<a href="https://datatracker.ietf.org/doc/html/rfc1035">RFC
1035</a>.</li>
</ol></li>
<li><p>Make a set of the name server names that resolve into at least
one IPv6 address (“IPv6 Name Server Set”).</p></li>
<li><p>If the <em>IPv6 Name Server Set</em> is not empty and all name
server names in it are <a href="#in-bailiwick-of-parent">In-Bailiwick of
Parent</a> then:</p>
<ol type="1">
<li>Create a AAAA record using one of the name server names and any IPv6
address.</li>
<li>Add the AAAA record to the Additional section of the DNS packet
created above using the message compression schema defined in section
4.1.4 of <a href="https://datatracker.ietf.org/doc/html/rfc1035">RFC
1035</a>.</li>
</ol></li>
<li><p>If the size of the DNS packet after encoding exceeds 512 octets
then output <em>[REFERRAL_SIZE_TOO_LARGE]</em> else output
<em>[REFERRAL_SIZE_OK]</em>. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level of message</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">REFERRAL_SIZE_TOO_LARGE</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">REFERRAL_SIZE_OK</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="terminology">Terminology</h4>
<p>The terms “in-bailiwick” and “out-of-bailiwick” are used as defined
in <a href="https://datatracker.ietf.org/doc/html/rfc7719">RFC 7719</a>,
section 6, page 15.</p>
<h4 id="in-bailiwick-of-parent">In-Bailiwick of Parent</h4>
<p>A name server name is <em>In-Bailiwick of Parent</em> if the name is
a or below the zone cut of the parent zone. If “example.com” is the
parent zone of “foofoo.example.com” then name server
“ns1.barbar.example.com” is <em>In-Bailiwick of Parent</em> for
“foofoo.example.com”.</p>
<p>All name servers of a TLD are <em>In-Bailiwick of Parent</em> since
all names are below the root apex ‘.’.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation04"></a><h3>5.17. dns-delegation04 - Verify that nameservers are authoritative</h3><h4>Description</h4><div class="markdown-content"><p>Subsection 6.1 of <a
href="https://datatracker.ietf.org/doc/html/rfc2181">RFC 2181</a>
specifies that the nameservers must answer authoritatively for the
domain. Answers to queries to the name servers for the designated zone
must have the “AA” bit set.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain the complete set of name server address records from the
parent using <a href="../Methods.md">Method4</a> and the child using <a
href="../Methods.md">Method5</a>.</li>
<li>All the uniquely obtained address records are queried for the SOA
record over TCP and UDP on port 53.</li>
<li>For each query in step 2, check whether DNS answer (bogus response
are not checked here) is obtained. If any of the query fails to respond
with an answer, then do not proceed to step 4 for that query. Exit from
the test without any exceptions.</li>
<li>If any name server fail to give an authoritative answer (“AA-bit” is
set in the answer), the test fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If all the name servers answer with the AA-bit set, then the test
succeeds.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation05"></a><h3>5.18. dns-delegation05 - Verify that NS RRs do not point to CNAMEs</h3><h4>Description</h4><div class="markdown-content"><p>Name servers for a zone are defined in NS records. An NS record
points at a name, i.e. the RDATA for an NS record is a domain name. That
name is the name of the name server. [RFC 2181][RFC 2181#10.3], section
10.3, states that the name of the name server must not itself point at a
CNAME.</p>
<p>The objective of this test is to verify that name servers of the
tested domain (zone) do not point at CNAME records.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the set of name server names using [Method2] and [Method3]
(“NS Name”).</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“NS IP”).</p></li>
<li><p>For each name server name in <em>NS Name</em> do:</p>
<ol type="1">
<li><p>Create a query for A record (A query) with the name server name
as owner name.</p></li>
<li><p>If the name server name is [in-domain] (sub-type of
[in-bailiwick]) then for each name server IP in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send the A query to the name server IP with the RD flag unset.</li>
<li>If the name server does not respond with a DNS response, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Else, if the RCODE is not NOERROR, then output
<em>[UNEXPECTED_RCODE]</em>.</li>
<li>Else, if the answer section of the response includes a CNAME record
then output <em>[NS_IS_CNAME]</em>.</li>
<li>Else, if the response is a delegation (referral) to a sub-zone of
<em>Child Zone</em>, then:
<ol type="1">
<li>Do a [DNS Lookup] of the A query with the RD flag set.</li>
<li>If the answer section of the response includes a CNAME record then
output <em>[NS_IS_CNAME]</em>.</li>
</ol></li>
</ol></li>
<li><p>Else (the name server name is either [sibling domain] or
[out-of-bailiwick]) then do:</p>
<ol type="1">
<li>Do a [DNS Lookup] of the the A query with the RD flag set.</li>
<li>If the answer section of the response includes a CNAME record then
output <em>[NS_IS_CNAME]</em>.</li>
</ol></li>
</ol></li>
<li><p>If no <em>[NS_IS_CNAME]</em> was outputted, then output
<em>[NO_NS_CNAME]</em>.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNEXPECTED_RCODE</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS_IS_CNAME</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_NS_CNAME</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<h4 id="terminology">Terminology</h4>
<p>The terms “in-domain”, “sibling domain”, “in-bailiwick” and
“out-of-bailiwick” are used as defined in [RFC 8499][RFC 8499#7],
section 7 (p 25), where “in-domain” and “sibling domain” are defined as
a sub-types of “in-bailiwick”.</p>
<p>The term “DNS Lookup” is used when a recursive lookup is used, though
any changes to the DNS tree introduced by an [undelegated test] must be
respected.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-delegation06"></a><h3>5.19. dns-delegation06 - Verify existence of SOA</h3><h4>Description</h4><div class="markdown-content"><p>Section 6.1 of the <a
href="https://datatracker.ietf.org/doc/html/rfc2181">RFC 2181</a>
specifies that the SOA record is mandatory for every zone.</p>
<p>This test is intended to verify the prescence of a SOA record for the
domain.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain the complete set of name server address records from the
parent using <a href="../Methods.md">Method4</a> and the child using <a
href="../Methods.md">Method5</a>.</li>
<li>All the uniquely obtained address records are queried for the SOA
record.</li>
<li>If there is an answer with NOERROR and there is no content in the
answer section, this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If there is a SOA record present for the domain this test case
succeeds.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver01"></a><h3>5.20. dns-nameserver01 - Verify that nameserver does not provide recursive service</h3><h4>Description</h4><div class="markdown-content"><p>To ensure consistency in DNS, an authoritative name server should not
be configured to do recursive lookups. Also, open recursive resolvers
are considered bad internet practice due to their capability of
assisting in large scale DDoS attacks. The introduction to [RFC 5358]
elaborates on mixing recursor and authoritative functionality, and the
issue is further elaborated by [D.J. Bernstein].</p>
<p>Section 2.5 of [RFC 2870] have very specific requirement on disabling
recursion functionality on root name servers.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>The domain name to be tested (“Child Zone”).</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create A queries for the following domain names:</p>
<ol type="1">
<li>xn–nameservertest.iis.se</li>
<li>xn–nameservertest.icann.org</li>
<li>xn–nameservertest.ripe.net</li>
</ol></li>
<li><p>Retrieve all name server IPs for the <em>Child Zone</em> using
[Method4] and [Method5].</p></li>
<li><p>Repeat the following steps for each name server IP.</p>
<ol type="1">
<li>Send the three A queries over UDP.</li>
<li>For each query do the following steps:
<ol type="1">
<li>If the name server does not respond with a DNS response, then emit
<em>[NO_RESPONSE]</em>.</li>
<li>If the DNS response comes with the RA flag set, then emit
<em>[IS_A_RECURSOR]</em>.</li>
</ol></li>
<li>If the RCODE is NXDOMAIN in the responses for all three queries then
emit <em>[IS_A_RECURSOR]</em>.</li>
<li>If neither <em>[NO_RESPONSE]</em> nor <em>[IS_A_RECURSOR]</em> has
been emitted for that server, then emit <em>[NO_RECURSOR]</em>.</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<colgroup>
<col style="width: 45%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (if message is
emitted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">IS_A_RECURSOR</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NO_RECURSOR</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>The domain names used in the queries are selected to be almost
certainly non-existent name since the names are chosen to violate the
[IDNA 2008 specification] under SLDs (second-level domains) expected to
respect that specification. The SLDs are selected so that the chance
that they are all hosted on the same servers is low.</p>
<h4 id="terminology">Terminology</h4>
<p>Valid domain names according to the “IDNA 2008 specification” is
found in [RFC 5890], section 2.3.1, page 7.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver02"></a><h3>5.21. dns-nameserver02 - Verify EDNS0 support</h3><h4>Description</h4><div class="markdown-content"><p>EDNS(0) is a mechanism to announce capabilities of a DNS
implementation, and is now basically required by any new functionality
in DNS such as DNSSEC. EDNS(0) is standardized in [RFC 6891].</p>
<p>This test case checks that all name servers has the capability to do
EDNS(0) or if not, correctly replies to queries containing EDNS (OPT
record).</p>
<p>Servers not supporting EDNS(0) must return FORMERR ([RFC 6891,
section 7]):</p>
<blockquote>
<p>Responders that choose not to implement the protocol extensions
defined in this document MUST respond with a return code (RCODE) of
FORMERR to messages containing an OPT record in the additional section
and MUST NOT include an OPT record in the response.</p>
</blockquote>
<p>Servers supporting EDNS(0) must reply with EDNS(0) ([RFC 6891,
section 6.1.1]):</p>
<blockquote>
<p>If an OPT record is present in a received request, compliant
responders MUST include an OPT record in their respective responses.</p>
</blockquote>
<p>To eliminating the risk of falsely classifying the server as not
supporting EDNS due e.g. firewall issues, the UDP buffer size is set to
512 bytes (octets).</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Created an SOA query for the <em>Child Zone</em> with an OPT
record with EDNS version set to “0” and with EDNS(0) option of payload
size (“bufsize”) set to 512 and “DO” bit unset.</p></li>
<li><p>Create a second SOA query for the <em>Child Zone</em> without any
OPT record.</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send the SOA query <strong>with</strong> OPT record to the name
server and collect the response.</li>
<li>If there is no DNS response, then:
<ol type="1">
<li>Send the SOA query <strong>without</strong> OPT record to the name
server and collect the response.</li>
<li>If there is no DNS response, then output <em>[NO_RESPONSE]</em> and
go to next server.</li>
<li>Else (there is a DNS response), then output
<em>[BREAKS_ON_EDNS]</em> and go to next server.</li>
</ol></li>
<li>Else, if the DNS response meet the following two criteria, then
output <em>[NO_EDNS_SUPPORT]</em>:
<ol type="1">
<li>It has the RCODE “FORMERR”</li>
<li>It has no OPT record.</li>
</ol></li>
<li>Else, if the DNS response meet the following criteria (compliant
server), then go to the next name server:
<ol type="1">
<li>It has the RCODE “NOERROR”.</li>
<li>The answer section contains the SOA record for <em>Child
Zone</em>.</li>
<li>It has OPT record with EDNS version 0.</li>
</ol></li>
<li>Else, if the DNS response meet the following criteria, then output
<em>[EDNS_RESPONSE_WITHOUT_EDNS]</em> and go to next server.
<ol type="1">
<li>It has the RCODE “NOERROR”.</li>
<li>It has no OPT record.</li>
</ol></li>
<li>Else, if the DNS response meet the following criteria, then output
<em>[EDNS_VERSION_ERROR]</em> and go to next server.
<ol type="1">
<li>It has the RCODE “NOERROR”.</li>
<li>It has OPT record with EDNS version other than 0.</li>
</ol></li>
<li>Else output <em>[NS_ERROR]</em> (i.e. other erroneous or unexpected
response).</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test case is “pass” in all other cases.</p>
<table>
<colgroup>
<col style="width: 48%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (when message is
outputted)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_EDNS_SUPPORT</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BREAKS_ON_EDNS</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">EDNS_RESPONSE_WITHOUT_EDNS</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDNS_VERSION_ERROR</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NS_ERROR</td>
<td style="text-align: left;">WARNING</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol and log a
message reporting the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver04"></a><h3>5.22. dns-nameserver04 - Verify that replies from nameserver comes from the expected IP address</h3><h4>Description</h4><div class="markdown-content"><p>Responses from the authoritative name servers must contain same
source IP address as the destination IP address of the initial query.
This has been clarified in section 4 of <a
href="https://datatracker.ietf.org/doc/html/rfc2181#section-4">RFC
2181</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve all address records for all the name servers using <a
href="../Methods.md">Method 4</a> and <a href="../Methods.md">Method
5</a>.</li>
<li>A SOA query for the domain name sent to the each name server IP
address found in step 1.</li>
<li>Any answer received from the SOA query must come from the same
source IP address as the query was sent to. If there is a mismatch, this
test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If any response comes from another IP address than the query was sent
to, this test case fails.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>If there are many authoritative DNS nodes behind the IP adress the
query is sent to, there could be multiple answers with possibly
different source addresses for the query. This special case is currently
ignored.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver05"></a><h3>5.23. dns-nameserver05 - Verify behaviour against AAAA queries</h3><h4>Description</h4><div class="markdown-content"><p>Older implementations of authoritative name servers have shown
different misbehaviours trying to answer queries for AAAA records, as
described in [RFC 4074]. This test case is intended to find out if the
name server authoritative for the domain shows any of these behaviours.
## Scope</p>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers. ## Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested. ## Ordered description
of steps to be taken to execute the test case</li>
</ul>
<ol type="1">
<li><p>Create an A query for the apex of the <em>Child
Zone</em>.</p></li>
<li><p>Create a AAAA query for the apex of the <em>Child
Zone</em>.</p></li>
<li><p>Create an empty set “AAAA OK”.</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>For each name server IP address in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send the A query over UDP to the name server IP.</li>
<li>If no DNS response is returned, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Else, if DNS response does not have RCODE NOERROR, then output
<em>[A_UNEXPECTED_RCODE]</em>.</li>
<li>Else, do:
<ol type="1">
<li>Send the AAAA query over UDP to the name server IP.</li>
<li>If no DNS response is returned, then output
<em>[AAAA_QUERY_DROPPED]</em>.</li>
<li>Else, if the RCODE of the response is not NOERROR, then output
<em>[AAAA_UNEXPECTED_RCODE]</em>.</li>
<li>Else, if the answer section contains an AAAA record with incorrect
RDATA lenght (e.g. 4 instead of 16 octets), then output
<em>[AAAA_BAD_RDATA]</em>.</li>
<li>Else, add the name server IP to <em>AAAA OK</em>.</li>
</ol></li>
</ol></li>
<li><p>If <em>AAAA OK</em> is non-empty and no messages
<em>[AAAA_QUERY_DROPPED]</em>, <em>[AAAA_UNEXPECTED_RCODE]</em> or
<em>[AAAA_BAD_RDATA]</em> have been outputted for any name server IP,
then output <em>[AAAA_WELL_PROCESSED]</em>. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AAAA_BAD_RDATA</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAAA_QUERY_DROPPED</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AAAA_UNEXPECTED_RCODE</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">AAAA_WELL_PROCESSED</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A_UNEXPECTED_RCODE</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver06"></a><h3>5.24. dns-nameserver06 - Verify that each nameserver can be resolved to an IP address</h3><h4>Description</h4><div class="markdown-content"><p>All name servers names listed for a delegation must be resolvable in
DNS. If they are not resolvable using DNS this is a sign of
misconfiguration, and raises the risk of unreachability for the domain.
It could also lower the performance for any resolver trying to resolve
the name.</p>
<p>The objective of this test is to resolve the domain using all the
listed name servers used in the delegation. More information about
resolver behavior is in section 7 of <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain the list of name servers for the domain using <a
href="../Methods.md#method-2-obtain-glue-name-records-from-parent">Method
2</a> and <a
href="../Methods.md#method-3-obtain-name-servers-from-child">Method
3</a>.</li>
<li>Use <a
href="../Methods.md#method-4-obtain-glue-address-records-from-parent">Method
4</a> and <a
href="../Methods.md#method-5-obtain-the-name-server-address-records-from-child">Method
5</a> to resolve all the name server names obtained in step 1.</li>
<li>If any name does not resolve to either an A RR or AAAA RR, this test
case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If any of the name server names fails to resolve to an IP address,
this test case fails.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver07"></a><h3>5.25. dns-nameserver07 - Check whether authoritative name servers return an upward referral</h3><h4>Description</h4><div class="markdown-content"><p>The configuration and/or implementation of some authoritative name
servers causes them to return an upward referral to the root zone. There
are proofs that such a <a
href="https://www.dns-oarc.net/oarc/articles/upward-referrals-considered-harmful">behaviour
could be used for DDoS attacks</a> ### Inputs The domain name to be
tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>If the input domain to be tested is the root, exit from the
test.</li>
<li>Retrieve all address records for all the name servers using <a
href="../Methods.md">Method 4</a> and <a href="../Methods.md">Method
5</a>.</li>
<li>An NS query is sent to each name server IP address found in step 2,
with the root “.” as the destination</li>
<li>If any of the query returns with one or more responses in the
authority section, then this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>The test case is Ok only if there are no responses in the authority
section</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver08"></a><h3>5.26. dns-nameserver08 - Check whether authoritative name servers responses match the case of every letter in QNAME</h3><h4>Description</h4><div class="markdown-content"><p>The DNS standards require that nameservers treat names with case
insensitivity. That is, the names example.com and EXAMPLE.COM should
resolve to the same IP address. However, in the response, most
nameservers echo back the name as it appeared in the request, preserving
the original case.</p>
<p>Therefore, another way to add entropy to requests is to randomly vary
the case of letters in domain names queried. This technique, also known
as “0x20” because bit 0x20 is used to set the case of of US-ASCII
letters, was first proposed in the <a
href="https://datatracker.ietf.org/doc/html/draft-vixie-dnsext-dns0x20-00">IETF
internet draft</a> Use of Bit 0x20 in DNS Labels to Improve Transaction
Identity. With this technique, the nameserver response must match not
only the query name, but the case of every letter in the name string;
for example, wWw.eXaMpLe.CoM or WwW.ExamPLe.COm. This may add little or
no entropy to queries for the top-level and root domains, but it’s
effective for most hostnames.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve all address records for all the name servers using <a
href="../Methods.md">Method 4</a> and <a href="../Methods.md">Method
5</a>.</li>
<li>A random query with mixed case (e.G Www.iETf.Org) is sent to each
unique name server IP address found in step 1.</li>
<li>Remember the case of the QNAME in the query sent.</li>
<li>Compare the QNAME in the question section of the response with the
string in step3.</li>
<li>If the string in step3 and step4 are not equal with respect to case
in sensitivity, the test fails. ### Outcome(s) The test case is Ok only
if there are no responses in the authority section</li>
</ol>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver09"></a><h3>5.27. dns-nameserver09 - Check whether authoritative name servers return same results for equivalent names with different cases in the request</h3><h4>Description</h4><div class="markdown-content"><p>There has been cases where the nameservers respond with complete
case-sensitivity (in violation of the DNS standards): that is, they
match the exact case of the name in the response; but return different
results for equivalent names with different cases in the request
(typically NXDOMAIN). ### Inputs The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve all address records for all the name servers using <a
href="../Methods.md">Method 4</a> and <a href="../Methods.md">Method
5</a>.</li>
<li>Send a query with the input string in a mixed case
(e.g. wWW.iETF.oRG) to each of the name server IP address found in step
1.</li>
<li>If the “answer” flag is greater than 0, remember the “answer”
section, else remember the status flag.</li>
<li>Send another query with an alternative mixed case
(e.g. Www.Ietf.Org) to each of the name server found in step 1.</li>
<li>If the “answer” flag is greater than 0, remember the “answer”
section, else remember the status flag.</li>
<li>Compare the results remembered in step3 and step5.</li>
<li>If the results in step 6 are not equal, the test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>The test case passes only if the results of all queries are exactly
the same.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver10"></a><h3>5.28. dns-nameserver10 - Check whether authoritative name servers respond correctly to queries with undefined EDNS version</h3><h4>Description</h4><div class="markdown-content"><p>EDNS ([RFC 6891]) is a mechanism to announce capabilities of a DNS
implementation, and is required by new functionality in DNS such as
DNSSEC ([RFC 4033][RFC 4033#section-3], section 3).</p>
<p>[RFC 6891][RFC 6891#section-6.1.3], section 6.1.3, states that if a
nameserver has implemented EDNS but has not implemented the version
level of the request, then it MUST respond with RCODE “BADVERS”. Only
version “0” has been defined for EDNS.</p>
<p>Note that RCODE “BADVERS” is an extended RCODE which is calculated
from the combination of the normal RCODE field in the DNS package header
([RFC 1035][RFC 1035#section-4.1.1], section 4.1.1) and the OPT record
EXTENDED-RCODE field ([RFC 6891][RFC 6891#section-6.1.3], section
6.1.3). Also see [IANA RCODE Registry]. ## Scope</p>
<p>Issues covered by [Connectivity01] (basic name server issues) or
[Nameserver02] (basic EDNS issues) will not result in messages from this
test case. ## Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>Only relevant for a zone whose name servers correctly support EDNS,
version 0.</li>
</ul>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 8%" />
<col style="width: 18%" />
<col style="width: 43%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N10_NO_RESPONSE_EDNS1_QUERY</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Response when EDNS ver=0, but not when
1.</td>
</tr>
<tr class="even">
<td style="text-align: left;">N10_UNEXPECTED_RCODE</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, rcode</td>
<td style="text-align: left;">Unexpected RCODE value when EDNS
ver=1.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">N10_EDNS_RESPONSE_ERROR</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Expected RCODE value when EDNS ver=1, but
error in response.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP (“No Response EDNS1 Query”).</li>
<li>Name server IP and associated RCODE (“Unexpected RCODE”).</li>
<li>Name server IP (“EDNS Response Error”).</li>
</ol></li>
<li><p>Create an SOA query for the <em>Child Zone</em> with an OPT
record with EDNS version set to “0” and with EDNS option of payload size
(“bufsize”) set to 512 and other EDNS options and flags unset (“Query
One”).</p></li>
<li><p>Create an SOA query for the <em>Child Zone</em> with an OPT
record with EDNS version set to “1” and with EDNS option of payload size
(“bufsize”) set to 512 and other EDNS options and flags unset (“Query
Two”).</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send <em>Query One</em> over UDP to the name server, collect the
response and do:
<ol type="1">
<li>If there is no DNS response then go to next name server.</li>
<li>Else, if the RCODE value is not “NOERROR” then go to next name
server.</li>
</ol></li>
<li>Send <em>Query Two</em> over UDP to the name server, collect the
response and do:
<ol type="1">
<li>If there is no DNS response, then add the name server IP to the
<em>No Response EDNS1 Query</em> set.</li>
<li>Else, if the DNS response does not have RCODE with value “BADVERS”,
then add the name server IP and RCODE value to the <em>Unexpected
RCODE</em> set.</li>
<li>Else, if the DNS response meet all the following three criteria,
then just go to the next name server (correct response):
<ol type="1">
<li>It has the RCODE “BADVERS”.</li>
<li>It has EDNS version 0.</li>
<li>The answer section is empty.</li>
</ol></li>
<li>Else add the name server IP to the <em>EDNS Response Error</em>
set.</li>
</ol></li>
</ol></li>
<li><p>If the <em>No Response EDNS1 Query</em> set is non-empty, then
output <em>[N10_NO_RESPONSE_EDNS1_QUERY]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>Unexpected RCODE</em> set is non-empty, then for each
RCODE value in the set do:</p>
<ul>
<li>Output <em>[N10_UNEXPECTED_RCODE]</em> with the RCODE value and the
name server IP addresses for that RCODE value.</li>
</ul></li>
<li><p>If the <em>EDNS Response Error</em> set is non-empty, then output
<em>[N10_EDNS_RESPONSE_ERROR]</em> with the name server IP addresses
from the set. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol and log a
message reporting the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver11"></a><h3>5.29. dns-nameserver11 - Check whether authoritative name servers responses doe not include unknown EDNS OPTION-CODE used in query</h3><h4>Description</h4><div class="markdown-content"><p>EDNS is a mechanism to announce capabilities of a DNS implementation,
and is now basically required by any new functionality in DNS such as
DNSSEC ([RFC 6891]).</p>
<p>[RFC 6891][RFC 6891, section 6.1.2], section 6.1.2, states that any
OPTION-CODE values not understood by a responder or requestor MUST be
ignored. Unknown OPTION-CODE values must be processed as though the
OPTION-CODE was not even there.</p>
<p>In this test case, we will query with an unknown EDNS OPTION-CODE and
expect that the OPTION-CODE is not present in the response for the
query.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested and reported by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<p>It is assumed that <em>Child Zone</em> has been tested and reported
by [Nameserver02]. Running this test case without running [Nameserver02]
can give an incomplete report status of <em>Child Zone</em>.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested.</p>
<h4 id="summary">Summary</h4>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 8%" />
<col style="width: 17%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag</th>
<th style="text-align: left;">Level</th>
<th>Arguments</th>
<th>Message ID for message tag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">N11_NO_EDNS</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list</td>
<td>The DNS response, on query with unknown EDNS option-code, does not
contain any EDNS from name servers “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">N11_NO_RESPONSE</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list</td>
<td>There is no response on query with unknown EDNS option-code from
name servers “{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">N11_RETURNS_UNKNOWN_OPTION_CODE</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list</td>
<td>The DNS response, on query with unknown EDNS option-code, contains
an unknown EDNS option-code from name servers “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">N11_UNEXPECTED_ANSWER_SECTION</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list</td>
<td>The DNS response, on query with unknown EDNS option-code, does not
contain the expected SOA record in the answer section from name servers
“{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">N11_UNEXPECTED_RCODE</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list, rcode</td>
<td>The DNS response, on query with unknown EDNS option-code, has
unexpected RCODE name “{rcode}” from name servers “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">N11_UNSET_AA</td>
<td style="text-align: left;">WARNING</td>
<td>ns_ip_list</td>
<td>The DNS response, on query with unknown EDNS option-code, is
unexpectedly not authoritative from name servers “{ns_ip_list}”.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument
list].</p>
<h4 id="test-procedure">Test procedure</h4>
<p>In this section and unless otherwise specified below, the term “[EDNS
Query]” follows the specification for DNS queries as specified in [DNS
Query and Response Defaults]. The handling of the DNS responses on the
DNS queries follow, unless otherwise specified below, what is specified
for [EDNS Response] in the same specification.</p>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address (“No Response on Unknown Option Code”)</li>
<li>Name server IP address and [RCODE Name] (“Unexpected RCODE on
Unknown Option Code”)</li>
<li>Name server IP address (“No EDNS on Unknown Option Code”)</li>
<li>Name server IP address (“Unexpected Answer Section on Unknown Option
Code”)</li>
<li>Name server IP address (“Unset AA on Unknown Option Code”)</li>
<li>Name server IP address (“Returns Unknown Option Code”)</li>
</ol></li>
<li><p>Create a [EDNS Query] with query type SOA, <em>Child Zone</em> as
query name and with no EDNS options or flags (“SOA Query”).</p></li>
<li><p>Create a [EDNS Query] with query type SOA, <em>Child Zone</em> as
query name and with EDNS OPTION-CODE set to anything other than what is
already assigned in the [IANA-DNSSYSTEM-PARAMETERS] and no other EDNS
options or flags (“SOA Query with EDNS Option”).</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send <em>SOA Query</em> to the name server and collect the
response.</li>
<li>Go to next name server if at least one of the following criteria is
met:
<ol type="1">
<li>There is no DNS response from the server.</li>
<li>EDNS is unset in the response.</li>
<li>The [RCODE Name] in the response is not “NoError”.</li>
<li>The AA flag is unset in the response.</li>
<li>The answer section has no SOA record with <em>Child Zone</em> as
owner name.</li>
</ol></li>
<li>Send <em>SOA Query with EDNS Option</em> to the name server and
collect the response.
<ol type="1">
<li>If there is no DNS response from the server then add the name server
to the <em>No Response on Unknown Option Code</em> set.</li>
<li>Else, if the [RCODE Name] in the response is not “NoError” then add
the name server and [RCODE Name] to the <em>Unexpected RCODE on Unknown
Option Code</em> set. server.</li>
<li>Else, if EDNS is unset in the response then add the name server to
the <em>No EDNS on Unknown Option Code</em> set.</li>
<li>Else, if the answer section has no SOA record with <em>Child
Zone</em> as owner name then add the name server to the <em>Unexpected
Answer Section on Unknown Option Code</em> set.</li>
<li>Else, if the AA flag is unset in the response then add the name
server to the <em>Unset AA on Unknown Option Code</em> set.</li>
<li>Else, if the “OPTION-CODE” from the query is present in the
response, then add name server to the <em>Returns Unknown Option
Code</em> set.</li>
<li>Else, no issues were found.</li>
</ol></li>
</ol></li>
<li><p>If the <em>No Response on Unknown Option Code</em> set is
non-empty, then output <em>[N11_NO_RESPONSE]</em> with the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>Unexpected RCODE on Unknown Option Code</em> set is
non-empty, then for each [RCODE NAME] in the set output
<em>[N11_UNEXPECTED_RCODE]</em> with the [RCODE Name] and the name
servers IP addresses for that [RCODE NAME] in the set.</p></li>
<li><p>If the <em>No EDNS on Unknown Option Code</em> set is non-empty,
then output <em>[N11_NO_EDNS]</em> with the name servers IP addresses
from the set.</p></li>
<li><p>If the <em>Unexpected Answer Section on Unknown Option Code</em>
set is non-empty, then output <em>[N11_UNEXPECTED_ANSWER_SECTION]</em>
with the name servers IP addresses from the set.</p></li>
<li><p>If the <em>Unset AA on Unknown Option Code</em> set is non-empty,
then output <em>[N11_UNSET_AA]</em> with the name servers IP addresses
from the set.</p></li>
<li><p>If the <em>Returns Unknown Option Code</em> set is non-empty,
then output <em>[N11_RETURNS_UNKNOWN_OPTION_CODE]</em> with the name
servers IP addresses from the set. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, skip sending queries
over that transport protocol. A message will be outputted reporting that
the transport protocol has been skipped.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver12"></a><h3>5.30. dns-nameserver12 - Check whether authoritative name servers responses has &#34;Z&#34; bits cleared even if they are set in the query</h3><h4>Description</h4><div class="markdown-content"><p>EDNS is a mechanism to announce capabilities of a dns implementation,
and is now basically required by any new functionality in dns such as
DNSSEC ([RFC 6891]).</p>
<p>[RFC 6891][RCF 6891#section-6.1.4], section 6.1.4, states that “Z”
flag bits must be set to zero by senders and ignored by receiver.</p>
<p>[IANA] lists the flags in the [EDNS Header Flags] assignment
list.</p>
<p>In this test case, the query will have an unknown EDNS flag set, i.e.
one of the Z flag bits set to “1”, and it is expected that all “Z” bits
to be clear in the response (set to “0”).</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested.</p>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create a SOA query for the <em>Child Zone</em> with an OPT record
with one of the EDNS flag “Z” bits set to “1” and no other EDNS options
or flags set.</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send the SOA query to the name server and collect the response.</li>
<li>If there is no DNS response, output <em>[NO_RESPONSE]</em> and go to
next server.</li>
<li>Else, if the DNS response has the RCODE “FORMERR” then output
<em>[NO_EDNS_SUPPORT]</em>.</li>
<li>Else, if the pseudo-section has an OPT record with one or more Z
flag bits being set to “1”, then output [Z_FLAGS_NOTCLEAR].</li>
<li>Else, if the DNS response meet the following four criteria, then
just go to the next name server (no error):
<ol type="1">
<li>The SOA is obtained as response in the ANSWER section.</li>
<li>If the DNS response has the RCODE “NOERROR”.</li>
<li>The pseudo-section response has an OPT record with version set to
0.</li>
<li>The “Z” bits are clear in the response</li>
</ol></li>
<li>Else output <em>[NS_ERROR]</em>.</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test case is “pass” in all other cases.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_EDNS_SUPPORT</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS_ERROR</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z_FLAGS_NOTCLEAR</td>
<td style="text-align: left;">WARNING</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol and log a
message reporting the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-nameserver13"></a><h3>5.31. dns-nameserver13 - Verify that if the response to a query with an OPT record is truncated, then the response will contain an OPT record</h3><h4>Description</h4><div class="markdown-content"><p>EDNS is a mechanism to announce capabilities of a DNS implementation,
and is now basically required by any new functionality in DNS such as
DNSSEC ([RFC 6891]).</p>
<p>[RFC 6891, section 7] states that an OPT record must be included in a
truncated response, if the query includes an OPT pseudo record.</p>
<p>This Test Case will try to verify that if the response to a query
with an OPT record is truncated, then the response will contain an OPT
record.</p>
<p>To trigger a truncated response, the OPT pseudo record ‘DO’ bit is
set and the buffer size is limited to 512 bytes. If the zone is not
signed with DNSSEC, the response will probably not be truncated
anyway.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<p>“Child Zone” - The domain name to be tested.</p>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create a DNSKEY query for the <em>Child Zone</em> that is signed
with ‘DO’ bit set to ‘1’ and setting the buffer size to 512
bytes</p></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server in <em>Name Server IP</em> do:</p>
<ol type="1">
<li>Send the query to the name server and collect the response.</li>
<li>If there is no DNS response, output <em>[NO_RESPONSE]</em> and go to
next server.</li>
<li>Else, if the DNS response has the RCODE “FORMERR” then output
<em>[NO_EDNS_SUPPORT]</em> and go to the next server.</li>
<li>Else, if the DNS response meet the following criteria output
<em>[MISSING_OPT_IN_TRUNCATED]</em>: 1. The DNS response is truncated
(the “TC” flag is set). 2. The DNS response has no OPT record.</li>
<li>Else, if the DNS response meet the following criteria, then just go
to the next name server (no error):
<ol type="1">
<li>The DNS response has the RCODE “NOERROR”.</li>
<li>The pseudo-section response has an OPT record with version set to
0.</li>
</ol></li>
<li>Else output <em>[NS_ERROR]</em>.</li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test case is “pass” in all other cases.</p>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level (when message is
outputed)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_EDNS_SUPPORT</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NS_ERROR</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">MISSING_OPT_IN_TRUNCATED</td>
<td style="text-align: left;">WARNING</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol and log a
message reporting the ignored result.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-syntax05"></a><h3>5.32. dns-syntax05 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given has a conform usage of at sign (@)</h3><h4>Description</h4><div class="markdown-content"><p>The SOA RNAME field does not allow the ‘@’ characters to be used for
describing a mailbox. The first dot (‘.’) is thus translated into the
‘@’ character. This is a common mistake. The rules are defined in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain a set of name server IP addresses using [Method4] and
[Method5].</li>
<li>Create a SOA query for the zone.</li>
<li>Send the SOA query over UDP to each name server IP address until a
response is received or until the set is exhausted.</li>
<li>Check if the RNAME field contains a ‘@’ character. ###
Outcome(s)</li>
</ol>
<p>If there is any ‘@’ character in any SOA/RNAME field, this test case
fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-syntax06"></a><h3>5.33. dns-syntax06 - Verify that a SOA rname (Zonemaster::Engine::DNSName) given is RFC822 compliant</h3><h4>Description</h4><div class="markdown-content"><p>The SOA RNAME field is a mailbox address. The SOA RNAME field is
defined in [RFC 1035][RFC 1035#3.3.13], section 3.3.13 and in [RFC
1912][RFC 1912#2.2], section 2.2. The RNAME field should follow the
rules of an e-mail address also defined in [RFC 5322][RFC 5322#3.4.1],
section 3.4.1.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“NS IP”).</p></li>
<li><p>Create a SOA query for the apex of the <em>Child Zone</em> with
RD flag unset.</p></li>
<li><p>For each name server IP in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send the SOA query over UDP to the name server IP.</li>
<li>If the name server does not respond with a DNS response, then:
<ol type="1">
<li>Output <em>[NO_RESPONSE]</em>.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>If the DNS response does not include an SOA record in the answer
section, then:
<ol type="1">
<li>Output <em>[NO_RESPONSE_SOA_QUERY]</em>.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>Extract the RNAME from the SOA record (from the first SOA record if
multiple) and convert it to an email address (“Email Address” below)
using the following steps:
<ol type="1">
<li>Convert the first “.” without backslash quoting to an “@” in the
RNAME.</li>
<li>Convert any backslash quoted “.” to a single “.” without quoting
(see [RFC 1035], section [5.1][RFC 1035#5.1], [5.3][RFC 1035#5.3] and
[8][RFC 1035#8] for the use of backslash).</li>
</ol></li>
<li>If <em>Email Address</em> does not meet the mail address
specification in [RFC 5322][RFC 5322#3.4.1], section 3.4.1, then
<ol type="1">
<li>Output <em>[RNAME_RFC822_INVALID]</em>.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>Extract the domain part (to the right of “@”) from the <em>Mail
address</em> (“Domain Part” below).</li>
<li>Create an MX query for the <em>Domain Part</em> and do a [DNS
Lookup][terminology] of that query.</li>
<li>If the lookup of MX does not return a DNS response with RCODE
“NOERROR”, then:
<ol type="1">
<li>Output <em>[RNAME_MAIL_DOMAIN_INVALID]</em>.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>When doing the MX lookup, CNAME or a chain of CNAMEs are followed,
if any. If an MX record or records are found via CNAME, then set
<em>Domain Part</em> to be equal to the owner name of that MX record
(instead of being equal to the domain part of <em>Email
Address</em>).</li>
<li>If the MX lookup returned a NO DATA response (no MX record), then:
<ol type="1">
<li>Create address queries (A and AAAA) for the <em>Domain Part</em> and
do:
<ol type="1">
<li>Do [DNS Lookups][terminology] of those queries.</li>
<li>If the answer section contains a CNAME record output
<em>[RNAME_MAIL_ILLEGAL_CNAME]</em>.</li>
<li>Else, extract any A and AAAA records from the answer sections of the
DNS responses with <em>Domain Part</em> as owner name.</li>
</ol></li>
<li>If any A or AAAA record points at 127.0.0.1 or ::1 (localhost),
respectively, then output <em>[RNAME_MAIL_DOMAIN_LOCALHOST]</em>.</li>
<li>If no A or AAAA are extracted or any records points at 127.0.0.1 or
::1, then output <em>[RNAME_MAIL_DOMAIN_INVALID]</em>.</li>
</ol></li>
<li>If the MX lookup returns one or more MX records, then for each MX
record extract the domain name in RDATA (“Mail Exchange”) and do:
<ol type="1">
<li>Create address queries (A and AAAA) of <em>Mail Exchange</em> and
do:
<ol type="1">
<li>Do [DNS Lookups][terminology] of those queries.</li>
<li>If the answer section contains a CNAME record output
<em>[RNAME_MAIL_ILLEGAL_CNAME]</em>.</li>
<li>Else, extract any A and AAAA records from the answer sections of the
DNS responses with <em>Mail Exchange</em> as owner name.</li>
</ol></li>
<li>If any A or AAAA record points at 127.0.0.1 or ::1 (localhost),
respectively, then output <em>[RNAME_MAIL_DOMAIN_LOCALHOST]</em>.</li>
<li>If no A or AAAA are are extracted or any records points at 127.0.0.1
or ::1, then output <em>[RNAME_MAIL_DOMAIN_INVALID]</em>.</li>
</ol></li>
</ol></li>
<li><p>If at least one name server IP has neither outputted
<em>[NO_RESPONSE]</em> nor <em>[NO_RESPONSE_SOA_QUERY]</em> and
<em>[RNAME_MAIL_DOMAIN_INVALID]</em> has not been outputted for any name
server IP, then output <em>[RNAME_RFC822_VALID]</em>. ##
Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_SOA_QUERY</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RNAME_RFC822_INVALID</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">RNAME_MAIL_DOMAIN_INVALID</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RNAME_MAIL_DOMAIN_LOCALHOST</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">RNAME_MAIL_ILLEGAL_CNAME</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RNAME_RFC822_VALID</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result. ## Terminology</p>
<ul>
<li><p>“Using Method” - When the term is used, names and IP addresses
are fetched using the defined [Methods].</p></li>
<li><p>“Send” (to an IP address) - The term is used when a DNS query is
sent to a specific name server.</p></li>
<li><p>“DNS Lookup” - The term is used when a recursive lookup is used,
though any changes to the DNS tree introduced by an [undelegated test]
must be respected.</p></li>
</ul>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-syntax07"></a><h3>5.34. dns-syntax07 - Verify that SOA mname of zone given conforms to syntax rules</h3><h4>Description</h4><div class="markdown-content"><p>The SOA MNAME field is a hostname. Hostnames are valid according to
the rules defined in <a
href="https://datatracker.ietf.org/doc/html/rfc952">RFC 952</a>, in
section 2.1 in <a
href="https://datatracker.ietf.org/doc/html/rfc1123#section-2.1">RFC
1123</a>, section 11 in <a
href="https://datatracker.ietf.org/doc/html/rfc2181#section-11">RFC
2182</a> and section 2 and 5 in <a
href="https://datatracker.ietf.org/doc/html/rfc3696#section-2">RFC
3696</a>. Newer RFCs may override some rules defined in earlier
documents.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from the zone being tested.</li>
<li>Get the MNAME from the SOA record.</li>
<li>Each label of the hostname of the test object is used as the input
for the validation.</li>
<li>If any label in the hostname does not contain a-z or 0-9 this test
case fails.</li>
<li>If any label of the hostname is longer than 63 characters, this test
case fails.</li>
<li>If the hostname is longer than 255 characters including separators,
this test case fails.</li>
<li>If the rightmost label (the TLD) contains only digits, this test
case fails.</li>
<li>If there is a hyphen (‘-’) in position 3 and 4 of the label, and the
prefix is not xn (used for internationalization), this test case
fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If any of the steps 4 to 8 in the ordered description of this test
case fails, the whole test case fails.</p>
<h5 id="intercase-dependencies">Intercase dependencies</h5>
<p>This test case uses the same host name validator as test case <a
href="syntax04.md">SYNTAX04</a>.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone01"></a><h3>5.35. dns-zone01 - Check that master nameserver in SOA is fully qualified</h3><h4>Description</h4><div class="markdown-content"><p>The MNAME field from the SOA record of a zone is supposed to contain
the master name server for that zone. The hostname of the MNAME field
may not be listed in the NS records in the zone among the delegated name
servers, but should still be authoritative for the zone. MNAME may be
used for other services such as DNS NOTIFY described in [RFC1996].</p>
<p>[RFC1035], section 3.3.13, specifies that “the <em>domain-name</em>
of the name server that was the original or primary source of data for
this zone”.</p>
<p>[RFC1996], section 2, and [RFC2136], section 1, add that “the primary
master is named in the zone’s SOA MNAME field and optionally by an NS
RR. There is by definition only one primary master server per zone”.</p>
<p>[RFC2181], section 7.2, clarifies that “it is quite clear in the
specifications, yet seems to have been widely ignored, that the MNAME
field of the SOA record should contain the name of the primary (master)
server for the zone identified by the SOA. It should not contain the
name of the zone itself. That information would be useless, as to
discover it, one needs to start with the domain name of the SOA record -
that is the name of the zone”.</p>
<p>There exists an unstandardized practice to set the SOA MNAME to “.”,
which should not be interpreted that there is no primary master server,
but to indicate that there is no default server for dynamic updates.
With “.”, SOA MNAME has no server name. There is at least one old and
expired Internet-Draft that attempted to standardize that behavior,
[draft-jabley-dnsop-missing-mname]. If the SOA MNAME is an empty name
(“.”) this Test Case will not try to connect to a server behind it since
there will never be a server behind that name, as the purpose is most
definitely to follow that practice. Instead, a special message will be
outputted.</p>
<p>This Test Case will check that: - the SOA MNAME contains the master
name server of <em>Child Zone</em>, as best as it can be determined. -
the SOA MNAME name server is authoritative of <em>Child Zone</em>. - the
SOA SERIAL of the SOA MNAME is at least equal to the ones found from the
name servers in the NS record set of <em>Child Zone</em>. This
comparison must be done following [RFC1982]. - the SOA MNAME name server
is listed as part of the NS record set of <em>Child Zone</em>.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is tested and reported by
[CONNECTIVITY01]. This Test Case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server, except if the name server is listed in the
SOA MNAME.</p>
<p>The syntax of the SOA MNAME for <em>Child Zone</em> is not tested in
this Test Case, see [SYNTAX07].</p>
<p>The consistency of the SOA MNAME between different servers of
<em>Child Zone</em> is not tested by this Test Case, see
[CONSISTENCY06].</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4 id="summary">Summary</h4>
<table>
<colgroup>
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 23%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Message ID for message tag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_HAS_LOCALHOST_ADDR</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">nsname, ns_ip</td>
<td style="text-align: left;">SOA MNAME name server “{nsname}” resolves
to a localhost IP address ({ns_ip}).</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z01_MNAME_IS_DOT</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">SOA MNAME is specified as “.” which
usually means “no server”. Fetched from name servers
“{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_IS_LOCALHOST</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">SOA MNAME name server is “localhost”,
which is invalid. Fetched from name servers “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z01_MNAME_IS_MASTER</td>
<td style="text-align: left;">DEBUG</td>
<td style="text-align: left;">ns_list</td>
<td style="text-align: left;">SOA MNAME name server(s) “{ns_list}”
appears to be master.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_MISSING_SOA_RECORD</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">SOA MNAME name server “{ns}” reponds to an
SOA query with no SOA records in the answer section.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z01_MNAME_NO_RESPONSE</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">SOA MNAME name server “{ns}” does not
respond to an SOA query.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_NOT_AUTHORITATIVE</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns</td>
<td style="text-align: left;">SOA MNAME name server “{ns}” is not
authoritative for the zone.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z01_MNAME_NOT_IN_NS_LIST</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">nsname</td>
<td style="text-align: left;">SOA MNAME name server “{nsname}” is not
listed as NS record for the zone.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_NOT_MASTER</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_list, soaserial, soaserial_list</td>
<td style="text-align: left;">SOA MNAME name server(s) “{ns_list}”
do(es) not have the highest SOA SERIAL (expected “{soaserial}” but got
“{soaserial_list}”)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Z01_MNAME_NOT_RESOLVE</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">nsname</td>
<td style="text-align: left;">SOA MNAME name server “{nsname}” cannot be
resolved into an IP address.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Z01_MNAME_UNEXPECTED_RCODE</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns, rcode</td>
<td style="text-align: left;">SOA MNAME name server “{ns}” gives
unexpected RCODE name (“{rcode}”) in response to an SOA query.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument
list].</p>
<h4 id="test-procedure">Test procedure</h4>
<p>In this section and unless otherwise specified below, the terms “[DNS
Query]” follow the specification for DNS queries as specified in [DNS
Query and Response Defaults]. The handling of the DNS responses on the
DNS queries follow, unless otherwise specified below, what is specified
for [DNS Response] in the same specification.</p>
<ol type="1">
<li><p>Create a [DNS Query] with query type SOA and query name <em>Child
Zone</em> (“SOA Query”).</p></li>
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server SOA MNAME name, SOA MNAME IP address(es), SOA SERIAL(s)
(“MNAME Nameservers”)</li>
<li>Name server SOA SERIAL (“SERIAL Nameservers”)</li>
<li>Name server SOA MNAME name, SOA MNAME IP address, SOA SERIAL (“MNAME
Not Master”)</li>
<li>Name server SOA MNAME name, SOA MNAME IP address (“MNAME Is
Master”)</li>
<li>Name server IP address (“MNAME Is Localhost”)</li>
<li>Name server IP address (“MNAME Is Dot”)</li>
</ol></li>
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“Name Server IP”).</p></li>
<li><p>For each name server IP address in <em>Name Server IP</em>
do:</p>
<ol type="1">
<li>Send <em>SOA Query</em> to the name server IP and collect the
response.</li>
<li>Go to next name server IP address if at least one of the following
criteria is met:
<ol type="1">
<li>There is no DNS response.</li>
<li>[RCODE Name] of the response is not “NoError”.</li>
<li>The AA flag is not set in the response.</li>
<li>There is no SOA record with owner name matching the query.</li>
</ol></li>
<li>From the DNS response, extract the name server name from the SOA
MNAME field:
<ol type="1">
<li>If the name is “localhost”, then add name server IP address to the
<em>MNAME Is Localhost</em> set.</li>
<li>Else if the name is “.”, then add name server IP address to the
<em>MNAME Is Dot</em> set.</li>
<li>Else, add SOA MNAME name server name to the <em>MNAME
Nameservers</em> set.</li>
</ol></li>
<li>From the SOA record in the DNS response, extract the value from the
SOA SERIAL field and add it to the <em>SERIAL Nameservers</em> set.</li>
<li>Go to next name server IP address.</li>
</ol></li>
<li><p>If the set <em>MNAME Is Localhost</em> is non-empty, then output
<em>[Z01_MNAME_IS_LOCALHOST]</em> with name server(s) IP
address(es).</p></li>
<li><p>If the set <em>MNAME Is Dot</em> is non-empty, then output
<em>[Z01_MNAME_IS_DOT]</em> with name server(s) IP address(es).</p></li>
<li><p>If the set <em>MNAME Nameservers</em> is empty, then terminate
these procedures.</p></li>
<li><p>Obtain the set of name server names using [Method3] (“Child
Nameservers”).</p></li>
<li><p>For each SOA MNAME name server name in <em>MNAME Nameservers</em>
do:</p>
<ol type="1">
<li>If the SOA MNAME name server name is not part of the <em>Child
Nameservers</em> set, then output <em>[Z01_MNAME_NOT_IN_NS_LIST]</em>
with SOA MNAME name server name.</li>
<li>Do a [DNS Lookup] of SOA MNAME name server name (A and AAAA) and add
the SOA MNAME name server IP address(es) found to the <em>MNAME
Nameservers</em> set for the same entry as the SOA MNAME name server
name.</li>
<li>If at least one IP address from the previous step was found, then:
<ol type="1">
<li>For each SOA MNAME name server IP address for the SOA MNAME name
server name do:
<ol type="1">
<li>If the IP address is a localhost address (127.0.0.1 or ::1), then
output <em>[Z01_MNAME_HAS_LOCALHOST_ADDR]</em> with SOA MNAME name
server name and IP.</li>
<li>Else, send <em>SOA Query</em> to the name server IP and collect the
response.
<ol type="1">
<li>If there is a DNS response, with [RCODE Name] “NoError” and an SOA
record in the answer section, then:
<ol type="1">
<li>If the AA flag is not set, then output
<em>[Z01_MNAME_NOT_AUTHORITATIVE]</em> with SOA MNAME name server name
and IP address.</li>
<li>Else, add the SOA SERIAL value to the <em>MNAME Nameservers</em> set
for the SOA MNAME name server name and IP pair.</li>
</ol></li>
<li>Else if [RCODE Name] is not “NoError”, then output
<em>[Z01_MNAME_UNEXPECTED_RCODE]</em> with [RCODE Name], SOA MNAME name
server name and IP address.</li>
<li>Else if there is no SOA record in the answer section, then output
<em>[Z01_MNAME_MISSING_SOA_RECORD]</em> with SOA MNAME name server name
and IP address.</li>
<li>Else, output <em>[Z01_MNAME_NO_RESPONSE]</em> with SOA MNAME name
server name and IP address.</li>
</ol></li>
<li>Go to next SOA MNAME name server IP.</li>
</ol></li>
</ol></li>
<li>Else, output <em>[Z01_MNAME_NOT_RESOLVE]</em> with SOA MNAME name
server name.</li>
<li>Go to next SOA MNAME name server name.</li>
</ol></li>
<li><p>If there is no SOA SERIAL in the <em>MNAME Nameservers</em> set,
then terminate these procedures.</p></li>
<li><p>For each SOA SERIAL (per SOA MNAME name server name and IP
address pair) in <em>MNAME Nameservers</em> do:</p>
<ol type="1">
<li>For each SOA SERIAL in <em>SERIAL Nameservers</em> do:
<ol type="1">
<li>Compare both SOA SERIAL values (using the arithmetic in
[RFC1982]).</li>
<li>If the one from <em>SERIAL Nameservers</em> is higher, then add SOA
MNAME name server name, IP address and SOA SERIAL of the current SOA
SERIAL value from the <em>MNAME Nameservers</em> set to the <em>MNAME
Not Master</em> set, and go to next SOA SERIAL (from the <em>MNAME
Nameservers</em> set).</li>
</ol></li>
<li>Add SOA MNAME name server name and IP address to the <em>MNAME Is
Master</em> set.</li>
</ol></li>
<li><p>If the set <em>MNAME Not Master</em> is non-empty, then output
<em>[Z01_MNAME_NOT_MASTER]</em> with SOA MNAME name server name(s), IP
address(es) and SOA SERIAL from the set, along with the SOA SERIAL
values from the <em>SERIAL Nameservers</em> set.</p></li>
<li><p>If the set <em>MNAME Is Master</em> is non-empty, then output
<em>[Z01_MNAME_IS_MASTER]</em> with SOA MNAME name server name(s) and IP
address(es) from the set.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, skip sending queries
over that transport protocol. A message will be outputted reporting that
the transport protocol has been skipped.</p>
<h4 id="terminology">Terminology</h4>
<ul>
<li>“DNS Lookup” - The term is used when a recursive lookup is used,
though any changes to the DNS tree introduced by an [undelegated test]
must be respected.</li>
</ul>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone02"></a><h3>5.36. dns-zone02 - Verify SOA &#39;refresh&#39; minimum value</h3><h4>Description</h4><div class="markdown-content"><p>The SOA refresh value is the number of seconds that describes how
often a secondary name server will poll the primary name server to see
if there is any updates. The SOA refresh value is described in section
3.3.13 in <a href="https://datatracker.ietf.org/doc/html/rfc1035">RFC
1035</a>, and clarified in section 2.2 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>.
Setting the refresh value low will increase the DNS traffic between the
servers, and also increase the load on the master name server. The
primary name server will in most cases send DNS notifications to tell
the secondary name servers that zone content has been updated, as
described in <a href="https://datatracker.ietf.org/doc/html/rfc1996">RFC
1996</a>.</p>
<p>The <a
href="https://www.ripe.net/publications/docs/ripe-203">RIPE-203</a>
recommendation for the refresh value is 24 hours (86400 seconds). Older
DNSCheck code had a four hour minimum value, and this is the minimum
value we recommend.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from a delegated name server for the
domain.</li>
<li>If the answer from step 1 is not authoritative, iterate step 1 until
there is an authoritative answer.</li>
<li>Retrieve the refresh value from the SOA record.</li>
<li>If the refresh value is less than 14400 (four hours in seconds) this
test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the SOA refresh value is less than 14400 this test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone03"></a><h3>5.37. dns-zone03 - Verify SOA &#39;retry&#39; value is lower than SOA &#39;refresh&#39; value</h3><h4>Description</h4><div class="markdown-content"><p>The SOA retry value is the number of seconds that describes minimum
time elapsed since a failed zone refresh from the primary name server.
The SOA refresh value is described in section 3.3.13 in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>, and
clarified in section 2.2 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>.</p>
<blockquote>
<p>It’s typically some fraction of the refresh interval.</p>
</blockquote>
<p>Setting the retry value low will increase the DNS traffic between the
servers, and also increase the load on the master name server.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from a delegated name server for the
domain.</li>
<li>If the answer from step 1 is not authoritative, iterate step 1 until
there is an authoritative answer.</li>
<li>Retrieve the retry value from the SOA record.</li>
<li>If the retry value is higher than or equal to the refresh value,
this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the SOA retry value is higher than or equal to the refresh value,
this test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone04"></a><h3>5.38. dns-zone04 - Verify SOA &#39;retry&#39; minimum value</h3><h4>Description</h4><div class="markdown-content"><p>The SOA retry value is the number of seconds that describes minimum
time elapsed since a failed zone refresh from the primary name server.
The SOA refresh value is described in section 3.3.13 in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>, and
clarified in section 2.2 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>.</p>
<p>Setting the retry value low will increase the DNS traffic between the
servers, and also increase the load on the master name server.</p>
<p>The <a
href="https://www.ripe.net/publications/docs/ripe-203">RIPE-203</a>
recommendation for the retry value is 2 hours (7200 seconds). Older
DNSCheck code had a one hour minimum value (3600 seconds), and this is
the minimum value we recommend.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from a delegated name server for the
domain.</li>
<li>If the answer from step 1 is not authoritative, iterate step 1 until
there is an authoritative answer.</li>
<li>Retrieve the retry value from the SOA record.</li>
<li>If the retry value is less than 3600 seconds, this test case
fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the retry value is less than 3600 seconds, this test case
fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone05"></a><h3>5.39. dns-zone05 - Verify SOA &#39;expire&#39; minimum value</h3><h4>Description</h4><div class="markdown-content"><p>The SOA expire value specifies for how long any secondary name server
keeps the zone valid without any contact with the primary name server.
This value should be greater than how long a major outage would
typically last. The expire value should also be larger than the refresh
and retry values, as described in section 3.3.13 in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>, and
clarified in section 2.2 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>.</p>
<p>Setting the expire value low will increase the risk of any unwanted
non-availability of the zone because of any failures in contacting the
primary name server.</p>
<p>The <a
href="https://www.ripe.net/publications/docs/ripe-203">RIPE-203</a>
recommendation for the expire value is 1000 hours (roughly 41 days).
Older DNSCheck code had a 7 day minimum value (604800 seconds), and this
is the minimum value we recommend as an absolut minimum.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from a delegated name server for the
domain.</li>
<li>If the answer from step 1 is not authoritative, iterate step 1 until
there is an authoritative answer.</li>
<li>Retrieve the expire value and the refresh value from the SOA
record.</li>
<li>If the expire value is less than 604800 seconds (7 days), this test
case fails.</li>
<li>If the expire value is lower than the refresh value, this test case
fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the expire value is less than 604800 seconds or if the expire
value is lower than the refresh value, this test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone06"></a><h3>5.40. dns-zone06 - Verify SOA &#39;minimum&#39; (default TTL) value</h3><h4>Description</h4><div class="markdown-content"><p>The SOA minimum field sets the default TTL for all records in a zone.
The recommended value is to be “cache-friendly”. However, for a zone
that changes content often, there is a need to keep the TTL values
shorter. The use of the SOA minimum value today is the negative cache
(where a resolver find content is missing).</p>
<p>The SOA minimum field is described in section 3.3.13 in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>, and
clarified in section 2.2 of <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>. The
description of the implementation of negative caching is in <a
href="https://datatracker.ietf.org/doc/html/rfc2308">RFC 2308</a>
(although it has been updated by several DNSSEC related RFCs, it is
still relevant for this purpose).</p>
<p>The <a
href="https://www.ripe.net/publications/docs/ripe-203">RIPE-203</a>
recommendation for the minimum value 2 days, but the negative caching is
now the norm. DNSCheck has a recommended value of between 300 seconds (5
minutes) and 86400 seconds (1 day).</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain a set of name server IP addresses using [Method4] and
[Method5].</li>
<li>Create a SOA query for the zone.</li>
<li>Send the SOA query over UDP to each name server IP address until a
response is received or until the set is exhausted.</li>
<li>If the answer from step 3 is not authoritative, iterate step 3 until
there is an authoritative answer.</li>
<li>Retrieve the SOA minimum value from the SOA record.</li>
<li>If the minimum value is larger than 86400 seconds (1 day), this test
case fails.</li>
<li>If the minimum value is lower than 300 seconds (5 minutes), this
test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the minimum value is larger than 86400 seconds or if the minimum
value is lower than 300 seconds, this test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone07"></a><h3>5.41. dns-zone07 - Verify that SOA master is not an alias (CNAME)</h3><h4>Description</h4><div class="markdown-content"><p>Any NS type record should not be a CNAME. The SOA MNAME should in
this respect not be a CNAME.</p>
<p>Quote from 2.4 in <a
href="https://datatracker.ietf.org/doc/html/rfc1912">RFC 1912</a>:</p>
<blockquote>
<p>Having NS records pointing to a CNAME is bad and may conflict badly
with current BIND servers.</p>
</blockquote>
<p>The SOA MNAME field is described in section 3.3.13 in <a
href="https://datatracker.ietf.org/doc/html/rfc1035">RFC 1035</a>.</p>
<p>The <a
href="https://www.ripe.net/publications/docs/ripe-203">RIPE-203</a>
recommendation for the minimum value 2 days, but the negative caching is
now the norm. DNSCheck has a recommended value of between 300 seconds (5
minutes) and 86400 seconds (1 day).</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Retrieve the SOA record from a delegated name server for the
domain.</li>
<li>If the answer from step 1 is not authoritative, iterate step 1 until
there is an authoritative answer.</li>
<li>Retrieve the SOA MNAME value from the SOA record.</li>
<li>Query for A and AAAA records for the host from MNAME.</li>
<li>If the answer to the query is a CNAME, this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If the SOA MNAME field is pointing to a CNAME, this test case
fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dns-zone10"></a><h3>5.42. dns-zone10 - Verify that the zone of the domain to be tested return exactly one SOA record</h3><h4>Description</h4><div class="markdown-content"><p>The SOA record is crucial for the DNS zone and “exactly one SOA RR
should be present at the top of the zone” ([RFC 1035][RFC 1035#5.2],
section 5.2). This test case will verify that the zone of the domain to
be tested return exactly one SOA record. ## Scope</p>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers. ## Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested. ## Ordered description
of steps to be taken to execute the test case</li>
</ul>
<ol type="1">
<li><p>Obtain the set of name server IP addresses using [Method4] and
[Method5] (“NS IP”).</p></li>
<li><p>Create a SOA query for the apex of the <em>Child Zone</em> with
RD flag unset.</p></li>
<li><p>For each name server in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send the SOA query over UDP to the name server.</li>
<li>If the name server does not respond with a DNS response, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Else, if the DNS response does not include a SOA record in the
answer section, then output <em>[NO_SOA_IN_RESPONSE]</em>.</li>
<li>Else, if the SOA record or records in the answer section do not have
<em>Child Zone</em> as owner name, then output
<em>[WRONG_SOA]</em>.</li>
<li>Else, if the DNS response includes multiple SOA records in the
answer section, then output <em>[MULTIPLE_SOA]</em>.</li>
</ol></li>
<li><p>If no message is outputted for any server, then output
<em>[ONE_SOA]</em>. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MULTIPLE_SOA</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NO_SOA_IN_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">ONE_SOA</td>
<td style="text-align: left;">INFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WRONG_SOA</td>
<td style="text-align: left;">DEBUG</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<h4 id="terminology">Terminology</h4>
<p>When the term “using Method” is used, names and IP addresses are
fetched using the defined [Methods].</p>
<p>The term “send” (to an IP address) is used when a DNS query is sent
to a specific name server.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNS">Authoritative DNS</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-01"></a><h3>5.43. dnssec-01 - Verifies that all DS records have digest types registered with IANA</h3><h4>Description</h4><div class="markdown-content"><p>The list of allowed Digest Algorithms in a DS record published by the
parent is specified by [RFC 8624][RFC 8624#3.3], section 3.3, and is
published in the [IANA registry][IANA registry on DS Digest Algorithm]
of <em>DS RR Type Digest Algorithms</em>. No DS Digest Algorithm values,
other than those specified in the RFC and allocated by IANA, should be
used in public DNS.</p>
<p>If [RFC 8624][RFC 8624#3.3] and the [IANA registry][IANA registry on
DS Digest Algorithm] disagree on the same DS digest algorithm, the RFC
takes precedence until the registry has a been updated with a reference
to the RFC.</p>
<p>The table of algorithms below is for reference only and is copied
from [IANA registry][IANA registry on DS Digest Algorithm]. It is here
to make it easier to read the steps when symbolic names are given. This
is only an excerpt from the table. The full table is available at the
IANA registry.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Algorithm number</th>
<th style="text-align: left;">Algorithm (or description)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">SHA-1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">SHA-256</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">GOST R 34.11-94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">SHA-384</td>
</tr>
<tr class="even">
<td style="text-align: left;">5-255</td>
<td style="text-align: left;">(Unassigned)</td>
</tr>
</tbody>
</table>
<p>This test case will verify that the Zonemaster implementation has
support for the DS digest algorithm of the DS record found, and if not
output a message tag. If the support is missing other test cases will
not be able to verify that DS record. ## Scope</p>
<p>This test case will query the name servers of the parent zone, and
will just ignore non-responsive name servers or name servers not giving
a correct DNS response for an authoritative name server.</p>
<p>If no DS record is found in the parent zone then this test case will
be terminated without outputting any message tag.</p>
<p>This test case does not report if the parent servers give
inconsistent responses.</p>
<p>If the <em>Child Zone</em> is the root zone, then it has no parent
zone, and no DS records can be fetch. ## Inputs</p>
<ul>
<li><p>“Child Zone” - The domain name to be tested.</p></li>
<li><p>“Algorithm Status” - The status of all DS digest algorithms from
[RFC 8624][RFC 8624#3.3] and the [IANA registry][IANA registry on DS
Digest Algorithm].</p></li>
<li><p>“Test Type” - The test type with value “undelegated” or
“normal”.</p></li>
<li><p>“Undelegated DS” - The DS record or records submitted, undefined
unless <em>Test Type</em> is undelegated and empty if no DS record has
been submitted. ## Summary</p></li>
<li><p>At least one DS record must be found, or no further investigation
will be done and no messages will be outputted.</p></li>
<li><p>No messages will be outputted due to errors in the responses from
the parent name servers.</p></li>
</ul>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 7%" />
<col style="width: 33%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS01_DIGEST_NOT_SUPPORTED_BY_ZM</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">DS Digest cannot be validated by this
installation of Zonemaster.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS01_DS_ALGO_DEPRECATED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">The DS digest algorithm is
deprecated.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS01_DS_ALGO_2_MISSING</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">DS created with algo 2 (SHA-256) is
missing.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS01_DS_ALGO_NOT_DS</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">The DS digest algorithm is not for
DS.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS01_DS_ALGO_RESERVED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">No DS digest algorithm defined for the
digest code.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be overridden in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<p>In this section and unless otherwise specified below, the term
“[DNSSEC Query]” follows the specification for DNS queries as specified
in [DNS Query and Response Defaults]. The handling of the DNS responses
on the DNS queries follow, unless otherwise specified below, what is
specified for [DNSSEC Response] in the same specification.</p>
<ol type="1">
<li><p>If the <em>Test Type</em> is “[undelegated]” do:</p>
<ol type="1">
<li><p>If <em>Undelegated DS</em> is empty then do terminate the test
procedure.</p></li>
<li><p>Else, for each DS record in <em>Undelegated DS</em> do:</p>
<ol type="1">
<li><p>Extract the digest algorithm code and key tag from the DS record
(“Digest Code” and “Key Tag”, respectively).</p></li>
<li><p>If <em>Digest Code</em> is 0 then output
<em>[DS01_DS_ALGO_NOT_DS]</em> with <em>Digest Code</em> and <em>Key
Tag</em>. Set IP address as “-”.</p></li>
<li><p>If <em>Digest Code</em> is 1 or 3 then output
<em>[DS01_DS_ALGO_DEPRECATED]</em> with <em>Digest Code</em> and <em>Key
Tag</em>. Set IP address as “-”.</p></li>
<li><p>If <em>Digest Code</em> is 5-255 then output
<em>[DS01_DS_ALGO_RESERVED]</em> with <em>Digest Code</em> and <em>Key
tag</em>. Set IP address as “-”.</p></li>
<li><p>Verify if the Zonemaster implementation can create a digest of
any valid DNSKEY record using <em>Digest Code</em>. If the verification
fails output <em>[DS01_DIGEST_NOT_SUPPORTED_BY_ZM]</em> with <em>Digest
Code</em> and <em>Key tag</em>. Set IP address as “-”.</p></li>
</ol></li>
<li><p>If none of the DS records has digest algorithm value 2 output
<em>[DS01_DS_ALGO_2_MISSING]</em>.</p></li>
<li><p>Terminate the test procedure.</p></li>
</ol></li>
<li><p>From here the test procedure is for normal test, not
undelegated.</p></li>
<li><p>If <em>Child Zone</em> is the root zone (“.”) then terminate the
test procedure.</p></li>
<li><p>Create the following empty set:</p>
<ol type="1">
<li>Name server IP, key tag from DS record and digest algorithm code
(“DS Records”).</li>
</ol></li>
<li><p>Create a [DNSSEC Query] with query type DS and query name
<em>Child Zone</em> (“DS Query”).</p></li>
<li><p>Retrieve all name server IP addresses for the parent zone of
<em>Child Zone</em> using [Method1] (store as “Parent NS IP”).</p></li>
<li><p>For each parent name server in <em>Parent NS IP</em> do:</p>
<ol type="1">
<li>Send <em>DS Query</em> to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
parent name server:
<ol type="1">
<li>There is no [DNSSEC Response].</li>
<li>The RCODE in the [DNSSEC Response] is not “NoError” ([IANA RCODE
List]).</li>
<li>The OPT record is absent in the [DNSSEC Response].</li>
<li>The DO flag is unset in the [DNSSEC Response].</li>
<li>The AA flag is not set in the [DNSSEC Response].</li>
<li>There is no DS record with matching owner name in the answer section
of the [DNSSEC Response].</li>
</ol></li>
<li>Retrieve the DS records from the [DNSSEC Response] and add name
sever IP, key tag from the DS record and the digest algorithm code from
the DS record to the <em>DS Records</em> set.</li>
</ol></li>
<li><p>If the <em>DS Records</em> set is empty terminate the test
procedure.</p></li>
<li><p>For each subset in <em>DS Records</em> where both DS digest code
(“Digest Code”) and key tag (“Key Tag”) are identical for all subset
elements do:</p>
<ol type="1">
<li>If <em>Digest Code</em> is 0 then output
<em>[DS01_DS_ALGO_NOT_DS]</em> with <em>Digest Code</em>, <em>Key
Tag</em> and list of name server IP addresses.</li>
<li>If <em>Digest Code</em> is 1 or 3 then output
<em>[DS01_DS_ALGO_DEPRECATED]</em> with <em>Digest Code</em>, <em>Key
Tag</em> and list of name server IP addresses.</li>
<li>If <em>Digest Code</em> is 5-255 then output
<em>[DS01_DS_ALGO_RESERVED]</em> with <em>Digest Code</em>, <em>Key
Tag</em> and list of name server IP addresses.</li>
<li>Verify that the Zonemaster implementation can create a digest of any
valid DNSKEY record using <em>Digest Code</em>. If the verification
fails output <em>[DS01_DIGEST_NOT_SUPPORTED_BY_ZM]</em> with <em>Digest
Code</em>, <em>Key Tag</em> and list of name server IP addresses.</li>
</ol></li>
<li><p>If none of the elements in <em>DS Records</em> has digest
algorithm value 2 output <em>[DS01_DS_ALGO_2_MISSING]</em>. ##
Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-02"></a><h3>5.44. dnssec-02 - Verifies that all DS records have a matching DNSKEY</h3><h4>Description</h4><div class="markdown-content"><p>DNS delegations from a parent to a child are secured with DNSSEC by
publishing one or several Delegation Signer (DS) records in the parent
zone, along with the NS records for the delegation.</p>
<p>For the secure delegation to work, at least one DS record must match
a DNSKEY record in the child zone ([RFC 4035][RFC 4035#section-5],
section 5). Each DS record should match a DNSKEY record in the child
zone. More than one DS may match the same DNSKEY. The DNSKEY that the DS
record refer to must be used to sign the DNSKEY RRset in the child zone
([RFC 4035][RFC 4035#section-5], section 5).</p>
<p>The DNSKEY record that the DS record refer to must have bit 7 (“Zone
Key flag”) set in the DNSKEY RR Flags ([RFC 4034][RFC 4034#section-5.2],
section 5.2).</p>
<p>Bit 15 (“Secure Entry Point flag”) on a DNSKEY record signals that it
is meant to be a KSK and pointed out by a DS record. It is noted if the
DNSKEY record that the DS points at does not have that flag set ([RFC
4034][RFC 4034#section-2.1.1], section 2.1.1).</p>
<h4 id="scope">Scope</h4>
<p>This test case will just ignore non-responsive name servers or name
servers not giving a correct DNS response for an authoritative name
server (handled by [Connectivity01]).</p>
<p>If no DS record is found in the parent zone or no DNSKEY record is
found in the <em>Child Zone</em> then this test case will be terminated
(also see [DNSSEC11]).</p>
<p>This test case does not report if the parent servers are unresponsive
or inconsistent. ## Inputs</p>
<ul>
<li><p>“Child Zone” - The domain name to be tested.</p></li>
<li><p>“Test Type” - The test type with value “undelegated” or
“normal”.</p></li>
<li><p>“Undelegated DS” - The DS record or records submitted (only if
<em>Test Type</em> is [undelegated]). ## Summary</p></li>
<li><p>Both DS record and DNSKEY record must be found, or else no
further investigation will be done and no messages will be
outputted.</p></li>
<li><p>No messages will be outputted due to errors in the responses from
the parent name servers.</p></li>
</ul>
<table>
<colgroup>
<col style="width: 22%" />
<col style="width: 5%" />
<col style="width: 25%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS02_ALGO_NOT_SUPPORTED_BY_ZM</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">DNSKEY with tag {keytag} uses unsupported
algorithm {algo_num} ({algo_mnemo}) by this installation of Zonemaster.
Fetched from the nameservers with IP addresses “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS02_DNSKEY_NOT_FOR_ZONE_SIGNING</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">Flags field of DNSKEY record with tag
{keytag} does not have ZONE bit set although DS with same tag is present
in parent. Fetched from the nameservers with IP addresses
“{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS02_DNSKEY_NOT_SEP</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">Flags field of DNSKEY record with tag
{keytag} does not have SEP bit set although DS with same tag is present
in parent. Fetched from the nameservers with IP addresses
“{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS02_DNSKEY_NOT_SIGNED_BY_ANY_DS</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">The DNSKEY RRset has not been signed by
any DNSKEY matched by a DS record. Fetched from the nameservers with IP
addresses “{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS02_NO_DNSKEY_FOR_DS</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">The DNSKEY record with tag {keytag} that
the DS refers to does not exist in the DNSKEY RRset. Fetched from the
nameservers with IP “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS02_NO_MATCHING_DNSKEY_RRSIG</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">The DNSKEY RRset is not signed by the
DNSKEY with tag {keytag} that the DS record refers to. Fetched from the
nameservers with IP “{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS02_NO_MATCH_DS_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">The DS record does not match the DNSKEY
with tag {keytag} by algorithm or digest. Fetched from the nameservers
with IP “{ns_ip_list}”.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS02_NO_VALID_DNSKEY_FOR_ANY_DS</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">There is no valid DNSKEY matched by any of
the DS records. Fetched from the nameservers with IP addresses
“{ns_ip_list}”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS02_RRSIG_NOT_VALID_BY_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">The DNSKEY RRset is signed with an RRSIG
with tag {keytag} which cannot be validated by the matching DNSKEY.
Fetched from the nameservers with IP addresses “{ns_ip_list}”.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be overridden in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<p>In this section and unless otherwise specified below, the term
“[DNSSEC Query]” follows the specification for DNS queries as specified
in [DNS Query and Response Defaults]. The handling of the DNS responses
on the DNS queries follow, unless otherwise specified below, what is
specified for [DNSSEC Response] in the same specification.</p>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>DS record RDATA (“DS Record”).</li>
<li>Name server IP and key tag from DS record (“No DNSKEY for DS”).</li>
<li>Name server IP and key tag from DS record (“No Match DS
DNSKEY”).</li>
<li>Name server IP and DNSKEY record key tag (“DNSKEY Not for Zone
Signing”).</li>
<li>Name server IP and DNSKEY record key tag (“DNSKEY not SEP”).</li>
<li>Name server IP and DNSKEY record key tag (“No Matching DNSKEY
RRSIG”).</li>
<li>Name server IP address, DNSKEY record key tag and DNSKEY algorithm
code (“Algo Not Supported By ZM”).</li>
<li>Name server IP and key tag from RRSIG record (“RRSIG Not Valid by
DNSKEY”).</li>
<li>Name server IP (“Responding Child Name Servers”).</li>
<li>DNSKEY record and key tag (“DNSKEY Matching DS”).</li>
<li>Name server IP (“Has DNSKEY Match DS”).</li>
<li>Name server IP (“Has DNSKEY RRSIG Match DS”).</li>
</ol></li>
<li><p>If the <em>Test Type</em> is “[undelegated]” do:</p>
<ol type="1">
<li>If <em>Undelegated DS</em> is empty then do terminate this test
case.</li>
<li>Else add <em>Undelegated DS</em> as DS records to the <em>DS
Record</em> set.</li>
</ol></li>
<li><p>If <em>Test Type</em> is “normal”, then:</p>
<ol type="1">
<li>Create a [DNSSEC Query] with query type DS and query name <em>Child
Zone</em> (“DS Query”).</li>
<li>Retrieve all name server IP addresses for the parent zone of
<em>Child Zone</em> using [Method1] (store as “Parent NS IP”).</li>
<li>For each parent name server in <em>Parent NS IP</em> do:
<ol type="1">
<li>Send <em>DS Query</em> to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
parent name server:
<ol type="1">
<li>There is no [DNSSEC Response].</li>
<li>The RCODE in the [DNSSEC Response] is not “NoError” ([IANA RCODE
List]).</li>
<li>The OPT record is absent in the [DNSSEC Response].</li>
<li>The DO flag is unset in the [DNSSEC Response].</li>
<li>The AA flag is not set in the [DNSSEC Response].</li>
<li>There is no DS record with matching owner name in the answer section
of the [DNSSEC Response].</li>
</ol></li>
<li>Retrieve the DS records from the [DNSSEC Response] and add them to
the <em>DS Record</em> set.</li>
</ol></li>
<li>If the <em>DS Record</em> set is empty exit this test case.</li>
</ol></li>
<li><p>Create a [DNSSEC Query] with query type DNSKEY and query name
<em>Child Zone</em> (“DNSKEY Query”).</p></li>
<li><p>Obtain the set of child name server IP addresses using [Method4]
and [Method5] (store as “Child NS IP”).</p></li>
<li><p>For each child name server in <em>Child NS IP</em> do:</p>
<ol type="1">
<li>Send <em>DNSKEY Query</em> to the name server IP and collect the
response.</li>
<li>If at least one of the following criteria is met, then go to next
child name server:
<ol type="1">
<li>There is no [DNSSEC Response].</li>
<li>The RCODE in the [DNSSEC Response] is not “NoError” ([IANA RCODE
List]).</li>
<li>The OPT record is absent in the [DNSSEC Response].</li>
<li>The DO flag is unset in the [DNSSEC Response].</li>
<li>The AA flag is not set in the [DNSSEC Response].</li>
<li>There is no DNSKEY record with matching owner name in the answer
section of the [DNSSEC Response].</li>
</ol></li>
<li>Add the name server IP address to the <em>Responding Child Name
Servers</em> set.</li>
<li>Retrieve the DNSKEY RRset (store as “DNSKEY RRs”) from the [DNSSEC
Response].</li>
<li>Retrieve the RRSIG records covering the DNSKEY RRset, possibly none
(store as “DNSKEY RRSIG”) from the [DNSSEC Response].</li>
<li>Empty the <em>DNSKEY Matching DS</em> set.</li>
<li>For each DS in <em>DS Records</em>, do:
<ol type="1">
<li>Find the equivalent DNSKEY in <em>DNSKEY RRs</em> by key ID (key
tag). If there is more than one such DNSKEY, select the correct
one.</li>
<li>If matching DNSKEY is not found add DS key tag and name server IP to
the <em>No DNSKEY for DS</em> set and go to next DS.</li>
<li>Verify if the Zonemaster installation has support for the digest
algorithm that created the DS:
<ol type="1">
<li>If no support, then ignore the following test if the DS matches the
DNSKEY.</li>
<li>Else, if the DS values (algorithm and digest) do not match the
DNSKEY record then add DS key tag and name server IP to the <em>No Match
DS DNSKEY</em> set.</li>
</ol></li>
<li>If bit 7 of the DNSKEY flags field is unset (value 0), then do:
<ol type="1">
<li>Add DS key tag and name server IP to the <em>DNSKEY Not for Zone
Signing</em> set.</li>
<li>Go to next DS.</li>
</ol></li>
<li>If bit 15 of the DNSKEY flags field is unset (value 0), then add the
DNSKEY record key tag and name server IP to the <em>DNSKEY not SEP</em>
set.</li>
<li>Add the DNSKEY record and key tag to the <em>DNSKEY Matching DS</em>
set.</li>
<li>Add the name server IP to the <em>Has DNSKEY Match DS</em> set.</li>
</ol></li>
<li>For each DNSKEY in the <em>DNSKEY Matching DS</em> set, do:
<ol type="1">
<li>Look for an RRSIG record created by the DNSKEY in <em>DNSKEY
RRSIG</em>.
<ul>
<li>Use key ID (key tag) to identify the corresponding RRSIG
record.</li>
<li>If there is more than one such RRSIG record, select the correct one
by verifying the signature against the DNSKEY.</li>
</ul></li>
<li>If a matching RRSIG is not found, add DNSKEY record key tag and name
server IP to the <em>No Matching DNSKEY RRSIG</em> set.</li>
<li>Else, if the Zonemaster installation does not have support for the
DNSKEY algorithm that created the RRSIG, then add name server IP, DNSKEY
algorithm and DNSKEY key tag to the <em>Algo Not Supported By ZM</em>
set.</li>
<li>Else, if the RRSIG values (algorithm and signature) do not match the
DNSKEY then add the key tag from the RRSIG record and name server IP to
the <em>RRSIG Not Valid by DNSKEY</em> set.</li>
<li>Else add the name server IP address to the <em>Has DNSKEY RRSIG
Match DS</em> set.</li>
</ol></li>
</ol></li>
<li><p>If the <em>No DNSKEY for DS</em> set is non-empty, then for each
key tag from the DS record from the set output
<em>[DS02_NO_DNSKEY_FOR_DS]</em> with the key tag and the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>No Match DS DNSKEY</em> set is non-empty, then for
each key tag from the DS record from the set output
<em>[DS02_NO_MATCH_DS_DNSKEY]</em> with the key tag and the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>DNSKEY Not for Zone Signing</em> set is non-empty,
then for each DNSKEY key tag from the set output
<em>[DS02_DNSKEY_NOT_FOR_ZONE_SIGNING]</em> with the key tag and the
name servers IP addresses from the set.</p></li>
<li><p>If the <em>DNSKEY not SEP</em> set is non-empty, then for each
DNSKEY key tag from the set output <em>[DS02_DNSKEY_NOT_SEP]</em> with
the key tag and the name servers IP addresses from the set.</p></li>
<li><p>If the <em>No Matching DNSKEY RRSIG</em> set is non-empty, then
for each DNSKEY key tag from the set output
<em>[DS02_NO_MATCHING_DNSKEY_RRSIG]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>Algo Not Supported By ZM</em> set is non-empty, then
output <em>[DS02_ALGO_NOT_SUPPORTED_BY_ZM]</em> for each DNSKEY key tag
with the name server IP addresses, the key tag and the algorithm code
from the set.</p></li>
<li><p>If the <em>RRSIG Not Valid by DNSKEY</em> set is non-empty, then
for each key tag from the RRSIG record from the set output
<em>[DS02_RRSIG_NOT_VALID_BY_DNSKEY]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>Extract the name server IP addresses that are members of
<em>Responding Child Name Servers</em> but are not members of <em>Has
DNSKEY Match DS</em> set.</p></li>
<li><p>If the subset from previous step is non-empty, then output
<em>[DS02_NO_VALID_DNSKEY_FOR_ANY_DS]</em> with the subset of name
server IP addresses.</p></li>
<li><p>Else do:</p>
<ol type="1">
<li>Extract the name server IP addresses that are members of
<em>Responding Child Name Servers</em> but are not members of <em>Has
DNSKEY RRSIG Match DS</em> set.</li>
<li>If that subset is non-empty, then output
<em>[DS02_DNSKEY_NOT_SIGNED_BY_ANY_DS]</em> with the subset of name
server IP addresses. ## Outcome(s)</li>
</ol></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, skip sending queries
over that transport protocol. Output a message reporting that the
transport protocol has been disabled.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-03"></a><h3>5.45. dnssec-03 - Check iteration counts for NSEC3</h3><h4>Description</h4><div class="markdown-content"><p>For an authoritative name server an increased number of NSEC3
iterations have a negative impact on performance.</p>
<p>Section 10.3 in <a
href="https://datatracker.ietf.org/doc/html/rfc5155#section-10.3">RFC
5155</a> sets a maximum number of iterations depending on the DNSSEC key
size - regardless of which algorithm is used.</p>
<blockquote>
<p>A zone owner MUST NOT use a value higher than shown in the table
below for iterations for the given key size. A resolver MAY treat a
response with a higher value as insecure, after the validator has
verified that the signature over the NSEC3 RR is correct.</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Key Size</th>
<th style="text-align: left;">Iterations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1024</td>
<td style="text-align: left;">150</td>
</tr>
<tr class="even">
<td style="text-align: left;">2048</td>
<td style="text-align: left;">500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4096</td>
<td style="text-align: left;">2,500</td>
</tr>
</tbody>
</table>
<p>Section 5.3.2 in <a
href="https://datatracker.ietf.org/doc/html/rfc6781#section-5.3.2">RFC
6781</a> describes the consequences for an authoritative name server in
more detail, and references the <a
href="https://www.nlnetlabs.nl/downloads/publications/nsec3_hash_performance.pdf">NSEC
Hash Performance</a> study from NLNet Labs.</p>
<blockquote>
<p>Choosing a value of 100 iterations is deemed to be a sufficiently
costly, yet not excessive, value: In the worst-case scenario, the
performance of name servers would be halved, regardless of key size.</p>
</blockquote>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain a set of name server IP addresses using [Method4] and
[Method5].</li>
<li>Create an NSEC3PARAM query for the apex of the child zone.</li>
<li>Create a DNSKEY query for the apex of the child zone.</li>
<li>Send the NSEC3PARAM query over UDP to each name server IP address
until a response is received or until the set is exhausted.</li>
<li>If there is not use of NSEC3 there is no NSEC3PARAM RR in the child
zone, and this test case ends here.</li>
<li>The iterations value is extracted from the NSEC3PARAM RR.</li>
<li>If the number of iterations is higher than 100, this test case emits
at least a warning.</li>
<li>Send the DNSKEY query over UDP to each name server IP address until
a response is received or until the set is exhausted.</li>
<li>Extract the smallest key from the zone.</li>
<li>Depending on the key sizes listed in section 10.3 of RFC 5155, if
the number of iterations is larger than the corresponding key size of
the smallest key, this test case fails. ### Outcome(s)</li>
</ol>
<p>If the NSEC3 iterations value is higher than 100, this test case
gives a warning. If it is higher than the number recommended for the
corresponding key size, this test case fails.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>This test is only fully performed if the zone uses NSEC3 (has the
NSEC3PARAM RR in the zone).</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-04"></a><h3>5.46. dnssec-04 - Checks the durations of the signatures for the DNSKEY and SOA RRsets</h3><h4>Description</h4><div class="markdown-content"><p>Having RRSIG signature lifetimes last for too long opens up for DNS
replay attacks. Having too short RRSIG signature lifetimes is likely to
have a major operational impact if the master name server is down for
that long.</p>
<p>There is no clear recommendation of the exact validity periods to use
with DNSSEC. Shorter validity than 12 hours until expiration will give a
serious operational problem just in case of temporary network problems,
and longer than 180 days will create wide open holes for replay
attacks.</p>
<p>The considerations are described in <a
href="https://datatracker.ietf.org/doc/html/rfc6781">RFC6781</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>Obtain a set of name server IP addresses using [Method4] and
[Method5].</li>
<li>Create a DNSKEY query with DO flag set for the apex of the child
zone.</li>
<li>Create a SOA query with DO flag set for the apex of the child
zone.</li>
<li>Send the DNSKEY query over UDP to each name server IP address until
a response is received or until the set is exhausted.</li>
<li>Send the SOA query over UDP to each name server IP address until a
response is received or until the set is exhausted.</li>
<li>If any RRSIG validity is found where the expiration time already has
passed, this test case fails.</li>
<li>If any RRSIG validity time is shorter than 12 hours (from “now”),
this test case fails.</li>
<li>If any RRSIG validity time is longer than 180 days (from “now”),
this test fails.</li>
<li>If any RRSIG validity from inception to expiration is longer than
180 days, this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If any of the signature expirations time is either shorter than 12
hours or longer than 180 days, this test case fails.</p>
<h5 id="special-procedural-requirements">Special procedural
requirements</h5>
<p>Test case is only performed if RRSIG RRs are found in the
answers.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-05"></a><h3>5.47. dnssec-05 - Check DNSKEY algorithms</h3><h4>Description</h4><div class="markdown-content"><p>A domain name (zone) should only use DNSKEY algorithms that are
specified by [RFC 8624], section 3.1 and the [IANA registry] of
<em>DNSSEC Algorithm Numbers</em> to be used for DNSSEC signing. A
public domain name (zone) should not use private algorithms.</p>
<p>If [RFC 8624] and [IANA registry] disagree on the same algorithm, the
RFC takes precedence until the registry has a been updated with a
reference to the RFC.</p>
<p>The table of algorithms below is for reference only and is copied
from [IANA registry]. It is here to make it easier to read the steps
when symbolic names are given. This is only an excerpt from the table.
The full table is available at [IANA registry].</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Algorithm number</th>
<th style="text-align: left;">Algorithm (or description)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">(Delete DS)</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">RSA/MD5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Diffie-Hellman</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">DSA/SHA1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: left;">RSA/SHA-1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: left;">DSA-NSEC3-SHA1</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">RSASHA1-NSEC3-SHA1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">RSA/SHA-256</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: left;">RSA/SHA-512</td>
</tr>
<tr class="even">
<td style="text-align: left;">11</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;">GOST R 34.10-2001</td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;">ECDSA Curve P-256 with SHA-256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: left;">ECDSA Curve P-384 with SHA-384</td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: left;">Ed25519</td>
</tr>
<tr class="odd">
<td style="text-align: left;">16</td>
<td style="text-align: left;">Ed448</td>
</tr>
<tr class="even">
<td style="text-align: left;">17-122</td>
<td style="text-align: left;">(Unassigned)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">123-251</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
<tr class="even">
<td style="text-align: left;">252</td>
<td style="text-align: left;">(Indirect Keys)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">253</td>
<td style="text-align: left;">(Private algorithm)</td>
</tr>
<tr class="even">
<td style="text-align: left;">254</td>
<td style="text-align: left;">(Private algorithm OID)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">255</td>
<td style="text-align: left;">(Reserved)</td>
</tr>
</tbody>
</table>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>The domain name to be tested (“Child Zone”).</li>
<li>The status of all algorithms from [RFC 8624] and [IANA registry]
(“Algorithm Status”).</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for the apex of the
<em>Child Zone</em>.</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5].</p></li>
<li><p>Repeat the following steps for each name server IP address:</p>
<ol type="1">
<li>Send the DNSKEY query over UDP.</li>
<li>If no DNS response is returned, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Else if the DNS response does not contain an DNSKEY RRset, then
output <em>[NO_RESPONSE_DNSKEY]</em>.</li>
<li>Else extract the algorithm numbers from each DNSKEY record and
compare the algorithm number to <em>Algorithm Status</em>.
<ol type="1">
<li>If the algorithm is deprecated (algorithm 1, 3, 6 or 12) output
<em>[ALGORITHM_DEPRECATED]</em>.</li>
<li>If the algorithm is reserved (algorithm 4, 9, 11, 123-251 or 255),
output <em>[ALGORITHM_RESERVED]</em>.</li>
<li>If the algorithm is unassigned (algorithm 17-122), output
<em>[ALGORITHM_UNASSIGNED]</em>.</li>
<li>If the algorithm is private algorithm (algorithm 253-254), output
<em>[ALGORITHM_PRIVATE]</em>.</li>
<li>If the algorithm is not meant for zone signing (algorithm 0, 2 or
252), output <em>[ALGORITHM_NOT_ZONE_SIGN]</em>.</li>
<li>If the algorithm is not rekommended for zone signing (algorithm 5, 7
or 10), output <em>[ALGORITHM_NOT_RECOMMENDED]</em>.</li>
<li>If no message has been outputted for the DNSKEY (i.e. algorithm 8,
13, 14, 15 or 16), output <em>[ALGORITHM_OK]</em>.</li>
</ol></li>
</ol></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_DNSKEY</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALGORITHM_DEPRECATED</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALGORITHM_RESERVED</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALGORITHM_UNASSIGNED</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALGORITHM_NOT_RECOMMENDED</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALGORITHM_PRIVATE</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALGORITHM_NOT_ZONE_SIGN</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALGORITHM_OK</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
<p>The test case is only performed if some DNSKEY record is found in the
<em>Child Zone</em>.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-06"></a><h3>5.48. dnssec-06 - Check for DNSSEC extra processing at child nameservers</h3><h4>Description</h4><div class="markdown-content"><p>In order for an authoritative name server to be DNSSEC compliant, it
must serve DNSSEC signatures (RRSIG) as additional data in a DNS answer.
This additional processing is described in section 3.1 of <a
href="https://datatracker.ietf.org/doc/html/rfc4035#section-3.1">RFC
4035</a>.</p>
<h5 id="inputs">Inputs</h5>
<p>The domain name to be tested.</p>
<h5
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h5>
<ol type="1">
<li>For each name server configured for the domain:</li>
<li>Retrieve the DNSKEY RR set from the child zone.</li>
<li>If the answer from the query does contain a DNSKEY <em>and</em>
RRSIG, this test case passes.</li>
<li>If there is no DNSKEY RR or RRSIG RR in the answer and the RCODE is
NOERROR, this test case fails.</li>
</ol>
<h5 id="outcomes">Outcome(s)</h5>
<p>If any of the name servers configured for the domains fail to answer
with DNSSEC data, this test case fails.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-08"></a><h3>5.49. dnssec-08 - Check that the DNSKEY RRset is signed</h3><h4>Description</h4><div class="markdown-content"><p>A DNSSEC signed zone should have a DNSKEY RRset in the zone apex
([RFC 4035][RFC 4035#section-2.1], section 2.1) and that RRset should be
signed by a key that matches one of the records in the DNSKEY RRset
([RFC 4035][RFC 4035#section-2.2], section 2.2).</p>
<p>This test case will verify if the <em>Child Zone</em> meets that
requirement. ## Scope</p>
<p>It is assumed that <em>Child Zone</em> is tested and reported by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<p>This test case is only relevant if the zone has been DNSSEC signed.
## Inputs</p>
<ul>
<li><p>“Child Zone” - The domain name to be tested. ## Summary</p></li>
<li><p>If no DNSKEY records are found, then further investigation will
not be done and no messages will be outputted.</p></li>
</ul>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 8%" />
<col style="width: 18%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS08_ALGO_NOT_SUPPORTED_BY_ZM</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">This installation of Zonemaster does not
support the DNSKEY algorithm.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS08_DNSKEY_RRSIG_EXPIRED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">DNSKEY RRset is signed with an RRSIG that
has expired.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS08_DNSKEY_RRSIG_NOT_YET_VALID</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">DNSKEY RRset is signed with a not yet
valid RRSIG.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS08_MISSING_RRSIG_IN_RESPONSE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">DNSKEY is unsigned which is against
expectation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS08_NO_MATCHING_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">DNSKEY RRset is signed with an RRSIG that
does not match any DNSKEY.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS08_RRSIG_NOT_VALID_BY_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">DNSKEY RRset is signed with an RRSIG that
cannot be validated by the matching DNSKEY.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for <em>Child Zone</em>
(“DNSKEY Query”).</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address (“DNSKEY without RRSIG”).</li>
<li>Name server IP address and RRSIG key tag (“DNSKEY RRSIG not yet
valid”).</li>
<li>Name server IP address and RRSIG key tag (“DNSKEY RRSIG
expired”).</li>
<li>Name server IP address and RRSIG key tag (“No matching
DNSKEY”).</li>
<li>Name server IP address and RRSIG key tag (“RRSIG not valid by
DNSKEY”).</li>
<li>Name server IP address, DNSKEY record key tag and DNSKEY algorithm
code (“Algo Not Supported By ZM”).</li>
</ol></li>
<li><p>For each name server IP address in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send <em>DNSKEY Query</em> to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
name server IP:
<ol type="1">
<li>There is no DNS response.</li>
<li>The RCODE of response is not “NoError” ([IANA RCODE List]).</li>
<li>The AA flag is not set in the response.</li>
<li>There is no DNSKEY record with matching owner name in the answer
section.</li>
</ol></li>
<li>Retrieve the DNSKEY records and its RRSIG records from the answer
section.</li>
<li>If there is no RRSIG for the DNSKEY record, then add the name server
IP address to the <em>DNSKEY without RRSIG</em> set and go to next name
server IP.</li>
<li>Else, for each DNSKEY RRSIG record do:
<ol type="1">
<li>If the RRSIG record start of validity is after the time of the test,
then add name server IP and RRSIG key tag to the <em>DNSKEY RRSIG not
yet valid</em> set.</li>
<li>Else, if the RRSIG record end of validity is before the time of the
test, then add name server IP and RRSIG key tag to the <em>DNSKEY RRSIG
expired</em> set.</li>
<li>Else, if the Zonemaster installation does not have support for the
DNSKEY algorithm that created the RRSIG, then add name server IP, DNSKEY
algorithm and DNSKEY key tag to the <em>Algo Not Supported By ZM</em>
set.</li>
<li>Else, if the RRSIG does not match any DNSKEY, then add the name
server IP and the RRSIG key tag to the <em>No matching DNSKEY</em>
set.</li>
<li>Else, if the RRSIG cannot be validated by the matching DNSKEY
record, then add the name server IP and the RRSIG key tag to the
<em>RRSIG not valid by DNSKEY</em> set.</li>
</ol></li>
</ol></li>
<li><p>If the <em>DNSKEY without RRSIG</em> set is non-empty, then
output <em>[DS08_MISSING_RRSIG_IN_RESPONSE]</em> with the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>DNSKEY RRSIG not yet valid</em> set is non-empty, then
for each RRSIG key tag from the set output
<em>[DS08_DNSKEY_RRSIG_NOT_YET_VALID]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>DNSKEY RRSIG expired</em> set is non-empty, then for
each RRSIG key tag from the set output
<em>[DS08_DNSKEY_RRSIG_EXPIRED]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>No matching DNSKEY</em> set is non-empty, then for
each RRSIG key tag from the set output
<em>[DS08_NO_MATCHING_DNSKEY]</em> with the key tag and the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>RRSIG not valid by DNSKEY</em> set is non-empty, then
for each RRSIG key ID from the set output
<em>[DS08_RRSIG_NOT_VALID_BY_DNSKEY]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>Algo Not Supported By ZM</em> set is non-empty, then
output <em>[DS08_ALGO_NOT_SUPPORTED_BY_ZM]</em> for each DNSKEY key tag
with the name server IP addresses, the key tag and the algorithm name
and code from the set. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-09"></a><h3>5.50. dnssec-09 - Check that the SOA RRset is signed</h3><h4>Description</h4><div class="markdown-content"><p>If the zone is signed, the SOA RR should be signed with a valid RRSIG
using a DNSKEY from the DNSKEY RR set. This is described in [RFC
4035][RFC 4035#section-2.2], section 2.2.</p>
<p>This test case will verify if the <em>Child Zone</em> meets that
requirement. ## Scope</p>
<p>It is assumed that <em>Child Zone</em> is tested and reported by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<p>Inconsistencies in the SOA record are expected to be caught by
[Consistency01], [Consistency02], [Consistency03] and
[Consistency06].</p>
<p>Inconsistencies in the DNSKEY RRset are expected to be caught by
[DNSSEC08].</p>
<p>This test case is only relevant if the zone has been DNSSEC signed.
## Inputs</p>
<ul>
<li><p>“Child Zone” - The domain name to be tested. ## Summary</p></li>
<li><p>If no DNSKEY records are found, then further investigation will
not be done and no messages will be outputted.</p></li>
</ul>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 8%" />
<col style="width: 18%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS09_ALGO_NOT_SUPPORTED_BY_ZM</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">This installation of Zonemaster does not
support the DNSKEY algorithm.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS09_MISSING_RRSIG_IN_RESPONSE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">SOA is unsigned which is against
expectation</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS09_NO_MATCHING_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">SOA is signed with an RRSIG that does not
match any DNSKEY</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS09_RRSIG_NOT_VALID_BY_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">SOA is signed with an RRSIG that cannot be
validated by the matching DNSKEY</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS09_SOA_RRSIG_EXPIRED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">SOA is signed with an RRSIG that has
expired</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS09_SOA_RRSIG_NOT_YET_VALID</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, keytag</td>
<td style="text-align: left;">SOA is signed with a not yet valid
RRSIG</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for <em>Child Zone</em>
(“DNSKEY Query”).</p></li>
<li><p>Create an SOA query with DO flag set for <em>Child Zone</em>
(“SOA Query”).</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address (“SOA without RRSIG”).</li>
<li>Name server IP address and RRSIG key tag (“SOA RRSIG not yet
valid”).</li>
<li>Name server IP address and RRSIG key tag (“SOA RRSIG expired”).</li>
<li>Name server IP address and RRSIG key tag (“No matching
DNSKEY”).</li>
<li>Name server IP address and RRSIG key tag (“RRSIG not valid by
DNSKEY”).</li>
<li>Name server IP address, DNSKEY record key tag and DNSKEY algorithm
code (“Algo Not Supported By ZM”).</li>
</ol></li>
<li><p>For each name server IP address in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send <em>DNSKEY Query</em> to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
name server IP:
<ol type="1">
<li>There is no DNS response.</li>
<li>The RCODE of response is not “NoError” ([IANA RCODE List]).</li>
<li>The AA flag is not set in the response.</li>
<li>There is no DNSKEY record with matching owner name in the answer
section.</li>
</ol></li>
<li>Retrieve the DNSKEY records with matching owner name from the answer
section (any DNSKEY records with non-matching owner name are
ignored).</li>
<li>Send <em>SOA Query</em> over UDP to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
name server IP:
<ol type="1">
<li>There is no DNS response.</li>
<li>The RCODE of response is not “NoError” ([IANA RCODE List]).</li>
<li>The AA flag is not set in the response.</li>
<li>There is no SOA record with matching owner name in the answer
section.</li>
</ol></li>
<li>Retrieve the SOA record with matching owner name and its RRSIG
record.
<ul>
<li>Retrieve only one SOA record if there are multiple records. Any SOA
records with non-matching owner name are ignored.</li>
</ul></li>
<li>If there is no RRSIG for the SOA record, then add the name server IP
address to the <em>SOA without RRSIG</em> set and go to next name server
IP.</li>
<li>Else, for each SOA RRSIG record do:
<ol type="1">
<li>If the RRSIG record start of validity is after the time of the test,
then add name server IP and RRSIG key tag to the <em>SOA RRSIG not yet
valid</em> set.</li>
<li>Else, if the RRSIG record end of validity is before the time of the
test, then add name server IP and RRSIG key tag to the <em>SOA RRSIG
expired</em> set.</li>
<li>Else, if the Zonemaster installation does not have support for the
DNSKEY algorithm that created the RRSIG, then add name server IP, DNSKEY
algorithm and DNSKEY key tag to the <em>Algo Not Supported By ZM</em>
set.</li>
<li>Else, if the RRSIG does not match any DNSKEY, then add the name
server IP and the RRSIG key tag to the <em>No matching DNSKEY</em>
set.</li>
<li>Else, if the RRSIG cannot be validated by the matching DNSKEY
record, then add the name server IP and the RRSIG key tag to the
<em>RRSIG not valid by DNSKEY</em> set.</li>
</ol></li>
</ol></li>
<li><p>If the <em>SOA without RRSIG</em> set is non-empty, then output
<em>[DS09_MISSING_RRSIG_IN_RESPONSE]</em> with the name servers IP
addresses from the set.</p></li>
<li><p>If the <em>SOA RRSIG not yet valid</em> set is non-empty, then
for each RRSIG key tag from the set output
<em>[DS09_SOA_RRSIG_NOT_YET_VALID]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>SOA RRSIG expired</em> set is non-empty, then for each
RRSIG key tag from the set output <em>[DS09_SOA_RRSIG_EXPIRED]</em> with
the key tag and the name servers IP addresses from the set.</p></li>
<li><p>If the <em>No matching DNSKEY</em> set is non-empty, then for
each RRSIG key tag from the set output
<em>[DS09_NO_MATCHING_DNSKEY]</em> with the key tag and the name servers
IP addresses from the set.</p></li>
<li><p>If the <em>RRSIG not valid by DNSKEY</em> set is non-empty, then
for each RRSIG key ID from the set output
<em>[DS09_RRSIG_NOT_VALID_BY_DNSKEY]</em> with the key tag and the name
servers IP addresses from the set.</p></li>
<li><p>If the <em>Algo Not Supported By ZM</em> set is non-empty, then
output <em>[DS09_ALGO_NOT_SUPPORTED_BY_ZM]</em> for each DNSKEY key tag
with the name server IP addresses, the key tag and the algorithm name
and code from the set. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-10"></a><h3>5.51. dnssec-10 - Check for the presence of either NSEC or NSEC3, with proper coverage and signatures</h3><h4>Description</h4><div class="markdown-content"><p>When DNSSEC is enabled, NSEC or NSEC3 records provide a secure denial
of existence for records not present in the zone. This test case
verifies that correct NSEC or NSEC3 records with valid signatures are
returned for a query for an non-existent name.</p>
<p>Furthermore, it is verified that the name servers for the zone are
consistent about NSEC and NSEC3, i.e. either all servers should use NSEC
or all servers should use NSEC3. It is never permitted to serve both
NSEC and NSEC3 for the same zone.</p>
<p>The use of the NSEC RR type is described in [RFC 4035][RFC
4035#section-3.1.3], section 3.1.3, and the description of the NSEC RR
itself is in [RFC 4034][RFC 4034#section-4], section 4.</p>
<p>The description of the NSEC3 RR is in [RFC 5155][RFC 5155#section-3],
section 3, and its use in the DNS response is described in [RFC
5155][RFC 5155#section-7.2], section 7.2. ## Scope</p>
<p>This test case will just ignore non-responsive name servers or name
servers not giving a correct DNS response for an authoritative name
server (covered by [Connectivity01]).</p>
<p>This test case is only relevant if the zone has been DNSSEC signed.
## Inputs</p>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
<li>“[Non-Existent Query Name]” - A name constructed by prepending
<em>Child Zone</em> with a label (e.g. “xx–zpeqz4v66tckbqkyw35k–xx”)
created by the following steps, resulting in
e.g. “xx–zpeqz4v66tckbqkyw35k–xx.exemple.com”.
<ul>
<li>Use the string “xx–” as a prefix for the label.</li>
<li>As middle part of the label, use a mixed string of 20 characters
from the set “a-z0-9”.</li>
<li>Use the string “–xx” as a suffix for the label. ## Summary</li>
</ul></li>
<li>If no DNSKEY records are found, then further investigation will not
be done and no messages will be outputted.</li>
</ul>
<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS10_ALGO_NOT_SUPPORTED_BY_ZM</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num,
keytag</td>
<td style="text-align: left;">This installation of Zonemaster does not
support the DNSKEY algorithm.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_ANSWER_VERIFY_ERROR</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, domain, rrtype</td>
<td style="text-align: left;">RRSIG on record or records in answer
section cannot be verified.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_HAS_NSEC</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Consistent NSEC returned from
servers.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_HAS_NSEC3</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">Consistent NSEC3 returned from
servers.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_INCONSISTENT_NSEC_NSEC3</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">2 ns_ip_list</td>
<td style="text-align: left;">Some servers return NSEC, others return
NSEC3.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_MISSING_NSEC_NSEC3</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Missing expected NSEC or NSEC3 in a signed
zone.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_MIXED_NSEC_NSEC3</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Both NSEC and NSEC3 are returned from the
same server.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_NAME_NOT_COVERED_BY_NSEC</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">The non-existent name is not correctly
covered by the NSEC records.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_NAME_NOT_COVERED_BY_NSEC3</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">The non-existent name is not correctly
covered by the NSEC3 records.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_NON_EXISTENT_RESPONSE_ERROR</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">No or error in response of an expected
non-existent name.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_NSEC3_MISSING_SIGNATURE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Missing signatures for NSEC3 record or
records.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_NSEC3_RRSIG_VERIFY_ERROR</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">The signature or signatures on the NSEC3
record or records cannot be correctly verfied.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_NSEC_MISSING_SIGNATURE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">Missing signatures for NSEC record or
records.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS10_NSEC_RRSIG_VERIFY_ERROR</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list</td>
<td style="text-align: left;">The signature or signatures on the NSEC
record or records cannot be correctly verfied.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS10_UNSIGNED_ANSWER</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">ns_ip_list, domain, rrtype</td>
<td style="text-align: left;">RRSIG is missing for record or records in
the answer section.</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for <em>Child Zone</em>
(“DNSKEY Query”).</p></li>
<li><p>Create an A query with DO flag set for <em>[Non-Existent Query
Name]</em> (“Non-Existent Query”).</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP, RR type and owner name (“Unsigned Answer”).</li>
<li>Name server IP, RR type and owner name(“Answer Verify Error”).</li>
<li>Name server IP address (“Has NSEC”).</li>
<li>Name server IP address (“Has NSEC3”).</li>
<li>Name server IP address (“No NSEC Or NSEC3”).</li>
<li>Name server IP address (“Mixed NSEC/NSEC3”).</li>
<li>Name server IP address (“Name Not Covered By NSEC”).</li>
<li>Name server IP address (“Name Not Covered By NSEC3”).</li>
<li>Name server IP address (“NSEC Missing Signature”).</li>
<li>Name server IP address (“NSEC3 Missing Signature”).</li>
<li>Name server IP address (“Non-Existent Response Error”).</li>
<li>Name server IP address (“NSEC RRSIG Verify Error”).</li>
<li>Name server IP address (“NSEC3 RRSIG Verify Error”).</li>
<li>Name server IP address, DNSKEY record key tag and DNSKEY algorithm
code (“Algo Not Supported By ZM”).</li>
</ol></li>
<li><p>For each name server IP address in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send <em>DNSKEY Query</em> to the name server IP.</li>
<li>If at least one of the following criteria is met, then go to next
name server IP:
<ol type="1">
<li>There is no DNS response.</li>
<li>The RCODE of response is not “NoError” ([IANA RCODE List]).</li>
<li>The AA flag is not set in the response.</li>
<li>There is no DNSKEY record with matching owner name in the answer
section.</li>
</ol></li>
<li>Retrieve the DNSKEY records from the answer section.</li>
<li>Send <em>Non-Existent Query</em> over UDP to the name server
IP.</li>
<li>If at least one of the following createria is met, then add the name
server IP to the <em>Non-Existent Response Error</em> set and go to next
name server IP:
<ol type="1">
<li>There is no DNS response.</li>
<li>The RCODE of response is neither “NoError” nor “NXDomain” ([IANA
RCODE List]).</li>
<li>The AA flag is not set in the response.</li>
</ol></li>
<li>If the following criteria are met go to next name server IP:
<ol type="1">
<li>The The RCODE of response is “NoError” ([IANA RCODE List]).</li>
<li>The answer section has an RRset of RR type “A” ([IANA RR Type List])
and either:
<ol type="1">
<li>The “A” RRset has the same owner name as the query name, or</li>
<li>There are one or more record of RR type “CNAME” ([IANA RR Type
List]) chaining from the query name to the owner name of the “A”
RRset.</li>
</ol></li>
<li>The answer section has RRsig record or records in the answer section
meeting the following criteria:
<ol type="1">
<li>There is at least one RRsig for the “A” RRset in the answer
section.</li>
<li>If there are CNAME records in the answer section, then there is at
least one RRsig for each CNAME record.</li>
<li>None of the RRsig records are for a wildcard.</li>
</ol></li>
</ol></li>
<li>If the following criteria are met go to next name server IP:
<ol type="1">
<li>The The RCODE of response is “NoError” ([IANA RCODE List]).</li>
<li>The answer section has one or more record of RR type “CNAME” ([IANA
RR Type List]) in a chain where first record has the onwer name matching
the query name.</li>
<li>The answer section has RRsig record or records in the answer section
meeting the following criteria:
<ol type="1">
<li>There is at least one RRsig for each CNAME record.</li>
<li>None of the RRsig records are for a wildcard.</li>
</ol></li>
<li>There are neither NSEC nor NSEC3 records in the authority
section.</li>
</ol></li>
<li>If the answer section has any RRset of RR type “A” or “CNAME” ([IANA
RR Type List]) do (“RRset”):
<ol type="1">
<li>For each RRset in <em>RRset</em> add name server IP, RR type and
owner name to the <em>Unsigned Answer</em> set if both criteria are
true:
<ol type="1">
<li>There is no RRSIG record covering the owner name of the RRset.</li>
<li>There is no RRSIG record covering a wild card record whose owner
name covers the owner name of the RRset.</li>
</ol></li>
<li>Go to next name server IP if any data was added to the <em>Unsigned
Answer</em> set in the loop above.</li>
<li>For each RRset in <em>RRset</em> add name server IP, RR type and
owner name to the <em>Answer Verify Error</em> set if its RRSIG cannot
be verified by the corresponding DNSKEY or DNSKEY is missing.</li>
<li>Go to next name server IP if any data was added to the <em>Answer
Verify Error</em> set in the loop above.</li>
</ol></li>
<li>If the authority section has both NSEC and NSEC3 records, add the
name server IP to the <em>Mixed NSEC/NSEC3</em> set.</li>
<li>Else, if the authority section has neither NSEC nor NSEC3 records,
then add the name server IP to the <em>No NSEC Or NSEC3</em> set.</li>
<li>Else (the authority section has one or more NSEC records but no
NSEC3 records or one or more NSEC3 records but no NSEC records) do:
<ol type="1">
<li>Add the name server IP to the <em>Has NSEC</em> set (<em>Has
NSEC3</em> set).</li>
<li>Retrieve all NSEC (NSEC3) records from the response.</li>
<li>Verify if the NSEC (NSEC3) records cover the <em>[Non-Existent Query
Name]</em>.
<ul>
<li>If not then add the name server IP to the <em>Name Not Covered By
NSEC</em> (<em>Name Not Covered By NSEC3</em>) set.</li>
</ul></li>
<li>Retrieve the RRSIG records for the retrieved NSEC records (NSEC3
records).</li>
<li>If any of the NSEC records (NSEC3 records) do not have a matching
RRSIG record, then add the name server IP to the <em>NSEC Missing
Signature</em> (<em>NSEC3 Missing Signature</em>) set.</li>
<li>If no NSEC (NSEC3) record was signed, go to next name server
IP.</li>
<li>Compare the RRSIG records with the retrieved DNSKEY records.</li>
<li>For each NSEC RRSIG (NSEC3 RRSIG) do:
<ol type="1">
<li>Verify the RRSIG record by the DNSKEY records.</li>
<li>If the Zonemaster installation does not have support for the DNSKEY
algorithm that created the RRSIG, then add name server IP, DNSKEY
algorithm and DNSKEY key tag to the <em>Algo Not Supported By ZM</em>
set.</li>
<li>Else, if one or more of the following criteria is met, add the name
server IP to the <em>NSEC RRSIG Verify Error</em> (<em>NSEC3 RRSIG
Verify Error</em>) set.
<ol type="1">
<li>No DNSKEY records are available.</li>
<li>The RRSIG record has a validity period that starts after or ends
before the time of test execution.</li>
<li>There is no DNSKEY that matches RRSIG by key tag.</li>
<li>The RRSIG cannot be validated by the DNSKEY record appointed.</li>
</ol></li>
</ol></li>
</ol></li>
</ol></li>
<li><p>If the <em>Non-Existent Response Error</em> set is non-empty then
output <em>[DS10_NON_EXISTENT_RESPONSE_ERROR]</em> with the name server
IP addresses from the set.</p></li>
<li><p>If the <em>Unsigned Answer</em> set is non-empty then for each
owner name and RR type output <em>[DS10_UNSIGNED_ANSWER]</em> with owner
name, RR type and name server IP addresses.</p></li>
<li><p>If the <em>Answer Verify Error</em> set is non-empty then for
each owner name and RR type output <em>[DS10_ANSWER_VERIFY_ERROR]</em>
with owner name, RR type and name server IP addresses.</p></li>
<li><p>If the <em>No NSEC Or NSEC3</em> set is non-empty then output
<em>[DS10_MISSING_NSEC_NSEC3]</em> with the name server IP addresses
from the set.</p></li>
<li><p>If both the <em>Has NSEC</em> and the <em>Has NSEC3</em> are
non-empty, then output <em>[DS10_INCONSISTENT_NSEC_NSEC3]</em> with the
name server IP addresses from the sets (two sets of name server IP
addresses).</p></li>
<li><p>If the <em>Mixed NSEC/NSEC3</em> set is non-empty, then output
<em>[DS10_MIXED_NSEC_NSEC3]</em> with the name server IP addresses from
the set.</p></li>
<li><p>If the <em>Has NSEC</em> set is non-empty and all the following
sets are empty, then output <em>[DS10_HAS_NSEC]</em>:</p>
<ol type="1">
<li><em>No NSEC Or NSEC3</em> set</li>
<li><em>Has NSEC3</em> set</li>
<li><em>Mixed NSEC/NSEC3</em> set</li>
</ol></li>
<li><p>If the <em>Has NSEC3</em> set is non-empty and all the following
sets are empty, then output <em>[DS10_HAS_NSEC3]</em>:</p>
<ol type="1">
<li><em>No NSEC Or NSEC3</em> set</li>
<li><em>Has NSEC</em> set</li>
<li><em>Mixed NSEC/NSEC3</em> set</li>
</ol></li>
<li><p>If the <em>Name Not Covered By NSEC</em> set is non-empty then
output <em>[DS10_NAME_NOT_COVERED_BY_NSEC]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>Name Not Covered By NSEC3</em> set is non-empty then
output <em>[DS10_NAME_NOT_COVERED_BY_NSEC3]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>NSEC Missing Signature</em> set is non-empty then
output <em>[DS10_NSEC_MISSING_SIGNATURE]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>NSEC3 Missing Signature</em> set is non-empty then
output <em>[DS10_NSEC3_MISSING_SIGNATURE]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>NSEC RRSIG Verify Error</em> set is non-empty, then
output <em>[DS10_NSEC_RRSIG_VERIFY_ERROR]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>NSEC3 RRSIG Verify Error</em> set is non-empty, then
output <em>[DS10_NSEC3_RRSIG_VERIFY_ERROR]</em> with the name server IP
addresses from the set.</p></li>
<li><p>If the <em>Algo Not Supported By ZM</em> set is non-empty, then
output <em>[DS10_ALGO_NOT_SUPPORTED_BY_ZM]</em> for each DNSKEY key tag
with the name server IP addresses, the key tag and the algorithm name
and code from the set. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
<h4 id="terminology">Terminology</h4>
<h5 id="the-non-existent-query-name">The Non-Existent Query Name</h5>
<p>The term “The Non-Existent Query Name” is used for a name in the
<em>Child Zone</em>, just below apex constructed for this test case to,
with high certainty, not exist, as a directly defined name. The first
label starts with “xx–” which should not be used as of [RFC 5890][RFC
5890#section-2.3.1], section 2.3.1.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-13"></a><h3>5.52. dnssec-13 - Check that all DNSKEY algorithms are used to sign the zone</h3><h4>Description</h4><div class="markdown-content"><p>From [RFC 6840][RFC 6840#section-5.11], section 5.11:</p>
<blockquote>
<p>The DS RRset and DNSKEY RRset are used to signal which algorithms are
used to sign a zone. […] The zone MUST also be signed with each
algorithm (though not each key) present in the DNSKEY RRset. […]</p>
</blockquote>
<p>To verify that the whole zone is signed with all algorithms require
access to the complete zone, which is generally not possible for public
zones. This test case is limited to three RRsets that must be present in
a signed zone, the SOA RRset, the NS RRset and the DNSKEY RRset.</p>
<p>This test case will verify that for each DNSKEY algorithm, there is a
RRSIG of that algorithm for the three selected RRsets. ## Scope</p>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01], [DNSSEC08] and [DNSSEC09]. Issues covered by
[Connectivity01] (basic name server issues), [DNSSEC08] (signing of
DNSKEY RRset) and [DNSSEC09] (signing of SOA RRset) will not result in
messagess from this test case. ## Inputs</p>
<ul>
<li><p>“Child Zone” - The domain name to be tested. ## Summary</p></li>
<li><p>If the name server reports no DNSKEY RRset, then this test case
will not test or report anything.</p></li>
<li><p>This test case will not report anything unless there is an issue
to report.</p></li>
</ul>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 7%" />
<col style="width: 28%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">Level</th>
<th style="text-align: left;">Arguments</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS13_ALGO_NOT_SIGNED_DNSKEY</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num</td>
<td style="text-align: left;">The DNSKEY RRset is not signed with an
algorithm present in the DNSKEY RRset</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS13_ALGO_NOT_SIGNED_NS</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num</td>
<td style="text-align: left;">The NS RRset is not signed with an
algorithm present in the DNSKEY RRset</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS13_ALGO_NOT_SIGNED_SOA</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">ns_ip_list, algo_mnemo, algo_num</td>
<td style="text-align: left;">The SOA RRset is not signed with an
algorithm present in the DNSKEY RRset</td>
</tr>
</tbody>
</table>
<p>The value in the Level column is the default severity level of the
message. The severity level can be changed in the [Zonemaster-Engine
profile]. Also see the [Severity Level Definitions] document.</p>
<p>The argument names in the Arguments column lists the arguments used
in the message. The argument names are defined in the [argument list].
## Test procedure</p>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for the apex of the
<em>Child Zone</em> (“DNSKEY Query”).</p></li>
<li><p>Create a SOA query with DO flag set for the apex of the <em>Child
Zone</em> (“SOA Query”).</p></li>
<li><p>Create a NS query with DO flag set for the apex of the <em>Child
Zone</em> (“NS Query”).</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address and associated DNSKEY algorithm (“Algo not
signed DNSKEY”).</li>
<li>Name server IP address and associated DNSKEY algorithm (“Algo not
signed SOA”).</li>
<li>Name server IP address and associated DNSKEY algorithm (“Algo not
signed NS”).</li>
</ol></li>
<li><p>For each name server IP in the <em>NS IP</em> set do:</p>
<ol type="1">
<li>Create an empty set of DNSKEY algorithms (“DNSKEY Algorithm”).</li>
<li>Send <em>DNSKEY Query</em> over UDP and do:
<ol type="1">
<li>Go to next name server IP if any of the following criteria is met:
<ol type="1">
<li>No DNS response is returned.</li>
<li>The RCODE value of the DNS response is not “NoError” ([IANA RCODE
List]).</li>
<li>The AA flag of the response is unset.</li>
<li>The DNS response contains no DNSKEY record in the answer
section.</li>
<li>The DNS response contains no RRSIG for the DNSKEY RRset.</li>
</ol></li>
<li>Extract all DNSKEY records from the answer section.</li>
<li>Extract the algorithm numbers from each DNSKEY record and add them
to the <em>DNSKEY Algorithm</em> set.</li>
<li>Extract all RRSIG records for the DNSKEY RRset from the
response.</li>
<li>For each algorithm in <em>DNSKEY Algorithm</em> do:
<ul>
<li>If there is no RRSIG for the DNSKEY RRset created by the algorithm
then add name server IP and DNSKEY algorithm to the <em>Algo not signed
DNSKEY</em> set.</li>
</ul></li>
</ol></li>
<li>Send <em>SOA Query</em> over UDP and do:
<ol type="1">
<li>Go to next name server IP if any of the following criteria is met:
<ol type="1">
<li>No DNS response is returned.</li>
<li>The RCODE value of the DNS response is not “NoError” ([IANA RCODE
List]).</li>
<li>The AA flag of the response is unset.</li>
<li>The DNS response contains no SOA record in the answer section.</li>
<li>The DNS response contains no RRSIG for the SOA RRset.</li>
</ol></li>
<li>Extract the SOA record from the answer section (ignore additional
SOA records, if any).</li>
<li>Extract all RRSIG records for the SOA RRset from the response.</li>
<li>For each algorithm in <em>DNSKEY Algorithm</em> do:
<ul>
<li>If there is no RRSIG for the SOA RRset created by the algorithm then
add name server IP and DNSKEY algorithm to the <em>Algo not signed
SOA</em> set.</li>
</ul></li>
</ol></li>
<li>Send <em>NS Query</em> over UDP.
<ol type="1">
<li>Go to next name server IP if any of the following criteria is met:
<ol type="1">
<li>No DNS response is returned.</li>
<li>The RCODE value of the DNS response is not “NoError” ([IANA RCODE
List]).</li>
<li>The AA flag of the response is unset.</li>
<li>The DNS response contains no NS record in the answer section.</li>
<li>The DNS response contains no RRSIG for the NS RRset.</li>
</ol></li>
<li>Extract all NS records from the answer section.</li>
<li>Extract all RRSIG records for the NS RRset from the response.</li>
<li>For each algorithm in <em>DNSKEY Algorithm</em> do:
<ul>
<li>If there is no RRSIG for the NS RRset created by the algorithm then
add name server IP and DNSKEY algorithm to the <em>Algo not signed
NS</em> set.</li>
</ul></li>
</ol></li>
</ol></li>
<li><p>If the <em>Algo not signed DNSKEY</em> set is non-empty, then for
each DNSKEY algorithm in the set output
<em>[DS13_ALGO_NOT_SIGNED_DNSKEY]</em> with the name server IP addresses
from the set and the DNSKEY algorithm.</p></li>
<li><p>If the <em>Algo not signed SOA</em> set is non-empty, then for
each DNSKEY algorithm in the set output
<em>[DS13_ALGO_NOT_SIGNED_SOA]</em> with the name server IP addresses
from the set and the SOA algorithm.</p></li>
<li><p>If the <em>Algo not signed NS</em> set is non-empty, then for
each DNSKEY algorithm in the set output
<em>[DS13_ALGO_NOT_SIGNED_NS]</em> with the name server IP addresses
from the set and the NS algorithm. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
<p>Test case is only performed if DNSKEY records are found.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-14"></a><h3>5.53. dnssec-14 - Check for valid RSA DNSKEY key size</h3><h4>Description</h4><div class="markdown-content"><p>The DNSKEYs based on RSA have different minimum and maximum key
sizes, which must be followed. This test case will validate the keys
size of such keys. RSA based algorithms that are deprecated or else not
suitable for DNSKEY ([RFC 8624] and [IANA registry]) are just ignored.
See test case [DNSSEC05] for test of algorithm.</p>
<p>The table 1 below specify the maximum and minimum key size,
respectively. Algorithm number can be found in [IANA registry].</p>
<p>Table 1: Minimum and maximum RSA key sizes in bits</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Algorithm</th>
<th style="text-align: left;">Min size</th>
<th style="text-align: left;">Max size</th>
<th style="text-align: left;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">512</td>
<td style="text-align: left;">4096</td>
<td style="text-align: left;">[RFC 3110]</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: left;">512</td>
<td style="text-align: left;">4096</td>
<td style="text-align: left;">[RFC 5155]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: left;">512</td>
<td style="text-align: left;">4096</td>
<td style="text-align: left;">[RFC 5702]</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">1024</td>
<td style="text-align: left;">4096</td>
<td style="text-align: left;">[RFC 5702]</td>
</tr>
</tbody>
</table>
<p>It is also recommended that an RSA based algorithm has a key length
of at least 2048 bit as stated in [NIST SP 800-57 Part 1 Rev. 4], table
2 on page 53 in section 5.6.1 and table 4 on page 55 in section
5.6.2.</p>
<p>This test case verifies that RSA DNSKEYs follows the stated key
lengths from the RFCs and also the NIST recommended shortest key
length.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will set DEBUG level on messages for
non-responsive name servers.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
<li>“Key Size Table” - The table above.</li>
</ul>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create a DNSKEY query with DO flag set for the apex of the
<em>Child Zone</em>.</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create an empty set “DNSKEY RRs”.</p></li>
<li><p>For each name server IP address in <em>NS IP</em> do:</p>
<ol type="1">
<li>Send the DNSKEY query over UDP.</li>
<li>If no DNS response is returned, then output
<em>[NO_RESPONSE]</em>.</li>
<li>Else, if the DNS response does not contain an DNSKEY RRset, then
output <em>[NO_RESPONSE_DNSKEY]</em>.</li>
<li>Else, retrieve the DNSKEY RRs and add them to <em>DNSKEY
RRs</em>.</li>
</ol></li>
<li><p>For each DNSKEY from the <em>DNSKEY RRs</em> do:</p>
<ol type="1">
<li>If the algorithm of the DNSKEY is not listed in <em>Key Size
Table</em>, go to next DNSKEY.</li>
<li>Else, if the algorithm is listed in <em>Key Size Table</em> and the
key size is smaller than specified, then output
<em>[DNSKEY_TOO_SMALL_FOR_ALGO]</em>.</li>
<li>Else, if the algorithm is listed in <em>Key Size Table</em> and the
key size is smaller than 2048 bits, then output
<em>[DNSKEY_SMALLER_THAN_REC]</em>.</li>
<li>Else, if the algorithm is listed in <em>Key Size Table</em> and the
key size is larger than specified, then output
<em>[DNSKEY_TOO_LARGE_FOR_ALGO]</em>.</li>
</ol></li>
<li><p>If <em>DNSKEY RRs</em> is non-empty and no messages, except for
any <em>[NO_RESPONSE]</em>, has been outputted, then output
<em>[KEY_SIZE_OK]</em>. ## Outcome(s)</p></li>
</ol>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>WARNING</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases the outcome of this Test Case is “pass”.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Message</th>
<th style="text-align: left;">Default severity level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NO_RESPONSE</td>
<td style="text-align: left;">DEBUG</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO_RESPONSE_DNSKEY</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DNSKEY_SMALLER_THAN_REC</td>
<td style="text-align: left;">WARNING</td>
</tr>
<tr class="even">
<td style="text-align: left;">DNSKEY_TOO_SMALL_FOR_ALGO</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DNSKEY_TOO_LARGE_FOR_ALGO</td>
<td style="text-align: left;">ERROR</td>
</tr>
<tr class="even">
<td style="text-align: left;">KEY_SIZE_OK</td>
<td style="text-align: left;">INFO</td>
</tr>
</tbody>
</table>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting on the ignored result.</p>
<p>See the [DNSSEC README] document about DNSSEC algorithms.</p>
<p>The test case is only performed if some DNSKEY record is found in the
<em>Child Zone</em>.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-15"></a><h3>5.54. dnssec-15 - Check existence of CDS and CDNSKEY</h3><h4>Description</h4><div class="markdown-content"><p>CDS and CDNSKEY record types are defined in [RFC 7344] and [RFC
8078]. Both record types are optional in a zone. The objective of this
test case is to verify that they are correctly set-up, if included in
the zone.</p>
<p>If a CDS record is included in the zone, the corresponding CDNSKEY
record should also be included ([RFC 7344][RFC 7344#4], section 4).</p>
<p>The CDS and CDNSKEY RRsets should be consistent between all name
servers for the zone in question.</p>
<p>If there are both CDS RRs and CDNSKEY RRs in the zone they must match
in content ([RFC 7344][RFC 7344#4], section 4). It means that both must
be derived from the same DNSKEY or both being “delete” CDS and
CDNSKEY.</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4 id="summary">Summary</h4>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 20%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">[Default level]</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS15_HAS_CDNSKEY_NO_CDS</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDNSKEY RRset is found, but no CDS
RRset.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS15_HAS_CDS_AND_CDNSKEY</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">CDNSKEY and CDS RRsets are found.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS15_HAS_CDS_NO_CDNSKEY</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDS RRset is found, but no CDNSKEY
RRset.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS15_INCONSISTENT_CDNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">All servers do not have the same CDNSKEY
RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS15_INCONSISTENT_CDS</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">All servers do not have the same CDS
RRset.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS15_MISMATCH_CDS_CDNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">Both CDS and CDNSKEY RRsets are found but
they do not match.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS15_NO_CDS_CDNSKEY</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">No CDS or CDNSKEY RRsets are found on any
name server.</td>
</tr>
</tbody>
</table>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address and associated CDS RRset (“CDS RRsets”). A
name server IP can hold an empty RRset.</li>
<li>Name server IP address and associated CDNSKEY RRset (“CDNSKEY
RRsets”). A name server IP can hold an empty RRset.</li>
<li>Name server IP address set (“Mismatch CDS/CDNSKEY”).</li>
<li>Name server IP address set (“Has CDS No CDNSKEY”).</li>
<li>Name server IP address set (“Has CDNSKEY No CDS”).</li>
<li>Name server IP address set (“Has CDS And CDNSKEY”).</li>
</ol></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Create a CDS query with EDNS enabled with the DO bit set for the
apex of the <em>Child Zone</em>.</p></li>
<li><p>Create a CDNSKEY query with EDNS enabled with the DO bit set for
the apex of the <em>Child Zone</em>.</p></li>
<li><p>For each name server IP in the <em>NS IP</em> set do:</p>
<ol type="1">
<li>Send the CDS query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the DNS response contains no CDS record in the answer
section, then add the name server IP and an empty RRset to the <em>CDS
RRsets</em> set.</li>
<li>Else, add the name server IP and the CDS RRset from the answer
section to the <em>CDS RRsets</em> set.</li>
</ol></li>
<li>Send the CDNSKEY query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the DNS response contains no CDNSKEY record in the answer
section, then add the name server IP and an empty RRset to the
<em>CDNSKEY RRsets</em> set.</li>
<li>Else, add the name server IP and the CDNSKEY RRset from the answer
section to the <em>CDNSKEY RRsets</em> set.</li>
</ol></li>
<li>Go to next name server IP.</li>
</ol></li>
<li><p>If the <em>CDS RRsets</em> set and the <em>CDNSKEY RRsets</em>
set are empty then output <em>[DS15_NO_CDS_CDNSKEY]</em> and terminate
this test case.</p></li>
<li><p>For each name server IP in the <em>CDS RRsets</em> set do:</p>
<ol type="1">
<li>If the name server IP is not listed in <em>CDNSKEY RRsets</em>, go
to next name server IP.</li>
<li>If the name server IP address has a non-empty RRset in the <em>CDS
RRsets</em> set, but an empty RRset in the <em>CDNSKEY RRsets</em> set,
then add the name server IP address to <em>Has CDS No CDNSKEY</em>.</li>
<li>If the name server IP address has a non-empty RRset in the
<em>CDNSKEY RRsets</em> set, but an empty RRset in the <em>CDS
RRsets</em> set, then add the name server IP address to <em>Has CDNSKEY
No CDS</em>.</li>
<li>If the name server IP address has a non-empty RRset in both sets,
<em>CDNSKEY RRsets</em> and <em>CDS RRsets</em>, then add the name
server IP address to <em>Has CDS And CDNSKEY</em>.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li><p>For each name server IP in the <em>CDS RRsets</em> set do:</p>
<ol type="1">
<li>If the name server IP is not listed in <em>CDNSKEY RRsets</em>, go
to next name server IP.</li>
<li>Extract the CDS RRset (possibly empty) for the IP in the <em>CDS
RRsets</em> set.</li>
<li>Extract the CDNSKEY RRset (possibly empty) for the same IP from the
<em>CDNSKEY RRsets</em> set.</li>
<li>If both RRsets are non-empty then do:
<ol type="1">
<li>For each CDS RR verify that there is a matching CDNSKEY (derived
from the same DNSKEY or both being “delete”).</li>
<li>For each CDNSKEY RR verify that there is a matching CDS (derived
from the same DNSKEY or both being “delete”).</li>
<li>If one or both of the verifications fail then add the name server IP
to the <em>Mismatch CDS/CDNSKEY</em> set.</li>
</ol></li>
<li>Go to next name sever IP.</li>
</ol></li>
<li><p>If the <em>Has CDS No CDNSKEY</em> set is non-empty then output
<em>[DS15_HAS_CDS_NO_CDNSKEY]</em> with the name server IP addresses
from the set.</p></li>
<li><p>If the <em>Has CDNSKEY No CDS</em> set is non-empty then output
<em>[DS15_HAS_CDNSKEY_NO_CDS]</em> with the name server IP addresses
from the set.</p></li>
<li><p>If the <em>Has CDS And CDNSKEY</em> set is non-empty then output
<em>[DS15_HAS_CDS_AND_CDNSKEY]</em> with the name server IP addresses
from the set.</p></li>
<li><p>If not all CDS RRsets in the <em>CDS RRsets</em> set are
identical, where a non-empty RRset is considered to be different from an
empty RRset, then output <em>[DS15_INCONSISTENT_CDS]</em>.</p></li>
<li><p>If not all CDNSKEY RRsets in the <em>CDNSKEY RRsets</em> set are
identical, where a non-empty RRset is considered to be different from an
empty RRset, then output <em>[DS15_INCONSISTENT_CDNSKEY]</em>.</p></li>
<li><p>If the <em>Mismatch CDS/CDNSKEY</em> set is non-empty, then
output <em>[DS15_MISMATCH_CDS_CDNSKEY]</em> and list the name server IPs
from the set.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting the ignored protocol.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-16"></a><h3>5.55. dnssec-16 - Validate CDS</h3><h4>Description</h4><div class="markdown-content"><p>CDS and CDNSKEY record types are defined in [RFC 7344] and [RFC
8078]. Both record types are optional in a zone. The objective of this
test case is to verify that the CDS RRset is valid. This test case is
only relevant if the zone has at least one CDS record. For tests of the
CDNSKEY, see test case [DNSSEC17].</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<p>It is assumed that <em>Child Zone</em> has been tested or will be
tested by [DNSSEC15] and [DNSSEC17] and that the servers give the same
responses. Running this test case without running [DNSSEC15] and
[DNSSEC17] can give an incomplete report of the CDS and CDNSKEY status
of <em>Child Zone</em>.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>If no CDS record is found, the test case will terminate early with
no message tag outputted.</li>
<li>If a CDS record is of “delete” type, then it can by definition not
match or point at any DNSKEY record.</li>
</ul>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 10%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">[Default level]</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS16_CDS_INVALID_RRSIG</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDS RRset is signed with an invalid
RRSIG.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS16_CDS_MATCHES_NON_SEP_DNSKEY</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDS record matches a DNSKEY with SEP bit
(bit 15) unset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS16_CDS_MATCHES_NON_ZONE_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDS record matches a DNSKEY with zone bit
(bit 7) unset.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS16_CDS_MATCHES_NO_DNSKEY</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">CDS record does not match any DNSKEY in
DNSKEY RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS16_CDS_NOT_SIGNED_BY_CDS</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDS RRset is not signed by the key that
the CDS record points to.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS16_CDS_SIGNED_BY_UNKNOWN_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDS RRset is signed by a key not in DNSKEY
RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS16_CDS_UNSIGNED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDS RRset is unsigned.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS16_CDS_WITHOUT_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDS RRset exists, but there is no DNSKEY
RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS16_DELETE_CDS</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">CDS RRset has a “delete” CDS record as a
single record.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS16_DNSKEY_NOT_SIGNED_BY_CDS</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">DNSKEY RRset is not signed by the key or
keys that the CDS records point to.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS16_MIXED_DELETE_CDS</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">“Delete” CDS record is mixed with normal
CDS record.</td>
</tr>
</tbody>
</table>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address and associated CDS RRset and its RRSIG
records (“CDS RRsets”). The set of RRSIG records may be empty.</li>
<li>Name server IP address and associated DNSKEY RRset and its RRSIG
records (“DNSKEY RRsets”). The set of RRSIG records may be empty.</li>
<li>Name server IP address (“No DNSKEY RRset”).</li>
<li>Name server IP address (“Mixed Delete CDS”).</li>
<li>Name server IP address (“Delete CDS”).</li>
<li>Name server IP address and associated CDS key tag (“No Match CDS
With DNSKEY”).</li>
<li>Name server IP address and associated CDS key tag (“CDS points to
non-zone DNSKEY”).</li>
<li>Name server IP address and associated CDS key tag (“CDS points to
non-SEP DNSKEY”).</li>
<li>Name server IP address and associated CDS key tag (“DNSKEY Not
Signed By CDS”).</li>
<li>Name server IP address and associated CDS key tag (“CDS Not Signed
By CDS”).</li>
<li>Name server IP address (“CDS Not Signed”).</li>
<li>Name server IP address and key tag (“CDS Signed By Unknown
DNSKEY”).</li>
<li>Name server IP address and key tag (“CDS Invalid RRSIG”).</li>
</ol></li>
<li><p>Create a CDS query with EDNS enabled and the DO bit set for the
apex of the <em>Child Zone</em>.</p></li>
<li><p>Create a DNSKEY query with EDNS enabled and the DO bit set for
the apex of the <em>Child Zone</em>.</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Repeat the following steps for each name server IP address in
<em>NS IP</em>:</p>
<ol type="1">
<li>Send the CDS query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the answer section has no CDS records, go to next name
server IP.</li>
<li>Add the name server IP and the CDS RRset from the answer section to
the <em>CDS RRsets</em> set. Also include any associated RRSIG records
in the answer section.</li>
</ol></li>
<li>Send the DNSKEY query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the DNS response contains at least one DNSKEY record in the
answer section, then add the name server IP and the DNSKEY RRset from
the answer section to the <em>DNSKEY RRsets</em> set. Also include any
associated RRSIG records in the answer section.</li>
</ol></li>
<li>Go to next name server IP.</li>
</ol></li>
<li><p>If the <em>CDS RRsets</em> set is empty then terminate this test
case.</p></li>
<li><p>For each name server IP in the <em>CDS RRsets</em> set do:</p>
<ol type="1">
<li>If the CDS RRset is empty go to next name server IP address.</li>
<li>Get the CDS RRset and the associated RRSIG records, if any, from the
<em>CDS RRsets</em> set for the name server IP.</li>
<li>If any CDS record is a “delete” CDS, then do:
<ol type="1">
<li>If there is more than a single CDS record then add the name server
IP to the <em>Mixed Delete CDS</em> set.</li>
<li>Else, add the name server IP address to the <em>Delete CDS</em>
set.</li>
</ol></li>
<li>Get the DNSKEY RRset and the associated RRSIG records, if any, from
the <em>DNSKEY RRsets</em> for the same name server IP.</li>
<li>If there are no DNSKEY records, then do:
<ol type="1">
<li>Add name server IP address to the <em>No DNSKEY RRset</em> set.</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>Repeat the following steps for each CDS record unless it is a
“delete” CDS record:
<ol type="1">
<li>Compare the key tag from the CDS record with the [calculated key
tags][Key Tag Calculation] for the DNSKEY records.</li>
<li>If the CDS record does not match any DNSKEY record then add the name
server IP address and CDS record key tag to the <em>No Match CDS With
DNSKEY</em> set.</li>
<li>Else, if bit 7 of the flags field of the DNSKEY that the DS record
points to is unset (value 0) then add the name server IP address and CDS
record key tag to the <em>CDS points to non-zone DNSKEY</em> set.</li>
<li>Else, do:
<ol type="1">
<li>If the DNSKEY RRset has not been signed by the DNSKEY record that
the CDS record points at then add the name server IP address and key tag
of CDS record to the <em>DNSKEY Not Signed By CDS</em> set.</li>
<li>If the CDS RRset has not been signed by the DNSKEY record that the
CDS record points at then add the name server IP address and key tag of
CDS record to the <em>CDS Not Signed By CDS</em> set.</li>
<li>If bit 15 of the flags field of the DNSKEY that the CDS record
points at is unset (value 0) then add the name server IP address and the
key tag of the CDS record to the <em>CDS points to non-SEP DNSKEY</em>
set.</li>
</ol></li>
</ol></li>
<li>If CDS RRset is not signed, then add the name server IP address to
the <em>CDS Not Signed</em> set.</li>
<li>Else, for each RRSIG for the CDS RRset do:
<ol type="1">
<li>If the key tag of the RRSIG does not match any DNSKEY record in the
DNSKEY RRset then add the name server IP address and key tag to the
<em>CDS Signed By Unknown DNSKEY</em> set.</li>
<li>Else, if the RRSIG cannot be validated by the DNSKEY it refers to by
key tag, then add the name server IP and RRSIG key tag to the <em>CDS
Invalid RRSIG</em> set.</li>
</ol></li>
<li>Go to next name server IP address.</li>
</ol></li>
<li><p>If the <em>No DNSKEY RRset</em> set is non-empty, then output
<em>[DS16_CDS_WITHOUT_DNSKEY]</em> with all name server IP addresses in
the set.</p></li>
<li><p>If the <em>Mixed Delete CDS</em> set is non-empty, then output
<em>[DS16_MIXED_DELETE_CDS]</em> with all name server IP addresses in
the set.</p></li>
<li><p>If the <em>Delete CDS</em> set is non-empty, then output
<em>[DS16_DELETE_CDS]</em> with all name server IP addresses.</p></li>
<li><p>If the <em>No Match CDS With DNSKEY</em> set is non-empty then
do:</p>
<ul>
<li>For each CDS key tag in the set do:
<ul>
<li>Output <em>[DS16_CDS_MATCHES_NO_DNSKEY]</em> with the CDS key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDS points to non-zone DNSKEY</em> set is non-empty
then do:</p>
<ul>
<li>For each CDS key tag in the set do:
<ul>
<li>Output <em>[DS16_CDS_MATCHES_NON_ZONE_DNSKEY]</em> with the CDS key
tag and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDS points to non-SEP DNSKEY</em> set is non-empty
then do:</p>
<ul>
<li>For each CDS key tag in the set do:
<ul>
<li>Output <em>[DS16_CDS_MATCHES_NON_SEP_DNSKEY]</em> with the CDS key
tag and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>DNSKEY Not Signed By CDS</em> set is non-empty then
do:</p>
<ul>
<li>For each CDS key tag in the set do:
<ul>
<li>Output <em>[DS16_DNSKEY_NOT_SIGNED_BY_CDS]</em> with the CDS key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDS Not Signed By CDS</em> set is non-empty then
do:</p>
<ul>
<li>For each CDS key tag in the set do:
<ul>
<li>Output <em>[DS16_CDS_NOT_SIGNED_BY_CDS]</em> with the CDS key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDS Invalid RRSIG</em> set is non-empty then do:</p>
<ul>
<li>For each RRSIG key tag in the set do:
<ul>
<li>Output <em>[DS16_CDS_INVALID_RRSIG]</em> with the RRSIG key tag and
the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDS Not Signed</em> set is non-empty then output
<em>[DS16_CDS_UNSIGNED]</em> with all name server IP addresses in the
set.</p></li>
<li><p>If the <em>CDS Signed By Unknown DNSKEY</em> set is non-empty
then output <em>[DS16_CDS_SIGNED_BY_UNKNOWN_DNSKEY]</em> with the name
server IP addresses in the set.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting the ignored protocol.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssec-17"></a><h3>5.56. dnssec-17 - Validate CDNSKEY</h3><h4>Description</h4><div class="markdown-content"><p>CDS and CDNSKEY record types are defined in [RFC 7344] and [RFC
8078]. Both record types are optional in a zone. The objective of this
test case is to verify that the CDNSKEY RRset is valid. This test case
is only relevant if the zone has at least one CDNSKEY record. For tests
of the CDS, see test case [DNSSEC16].</p>
<h4 id="scope">Scope</h4>
<p>It is assumed that <em>Child Zone</em> is also tested by
[Connectivity01]. This test case will just ignore non-responsive name
servers or name servers not giving a correct DNS response for an
authoritative name server.</p>
<p>It is assumed that <em>Child Zone</em> has been tested or will be
tested by [DNSSEC15] and [DNSSEC16] and that the servers give the same
responses. Running this test case without running [DNSSEC15] and
[DNSSEC16] can give an incomplete report of the CDS and CDNSKEY status
of <em>Child Zone</em>.</p>
<h4 id="inputs">Inputs</h4>
<ul>
<li>“Child Zone” - The domain name to be tested.</li>
</ul>
<h4 id="summary">Summary</h4>
<ul>
<li>If no CDNSKEY record is found, the test case will terminate early
with no message tag outputted.</li>
<li>If a CDNSKEY record is of “delete” type, then it can by definition
not match or point at any DNSKEY record.</li>
</ul>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 10%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Message Tag outputted</th>
<th style="text-align: left;">[Default level]</th>
<th style="text-align: left;">Description of when message tag is
outputted</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DS17_CDNSKEY_INVALID_RRSIG</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDNSKEY RRset signed with an invalid
RRSIG.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS17_CDNSKEY_IS_NON_SEP</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDNSKEY record has the SEP bit (bit 15)
unset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS17_CDNSKEY_IS_NON_ZONE</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDNSKEY record has the zone bit (bit 7)
unset.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS17_CDNSKEY_MATCHES_NO_DNSKEY</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">CDNSKEY record does not match any DNSKEY
in DNSKEY RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS17_CDNSKEY_NOT_SIGNED_BY_CDNSKEY</td>
<td style="text-align: left;">NOTICE</td>
<td style="text-align: left;">CDNSKEY RRset is not signed by the key
that the CDNSKEY record points to.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS17_CDNSKEY_SIGNED_BY_UNKNOWN_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDNSKEY RRset is signed by a key not in
DNSKEY RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS17_CDNSKEY_UNSIGNED</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDNSKEY RRset is unsigned.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS17_CDNSKEY_WITHOUT_DNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">CDNSKEY RRset exists, but there is no
DNSKEY RRset.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS17_DELETE_CDNSKEY</td>
<td style="text-align: left;">INFO</td>
<td style="text-align: left;">CDNSKEY RRset has a “delete” CDNSKEY
record as a single record.</td>
</tr>
<tr class="even">
<td style="text-align: left;">DS17_DNSKEY_NOT_SIGNED_BY_CDNSKEY</td>
<td style="text-align: left;">WARNING</td>
<td style="text-align: left;">DNSKEY RRset is not signed by the key or
keys that the CDNSKEY records point to.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DS17_MIXED_DELETE_CDNSKEY</td>
<td style="text-align: left;">ERROR</td>
<td style="text-align: left;">“Delete” CDNSKEY record is mixed with
normal CDNSKEY record.</td>
</tr>
</tbody>
</table>
<h4
id="ordered-description-of-steps-to-be-taken-to-execute-the-test-case">Ordered
description of steps to be taken to execute the test case</h4>
<ol type="1">
<li><p>Create the following empty sets:</p>
<ol type="1">
<li>Name server IP address and associated CDNSKEY RRset and its RRSIG
redords (“CDNSKEY RRsets”). The set of RRSIG records may be empty</li>
<li>Name server IP address and associated DNSKEY RRset and its RRSIG
records (“DNSKEY RRsets”). The set of RRSIG records may be empty.</li>
<li>Name server IP address (“No DNSKEY RRset”).</li>
<li>Name server IP address (“Mixed Delete CDNSKEY”).</li>
<li>Name server IP address (“Delete CDNSKEY”).</li>
<li>Name server IP address and associated CDNSKEY key tag (“No Match
CDNSKEY With DNSKEY”).</li>
<li>Name server IP address and associated CDNSKEY key tag (“CDNSKEY is
non-zone key”).</li>
<li>Name server IP address and associated CDNSKEY key tag (“CDNSKEY is
non-SEP key”).</li>
<li>Name server IP address and key tag (“DNSKEY Not Signed By
CDNSKEY”).</li>
<li>Name server IP address and key tag (“CDNSKEY Not Signed By
CDNSKEY”).</li>
<li>Name server IP address (“CDNSKEY Not Signed”).</li>
<li>Name server IP address and key tag (“CDNSKEY Signed By Unknown
DNSKEY”).</li>
<li>Name server IP address and key tag (“CDNSKEY Invalid RRSIG”).</li>
</ol></li>
<li><p>Create a CDNSKEY query with EDNS enabled and the DO bit set for
the apex of the <em>Child Zone</em>.</p></li>
<li><p>Create a DNSKEY query with EDNS enabled and the DO bit set for
the apex of the <em>Child Zone</em>.</p></li>
<li><p>Retrieve all name server IP addresses for the <em>Child Zone</em>
using [Method4] and [Method5] (“NS IP”).</p></li>
<li><p>Repeat the following steps for each name server IP address in
<em>NS IP</em>:</p>
<ol type="1">
<li>Send the CDNSKEY query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the answer section has no CDNSKEY records, go to next name
server IP.</li>
<li>Add the name server IP and the CDNSKEY RRset from the answer section
to the <em>CDNSKEY RRsets</em> set. Also include any associated RRSIG
records in the answer section.</li>
</ol></li>
<li>Send the DNSKEY query over UDP to the name server IP address.
<ol type="1">
<li>If no DNS response is returned, then go to next name server IP.</li>
<li>Else, if AA bit is not set in the DNS response, then go to next name
server IP.</li>
<li>Else, if the RCODE in the DNS response is not <em>NOERROR</em>, then
go to next name server IP.</li>
<li>Else, if the DNS response contains at least one DNSKEY record in the
answer section, then add the name server IP and the DNSKEY RRset from
the answer section to the <em>DNSKEY RRsets</em> set. Also include any
associated RRSIG records in the answer section.</li>
</ol></li>
<li>Go to next name server IP.</li>
</ol></li>
<li><p>If the <em>CDNSKEY RRsets</em> set is empty then terminate this
test case.</p></li>
<li><p>For each name server IP in the <em>CDNSKEY RRsets</em> set
do:</p>
<ol type="1">
<li>If the CDNSKEY RRset is empty go to next name server IP
address.</li>
<li>Get the CDNSKEY RRset and the associated RRSIG records, if any, from
the <em>CDNSKEY RRsets</em> set for the name server IP.</li>
<li>If any CDNSKEY record is a “delete” CDNSKEY, then do:
<ol type="1">
<li>If there is more than a single CDNSKEY record then add the name
server IP to the <em>Mixed Delete CDNSKEY</em> set.</li>
<li>Else, add the name server IP address to the <em>Delete CDNSKEY</em>
set.</li>
</ol></li>
<li>Get the DNSKEY RRset and the associated RRSIG records, if any, from
the <em>DNSKEY RRsets</em> for the same name server IP.</li>
<li>If there are no DNSKEY records, then do:
<ol type="1">
<li>Add name server IP address to the <em>No DNSKEY RRset</em> set
(duplicates not possible).</li>
<li>Go to next name server IP.</li>
</ol></li>
<li>Repeat the following steps for each CDNSKEY record unless it is a
“delete” CDNSKEY record:
<ol type="1">
<li>If bit 7 of the flags field of the CDNSKEY record is unset (value 0)
then add the name server IP address and the [key tag calculated][Key Tag
Calculation] from the CDNSKEY record to the <em>CDNSKEY is non-zone
key</em> set.</li>
<li>Else, do:
<ol type="1">
<li>If bit 15 of the flags field of the CDNSKEY is unset (value 0) then
add the name server IP address and the [key tag calculated][Key Tag
Calculation] from the CDNSKEY to the <em>CDNSKEY is non-SEP key</em>
set.</li>
<li>Compare the CDNSKEY record with the DNSKEY records.</li>
<li>If the CDNSKEY record does not match any DNSKEY record then add the
name server IP address and the [key tag calculated][Key Tag Calculation]
from the CDNSKEY record to the <em>No Match CDNSKEY With DNSKEY</em>
set.</li>
<li>Else, do:
<ol type="1">
<li>If the DNSKEY RRset is not signed by the DNSKEY record that
corresponds to the CDNSKEY record then add the name server IP address
and [key tag calculated][Key Tag Calculation] from CDNSKEY record to the
<em>DNSKEY Not Signed By CDNSKEY</em> set.</li>
<li>If the CDNSKEY RRset is not signed by the DNSKEY record that
corresponds to the CDNSKEY record then add the name server IP address
and [key tag calculated][Key Tag Calculation] from CDNSKEY record to the
<em>CDNSKEY Not Signed By CDNSKEY</em> set.</li>
</ol></li>
</ol></li>
</ol></li>
<li>If the CDNSKEY RRset is not signed, then add the name server IP
address to the <em>CDNSKEY Not Signed</em> set.</li>
<li>Else, for each RRSIG for the CDNSKEY RRset do:
<ol type="1">
<li>If the key tag of the RRSIG does not match any DNSKEY record in the
DNSKEY RRset then add the name server IP address and key tag to the
<em>CDNSKEY Signed By Unknown DNSKEY</em> set.</li>
<li>Else, if the RRSIG cannot be validated by the DNSKEY it refers to by
key tag, then add the name server IP and RRSIG key tag to the
<em>CDNSKEY Invalid RRSIG</em> set.</li>
</ol></li>
<li>Go to next name server IP address.</li>
</ol></li>
<li><p>If the <em>No DNSKEY RRset</em> set is non-empty, then output
<em>[DS17_CDNSKEY_WITHOUT_DNSKEY]</em> with all name server IP addresses
in the set.</p></li>
<li><p>If the the <em>Mixed Delete CDNSKEY</em> set is non-empty, then
output <em>[DS17_MIXED_DELETE_CDNSKEY]</em> with all name server IP
addresses in the set.</p></li>
<li><p>If the <em>Delete CDNSKEY</em> set is non-empty then output
<em>[DS17_DELETE_CDNSKEY]</em> with all name server IP
addresses.</p></li>
<li><p>If the <em>No Match CDNSKEY With DNSKEY</em> set is non-empty
then do:</p>
<ul>
<li>For each CDNSKEY key tag in the set do:
<ul>
<li>Output <em>[DS17_CDNSKEY_MATCHES_NO_DNSKEY]</em> with the CDNSKEY
key tag and the name server IP addresses in the set for that key
tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDNSKEY is non-zone key</em> set is non-empty then
do:</p>
<ul>
<li>For each CDNSKEY key tag in the set do:
<ul>
<li>Output <em>[DS17_CDNSKEY_IS_NON_ZONE]</em> with the CDNSKEY key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDNSKEY is non-SEP key</em> set is non-empty then
do:</p>
<ul>
<li>For each CDNSKEY key tag in the set do:
<ul>
<li>Output <em>[DS17_CDNSKEY_IS_NON_SEP]</em> with the CDNSKEY key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>DNSKEY Not Signed By CDNSKEY</em> set is non-empty
then do:</p>
<ul>
<li>For each CDNSKEY key tag in the set do:
<ul>
<li>Output <em>[DS17_DNSKEY_NOT_SIGNED_BY_CDNSKEY]</em> with the CDNSKEY
key tag and the name server IP addresses in the set for that key
tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDNSKEY Not Signed By CDNSKEY</em> set is non-empty
then do:</p>
<ul>
<li>For each CDNSKEY key tag in the set do:
<ul>
<li>Output <em>[DS17_CDNSKEY_NOT_SIGNED_BY_CDNSKEY]</em> with the
CDNSKEY key tag and the name server IP addresses in the set for that key
tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDNSKEY Invalid RRSIG</em> set is non-empty then
do:</p>
<ul>
<li>For each RRSIG key tag in the set do:
<ul>
<li>Output <em>[DS17_CDNSKEY_INVALID_RRSIG]</em> with the RRSIG key tag
and the name server IP addresses in the set for that key tag.</li>
</ul></li>
</ul></li>
<li><p>If the <em>CDNSKEY Not Signed</em> set is non-empty then output
<em>[DS17_CDNSKEY_UNSIGNED]</em> with all name server IP addresses in
the set.</p></li>
<li><p>If the <em>CDNSKEY Signed By Unknown DNSKEY</em> set is non-empty
then output <em>[DS17_CDNSKEY_SIGNED_BY_UNKNOWN_DNSKEY]</em> with the
name server IP addresses in the set.</p></li>
</ol>
<h4 id="outcomes">Outcome(s)</h4>
<p>The outcome of this Test Case is “fail” if there is at least one
message with the severity level <em>[ERROR]</em> or
<em>[CRITICAL]</em>.</p>
<p>The outcome of this Test Case is “warning” if there is at least one
message with the severity level <em>[WARNING]</em>, but no message with
severity level <em>ERROR</em> or <em>CRITICAL</em>.</p>
<p>In other cases, no message or only messages with severity level
<em>[INFO]</em> or <em>[NOTICE]</em>, the outcome of this Test Case is
“pass”.</p>
<h4 id="special-procedural-requirements">Special procedural
requirements</h4>
<p>If either IPv4 or IPv6 transport is disabled, ignore the evaluation
of the result of any test using this transport protocol. Log a message
reporting the ignored protocol.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardDNSSEC">DNS Security Extensions (DNSSEC)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssecRSP01-ZSKRollover"></a><h3>5.57. dnssecRSP01-ZSKRollover - ZSK rollover</h3><h4>Description</h4><div class="markdown-content"><p>This test case verifies the RSP’s ability to perform a ZSK rollover
for a zone.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-DNSSECOperations">DNSSEC RSP - Operations</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssecRSP02-KSKRollover"></a><h3>5.58. dnssecRSP02-KSKRollover - KSK rollover</h3><h4>Description</h4><div class="markdown-content"><p>This test case verifies the RSP’s ability to perform a KSK rollover
for a zone.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-DNSSECOperations">DNSSEC RSP - Operations</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-dnssecRSP03-AlgorithmRollover"></a><h3>5.59. dnssecRSP03-AlgorithmRollover - algorithm rollover</h3><h4>Description</h4><div class="markdown-content"><p>This test case verifies the RSP’s ability to perform an algorithm
rollover for a zone.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-DNSSECOperations">DNSSEC RSP - Operations</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-01"></a><h3>5.60. epp-01 - EPP server must have at least one A record</h3><h4>Description</h4><div class="markdown-content"><p>At least one <code>A</code> record must be published in the DNS for
the EPP hostname, to allow IPv4-only hosts to connect to the EPP
service.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-02"></a><h3>5.61. epp-02 - EPP server must have at least one AAAA record</h3><h4>Description</h4><div class="markdown-content"><p>At least one <code>A</code> record must be published in the DNS for
the EPP hostname, to allow IPv6-only hosts to connect to the EPP
service.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-03"></a><h3>5.62. epp-03 - All IP addresses must accept TCP connections on port 700</h3><h4>Description</h4><div class="markdown-content"><p>EPP is associated with TCP port 700. All IPv4/IPv6 addresses
published in the DNS for the EPP hostname must accept TCP connections on
this port.</p>
<p>Since the EPP specification requires IP-based access control, the RSP
must configure their firewall to allow access from the RST system.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-01">epp-01 - EPP server must have at least one A record</a></li><li><a href="#Test-Case-epp-02">epp-02 - EPP server must have at least one AAAA record</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-04">epp-04 - All service ports support TLSv1.2 or higher</a></li><li><a href="#Test-Case-epp-05">epp-05 - All service ports must not support TLSv1.1 or earlier</a></li><li><a href="#Test-Case-epp-06">epp-06 - All service ports must offer a valid certificate issued by a trusted CA</a></li><li><a href="#Test-Case-epp-07">epp-07 - TLS certificate must be valid</a></li><li><a href="#Test-Case-epp-08">epp-08 - TLS certificate must be valid for the server name</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-04"></a><h3>5.63. epp-04 - All service ports support TLSv1.2 or higher</h3><h4>Description</h4><div class="markdown-content"><p>EPP uses TLS to secure the channel between client and server. The
server must support TLSv1.2 and optionally any subsequent protocol
published by the IETF.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-05"></a><h3>5.64. epp-05 - All service ports must not support TLSv1.1 or earlier</h3><h4>Description</h4><div class="markdown-content"><p>TLSv1.1 and all previous versions have known security issues and
should not be supported by the server.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-06"></a><h3>5.65. epp-06 - All service ports must offer a valid certificate issued by a trusted CA</h3><h4>Description</h4><div class="markdown-content"><p>To ensure that the connection can be trusted, the server must present
a certificate issued by a trusted CA, such as those supported by major
browsers.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-07"></a><h3>5.66. epp-07 - TLS certificate must be valid</h3><h4>Description</h4><div class="markdown-content"><p>The TLS certificate must not have expired, and must be presented with
any additional intermediate certificates.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-08"></a><h3>5.67. epp-08 - TLS certificate must be valid for the server name</h3><h4>Description</h4><div class="markdown-content"><p>The EPP server name must match at least one subjectAltName fields in
the certificate (either exact match or wildcard).</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-03">epp-03 - All IP addresses must accept TCP connections on port 700</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-09"></a><h3>5.68. epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</h3><h4>Description</h4><div class="markdown-content"><p>Once the connection is estanblished the server must send a
<code>&lt;greeting&gt;</code> frame to the client.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-11">epp-11 - &lt;svID&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-12">epp-12 - &lt;svDate&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-13">epp-13 - &lt;version&gt; element in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-14">epp-14 - &lt;lang&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li><li><a href="#Test-Case-epp-18">epp-18 - &lt;hello&gt; command must return a &lt;greeting&gt;</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.hostname">epp.hostname</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-epp.port">epp.port</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-10"></a><h3>5.69. epp-10 - All server responses must validate against the XML schema</h3><h4>Description</h4><div class="markdown-content"><p>All response frames received from the server must be well-formed XML
instances, and validate against all XSD schemas (the base EPP schemas in
addition to any extensions).</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-11"></a><h3>5.70. epp-11 - &lt;svID&gt; element in the &lt;greeting&gt; must be valid</h3><h4>Description</h4><div class="markdown-content"><p>The <code>&lt;svID&gt;</code> element in the
<code>&lt;greeting&gt;</code> must identify the EPP server.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-12"></a><h3>5.71. epp-12 - &lt;svDate&gt; element in the &lt;greeting&gt; must be valid</h3><h4>Description</h4><div class="markdown-content"><p>The <code>&lt;svDate&gt;</code> element in the
<code>&lt;greeting&gt;</code> must specify a time within close proximity
to the current date and time.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-13"></a><h3>5.72. epp-13 - &lt;version&gt; element in the &lt;greeting&gt; must be valid</h3><h4>Description</h4><div class="markdown-content"><p>The <version> element in the <greeting> must be exactly
<code>1.0</code>.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-14"></a><h3>5.73. epp-14 - &lt;lang&gt; element(s) in the &lt;greeting&gt; must be valid</h3><h4>Description</h4><div class="markdown-content"><p>All <code>&lt;lang&gt;</code> element(s) in the
<code>&lt;greeting&gt;</code> must contain valid language codes.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-15"></a><h3>5.74. epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</h3><h4>Description</h4><div class="markdown-content"><p>All <code>&lt;objURI&gt;</code> element(s) in the
<code>&lt;greeting&gt;</code> must contain XML namespace URIs TODO</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-16"></a><h3>5.75. epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-17"></a><h3>5.76. epp-17 - &lt;login&gt; command must return a successful response</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-19">epp-19 - domain &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-20">epp-20 - domain sunrise &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-21">epp-21 - domain trademark claims &lt;check&gt; command test</a></li><li><a href="#Test-Case-epp-22">epp-22 - host &lt;check&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-23">epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-24">epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-25">epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-26">epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-27">epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-28">epp-28 - host &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-29">epp-29 - host &lt;info&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-30">epp-30 - host &lt;update&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-31">epp-31 - host &lt;delete&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-32">epp-32 - domain &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-33">epp-33 - domain &lt;info&gt; command test</a></li><li><a href="#Test-Case-epp-34">epp-34 - domain &lt;update&gt; command test</a></li><li><a href="#Test-Case-epp-35">epp-35 - domain &lt;renew&gt; command test</a></li><li><a href="#Test-Case-epp-36">epp-36 - domain &lt;transfer&gt; command test</a></li><li><a href="#Test-Case-epp-37">epp-37 - domain &lt;delete&gt; command test</a></li><li><a href="#Test-Case-epp-38">epp-38 - host rename test (if applicable)</a></li><li><a href="#Test-Case-epp-39">epp-39 - domain restore test (if applicable)</a></li></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.clid">epp.clid</a></li><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.pwd">epp.pwd</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-18"></a><h3>5.77. epp-18 - &lt;hello&gt; command must return a &lt;greeting&gt;</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-19"></a><h3>5.78. epp-19 - domain &lt;check&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-20"></a><h3>5.79. epp-20 - domain sunrise &lt;check&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-21"></a><h3>5.80. epp-21 - domain trademark claims &lt;check&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-22"></a><h3>5.81. epp-22 - host &lt;check&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-23"></a><h3>5.82. epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-24"></a><h3>5.83. epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-25"></a><h3>5.84. epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-26"></a><h3>5.85. epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-27"></a><h3>5.86. epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-28"></a><h3>5.87. epp-28 - host &lt;create&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-29"></a><h3>5.88. epp-29 - host &lt;info&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-30"></a><h3>5.89. epp-30 - host &lt;update&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-31"></a><h3>5.90. epp-31 - host &lt;delete&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-32"></a><h3>5.91. epp-32 - domain &lt;create&gt; command test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-33"></a><h3>5.92. epp-33 - domain &lt;info&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-34"></a><h3>5.93. epp-34 - domain &lt;update&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-35"></a><h3>5.94. epp-35 - domain &lt;renew&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-36"></a><h3>5.95. epp-36 - domain &lt;transfer&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-37"></a><h3>5.96. epp-37 - domain &lt;delete&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-38"></a><h3>5.97. epp-38 - host rename test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-epp-39"></a><h3>5.98. epp-39 - domain restore test (if applicable)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardEPP">Extensible Provisioning Protocol (EPP)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-eppLaunch-01"></a><h3>5.99. eppLaunch-01 - launch application sunrise &lt;info&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.sunriseModel">general.sunriseModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-eppLaunch-02"></a><h3>5.100. eppLaunch-02 - domain/launch application sunrise &lt;create&gt; command test
</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.sunriseModel">general.sunriseModel</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-eppLaunch-03"></a><h3>5.101. eppLaunch-03 - domain trademark claims &lt;create&gt; command test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-eppLaunch-04"></a><h3>5.102. eppLaunch-04 - LORDN submission test</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-domainCaseFoldingValidation"></a><h3>5.103. rdap-domainCaseFoldingValidation - Domain label case folding validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an RDAP
server is processing label case conversion correctly for domain name
lookups:</strong></p>
<ol type="1">
<li></li>
</ol>
<p>A subsequent RDAP lookup may be performed in the case of a domain
name lookup to validate correct support for case insensitive label
matching:For any "NR-LDH label" or "A-label" present, the RDAP response
must match the response of a subsequent request converting any "NR-LDH
label" or "A-label" alternating uppercase and lowercase characters
(e.g., if the domain is "test.example" the RDAP response must match also
for converted domain name "tEsT.ExAmPlE").For any "U-Label" present, in
case that any of the code points support case folding, the u-label
should be case-folded for the subsequent request. (e.g., if the domain
is "CAFÉ.EXAMPLE" the RDAP response must match also for converted domain
name "café.ExAmPlE").In case that the domain name in the query contains
all u-labels and none of the labels can be case-folded (i.e., the script
or code points do not support case folding) a subsequent query is not
required.In case that the domain name in the query contains all u-labels
and the resulting domain name to query after case-folding is the same as
the original, a subsequent query is not required.{</p>
<p>"code": -10399-10403,</p>
<p>"value": "&lt;converted domain name&gt;",</p>
<p>"message": "RDAP responses do not match when handling domain label
case folding."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>DNS_RFCsIDNA_RFCs</p>
<h4 id="standard-rdap-common-data-structures-validations">Standard RDAP
Common Data Structures Validations</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-domainNameValidation"></a><h3>5.104. rdap-domainNameValidation - Domain Name validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a domain name
is valid:</strong></p>
<p>The length of each label is between 1 and 63.{</p>
<p>"code": -10299-10300,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A DNS label with length not between 1 and 63 was
found."</p>
<p>}</p>
<p>A maximum total length of 253 characters not including the last
".".{</p>
<p>"code": -10301,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name of more than 253 characters was found.
"</p>
<p>}</p>
<p>At least two labels shall exist in the domain name. See,
RDAP_Technical_Implementation_Guide_2_1 section 1.10.{</p>
<p>"code": -10302,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name with less than two labels was found. See
RDAP_Technical_Implementation_Guide_2_1 section 1.10"</p>
<p>}</p>
<p>Each label of the domain name is a valid "A-label", "U-label", or
"NR-LDH label".{</p>
<p>"code": -10303,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A DNS label not being a valid "A-label", "U-label", or
"NR-LDH label" was found."</p>
<p>}</p>
<p>Note: the latest version of the IANA IDNA Rules and Derived Property
Values shall be used. See, <a
href="https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml"
class="uri">https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml</a></p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>DNS_RFCsIDNA_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-ipv4Validation"></a><h3>5.105. rdap-ipv4Validation - IPv4 address validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an IPv4
address is valid:</strong></p>
<ol type="1">
<li>The IPv4 address is syntactically valid in dot-decimal
notation.</li>
</ol>
<p>{</p>
<p>"code": -10099-10100,</p>
<p>"value": "&lt;IPv4 address string&gt;",</p>
<p>"message": "The IPv4 address is not syntactically valid in
dot-decimal notation."</p>
<p>}</p>
<p>The IPv4 address MUST be part of a prefix categorized as "ALLOCATED"
or "LEGACY" in the "Status" field in the
<strong>ipv4AddressSpace</strong>.{</p>
<p>"code": -10101,</p>
<p>"value": "&lt;IPv4 address string&gt;",</p>
<p>"message": "The IPv4 address is not included in a prefix categorized
as ALLOCATED or LEGACY in the IANA IPv4 Address Space Registry. Dataset:
ipv4AddressSpace"</p>
<p>}</p>
<p>The IPv4 address MUST NOT be part of the
<strong>specialIPv4Addresses</strong>.{</p>
<p>"code": -10102,</p>
<p>"value": "&lt;IPv4 address string&gt;",</p>
<p>"message": "The IPv4 address is included in the IANA IPv4
Special-Purpose Address Registry. Dataset: specialIPv4Addresses"</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC791</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-ipv6Validation"></a><h3>5.106. rdap-ipv6Validation - IPv6 address validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an IPv6
address is valid:</strong></p>
<p>The IPv6 address is in canonical textual representation format.{</p>
<p>"code": -10199-10200,</p>
<p>"value": "&lt;IPv6 address string&gt;",</p>
<p>"message": "The IPv6 address is not syntactically valid."</p>
<p>}</p>
<p>The IPv6 address MUST be part of an allocation of type "Global
Unicast" in the <strong>ipv6AddressSpace</strong>.{</p>
<p>"code": -10201,</p>
<p>"value": "&lt;IPv6 address string&gt;",</p>
<p>"message": "The IPv6 address is not included in a prefix categorized
as Global Unicast in the Internet Protocol Version 6 Address Space.
Dataset: ipv6AddressSpace"</p>
<p>}</p>
<p>The IPv6 address MUST NOT be part of the
<strong>specialIPv6Addresses</strong>.{</p>
<p>"code": -10202,</p>
<p>"value": "&lt;IPv6 address string&gt;",</p>
<p>"message": "The IPv6 address is included in the IANA IPv6
Special-Purpose Address Registry. Dataset: specialIPv6Addresses"</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC5952</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-nameserver_status"></a><h3>5.107. rdap-nameserver_status - validation of nameserver status codes</h3><h4>Description</h4><div class="markdown-content"><p>If a <em>status</em> element is included in the nameserver object,
validate that it complies with the following:"active" status MAY only be
combined with "associated" status."associated" status MAY be combined
with any status."pending delete" status MUST NOT be combined with either
"client delete prohibited" or "server delete prohibited" status."pending
update" status MUST NOT be combined with either "client update
prohibited" or "server update prohibited" status.The pending create,
pending delete, pending renew, pending transfer, and pending update
status values MUST NOT be combined with each other.{</p>
<p>"code": -49299-49300,</p>
<p>"value": "&lt;status data structure&gt;",</p>
<p>"message": "The values of the status data structure does not comply
with RFC5732."</p>
<p>}</p>
<h4 id="rdap-response-profile-entities-within-domain">RDAP Response
Profile – Entities within Domain</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_1_2_2_Validation"></a><h3>5.108. rdap-rdapResponseProfile_1_2_2_Validation - no JavaScript</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.2.2 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that the RDAP response does not contain browser executable
code (e.g., JavaScript).{</p>
<p>"code": -40099-40100,</p>
<p>"value": "&lt;rdap response&gt;",</p>
<p>"message": "The RDAP response contains browser executable code (e.g.,
JavaScript). See section 1.2.2 of the RDAP_Response_Profile_2_1.""</p>
<p>}</p>
<p>Note: a library for HTML sanitizing (<a
href="https://en.wikipedia.org/wiki/HTML_sanitization"
class="uri">https://en.wikipedia.org/wiki/HTML_sanitization</a>) may be
used for this test.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_1_3_Validation"></a><h3>5.109. rdap-rdapResponseProfile_1_3_Validation - presence of &#34;icann_rdap_response_profile_0&#34; in &#34;rdapConformance&#34;</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.3 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that the JSON string value "icann_rdap_response_profile_0"
is included in the <em>RDAP Conformance</em> data structure.{</p>
<p>"code": -40199-40200,</p>
<p>"value": "&lt;rdapConformance data structure&gt;",</p>
<p>"message": "The RDAP Conformance data structure does not include
icann_rdap_response_profile_0. See section 1.3 of the
RDAP_Response_Profile_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_1_4_Validation"></a><h3>5.110. rdap-rdapResponseProfile_1_4_Validation - empty country name parameter of entity jCards</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.4 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that the country name parameter is empty in the <em>adr</em>
of all the jCard objects in the RDAP response.{</p>
<p>"code": -40399-40400,</p>
<p>"value": "&lt;vcard object&gt;",</p>
<p>"message": "A vcard object with a country name parameter with data
was found. "</p>
<p>}</p>
<h4 id="rdap-response-profile---miscellaneous">RDAP Response Profile -
Miscellaneous</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_1_6_contactReprestentation"></a><h3>5.111. rdap-rdapResponseProfile_1_6_contactReprestentation - validate use of jCard and presence of alternative format(s)</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_10_Validation"></a><h3>5.112. rdap-rdapResponseProfile_2_10_Validation - presence of secureDNS property</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.10 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that a <em>secureDNS</em> member is included in the domain
object.{</p>
<p>"code": -46799-46800,</p>
<p>"value": "&lt;domain object&gt;",</p>
<p>"message": "A secureDNS member does not appear in the domain
object."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_11_Validation"></a><h3>5.113. rdap-rdapResponseProfile_2_11_Validation - presence of &#34;RDDS Inaccuracy Complaint Form&#34; notice</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.11 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that the <em>notices</em> member contains an element in the
<u>JSON array</u> with a title “RDDS Inaccuracy Complaint Form”, a
description containing the string “URL of the ICANN RDDS Inaccuracy
Complaint Form: https://icann.org/wicf” and a links member with an
<em>href</em> containing "https://icann.org/wicf".{</p>
<p>"code": -46699-46700,</p>
<p>"value": "&lt;notices structure&gt;",</p>
<p>"message": "The notice for <a href="https://icann.org/wicf"
class="uri">https://icann.org/wicf</a> was not found."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_1_Validation"></a><h3>5.114. rdap-rdapResponseProfile_2_1_Validation - presence of ldhName/unicodeName property for A-label/U-label domain lookup responses, respectively</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.1 of the RDAP_Response_Profile_2_1:</strong></p>
<p>If domain/&lt;domain name&gt; in the RDAP Query URI contains only
A-label or NR-LDH labels, the topmost domain object shall contain a
<em>ldhName</em>.{</p>
<p>"code": -46099-46100,</p>
<p>"value": "&lt;domain object&gt;",</p>
<p>"message": "The RDAP Query URI contains only A-label or NR-LDH
labels, the topmost domain object does not contain a ldhName member. See
section 2.1 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
<p>If domain/&lt;domain name&gt; in the RDAP Query URI contains one or
more U-label, the topmost domain object shall contain an
<em>unicodeName</em>.{</p>
<p>"code": -46101,</p>
<p>"value": "&lt;domain object&gt;",</p>
<p>"message": " The RDAP Query URI contains one or more U-label, the
topmost domain object does not contain a unicodeName member. See section
2.1 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_2_Validation"></a><h3>5.115. rdap-rdapResponseProfile_2_2_Validation - format of handle property</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.2 of the RDAP_Response_Profile_2_1:</strong></p>
<p>The handle in the topmost <em>domain</em> object shall comply with
the following format specified in RFC5730: "(\w|_){1,80}-\w{1,8}". {</p>
<p>"code": -46199-46200,</p>
<p>"value": "&lt;domain object&gt;",</p>
<p>"message": "The handle in the domain object does not comply with the
format (\w|_){1,80}-\w{1,8} specified in RFC5730"."</p>
<p>}</p>
<p>If the handle in the topmost <em>domain</em> object comply with the
format: "(\w|_){1,80}-\w{1,8}", validate that the string followed by a
hyphen ("-", ASCII value 0x002D) is registered in
<strong>EPPROID</strong>.{</p>
<p>"code": -46201,</p>
<p>"value": "&lt;domain object&gt;",</p>
<p>"message": "The globally unique identifier in the domain object
handle is not registered in EPPROID."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_3_1_1_Validation"></a><h3>5.116. rdap-rdapResponseProfile_2_3_1_1_Validation - presence of &#34;registration&#34; event</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.3.1.1 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that an <em>eventAction</em> of type "registration" exists
in the topmost events structure.{</p>
<p>"code": -46299-46300,</p>
<p>"value": "&lt;events data structure&gt;",</p>
<p>"message": "An eventAction of type registration does not exists in
the topmost events data structure. See section 2.3.1.1 of the
RDAP_Response_Profile_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_3_1_2_Validation"></a><h3>5.117. rdap-rdapResponseProfile_2_3_1_2_Validation - presence of &#34;expiration&#34; event</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.3.1.2 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that an <em>eventAction</em> type "expiration" exists in the
topmost events structure.{</p>
<p>"code": -46399-46400,</p>
<p>"value": "&lt;events data structure&gt;",</p>
<p>"message": "An eventAction of type expiration does not exists in the
topmost events data structure. See section 2.3.1.2 of the
RDAP_Response_Profile_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation"></a><h3>5.118. rdap-rdapResponseProfile_2_3_1_3_and_2_7_6_and_3_3_and_4_4_Validation - presence of &#34;last update of RDAP database&#34; event</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.3.1.3, 2.7.6, 3.3 and 4.4 of the
RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that an <em>eventAction</em> type "last update of RDAP
database" exists in events structure included in the topmost
object.{</p>
<p>"code": -43099-43100,</p>
<p>"value": "&lt;events data structure&gt;",</p>
<p>"message": "An eventAction type last update of RDAP database does not
exists in the topmost events data structure. See section 2.3.1.3, 2.7.6,
3.3 and 4.4 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
<h4 id="rdap-response-profile---domain">RDAP Response Profile -
Domain</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_4_1_Validation"></a><h3>5.119. rdap-rdapResponseProfile_2_4_1_Validation - presence and validity of the registrar entity</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.4.1 of the RDAP_Response_Profile_2_1:</strong></p>
<p>An <em>entity</em> with the registrar role within the topmost domain
object shall exist. {</p>
<p>"code": -47299-47300,</p>
<p>"value": "&lt;domain object data structure&gt;",</p>
<p>"message": "An entity with the registrar role was not found in the
domain topmost object."</p>
<p>}</p>
<p>Only one <em>entity</em> with the registrar role within the topmost
domain object shall exist. {</p>
<p>"code": -47301,</p>
<p>"value": "&lt;domain object data structure&gt;",</p>
<p>"message": "More than one entities with the registrar role were found
in the domain topmost object."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the topmost
domain object, validate that a <em>fn</em> member is included in all of
the vcard objects. {</p>
<p>"code": -47302,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "An fn member was not found in one or more vcard objects
of the entity with the registrar role."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation"></a><h3>5.120. rdap-rdapResponseProfile_2_4_2_and_2_4_3_Validation - validation of the publicIds and handle properties of the registrar entity</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.4.2 and 2.4.3 of the RDAP_Response_Profile_2_1:</strong></p>
<p>For the <em>entity</em> with the registrar role within the topmost
object, validate that a <em>publicIds</em> member is included. {</p>
<p>"code": -47399-47400,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "A publicIds member is not included in the entity with the
registrar role."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, if a <em>publicIds</em> member is included, validate that the
identifier member is a positive integer.{</p>
<p>"code": -47401,</p>
<p>"value": "&lt;publicIds data structure&gt;",</p>
<p>"message": "The identifier of the publicIds member of the entity with
the registrar role is not a positive integer."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, validate that the <em>handle</em> member is a positive
integer.{</p>
<p>"code": -47402,</p>
<p>"value": "&lt;publicIds data structure&gt;",</p>
<p>"message": "The handle of the entity with the registrar role is not a
positive integer."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, if a <em>publicIds</em> member is included, validate that the
<em>identifier</em> member equals the <em>handle</em> member.{</p>
<p>"code": -47403,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "The identifier of the publicIds member of the entity with
the registrar role is not equal to the handle member."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, validate that the value of the <em>handle</em> member exists in
the <strong>registrarId</strong>.{</p>
<p>"code": -47404,</p>
<p>"value": "&lt;handle&gt; + "\n/\n" + &lt;registrarId&gt;",</p>
<p>"message": "The handle references an IANA Registrar ID that does not
exist in the <strong>registrarId</strong>."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_4_5_Validation"></a><h3>5.121. rdap-rdapResponseProfile_2_4_5_Validation - abuse role for the registrar entity</h3><h4>Description</h4><div class="markdown-content"><p>For the <em>entity</em> with the registrar role within the
<em>domain</em> object, validate that an <em>entity</em> with the abuse
role is included, and the entity with the abuse role includes a
<em>tel</em> and <em>email</em> members in all the vcard objects.{</p>
<p>"code": -47499-47500,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "Tel and email members were not found for the entity
within the entity with the abuse role in the topmost domain object."</p>
<p>}</p>
<h4 id="rdap-response-profile---nameserver">RDAP Response Profile -
Nameserver</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_4_6_registrarAboutLink"></a><h3>5.122. rdap-rdapResponseProfile_2_4_6_registrarAboutLink - presence of &#34;about&#34; link in registrar entity</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_6_1_Validation"></a><h3>5.123. rdap-rdapResponseProfile_2_6_1_Validation - at least one status code</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.6.1 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that a <em>status</em> member in the topmost object contain
at least one value.{</p>
<p>"code": -47099-47100,</p>
<p>"value": "&lt;status data structure&gt;",</p>
<p>"message": "The status member does not contain at least one
value."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_6_3_Validation"></a><h3>5.124. rdap-rdapResponseProfile_2_6_3_Validation - presence of &#34;Status Codes&#34; notice</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.6.3 of the RDAP_Response_Profile_2_1:</strong></p>
<p>Validate that the <em>notices</em> member contains an element in the
<u>JSON array</u> with a title “Status Codes”, a description containing
the string “For more information on domain status codes, please visit
https://icann.org/epp” and a links member with an <em>href</em>
containing "https://icann.org/epp".{</p>
<p>"code": -46599-46600,</p>
<p>"value": "&lt;notices structure&gt;",</p>
<p>"message": "The notice for <a href="https://icann.org/epp"
class="uri">https://icann.org/epp</a> was not found."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_7_5_3_Validation"></a><h3>5.125. rdap-rdapResponseProfile_2_7_5_3_Validation - proper redaction of domain entities</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.7.5.3 of the RDAP_Response_Profile_2_1:</strong></p>
<p>For the <em>entities</em> with the registrant, administrative,
technical and billing role within the domain object, if the
<em>email</em> property is omitted, validate that a remarks element
containing a title member with a value "EMAIL REDACTED FOR PRIVACY" and
a type member with a value "object redacted due to authorization" is
included in the entity object.{</p>
<p>"code": -54999-55000,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "An entity with the administrative, technical, or billing
role without a valid "EMAIL REDACTED FOR PRIVACY" remark was found. See
section 2.7.5.3 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
<p>Note: this test also includes 2.7.5.1.</p>
<h4 id="rdap-response-profile---entities-within-domain---registrar">RDAP
Response Profile - Entities within Domain - Registrar</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation"></a><h3>5.126. rdap-rdapResponseProfile_2_9_1_and_2_9_2_Validation - presence and validity of ldhName, handle, status properties in domain nameservers</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 2.9.1 and 2.9.2 of the RDAP_Response_Profile_2_1:</strong></p>
<p>If the <em>nameservers</em> member is included within the
<em>domain</em> object, validate that all nameserver objects contain the
<em>ldhName</em> element.{</p>
<p>"code": -47199-47200,</p>
<p>"value": "&lt;nameservers data structure&gt;",</p>
<p>"message": "A nameserver object without ldhName was found."</p>
<p>}</p>
<p>If the <em>nameservers</em> member is included within the
<em>domain</em> object, validate that all handles in the nameserver
objects comply with the following format specified in RFC5730:
"(\w|_){1,80}-\w{1,8}". {</p>
<p>"code": -47201,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The handle in the nameserver object does not comply with
the format (\w|_){1,80}-\w{1,8} specified in RFC5730"."</p>
<p>}</p>
<p>If the <em>nameservers</em> member is included within the
<em>domain</em> object, validate that the string followed by a hyphen
("-", ASCII value 0x002D) is registered in <strong>EPPROID</strong> for
all the handles that comply with the format "(\w|_){1,80}-\w{1,8}".{</p>
<p>"code": -47202,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The globally unique identifier in the nameserver object
handle is not registered in EPPROID."</p>
<p>}</p>
<p>If the <em>nameservers</em> member is included within the
<em>domain</em> object and at least one nameserver object contains a
<em>handle</em> or a <em>status</em> element, validate that all
nameserver objects include a <em>handle</em> and a <em>status</em>
element. {</p>
<p>"code": -47203,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The handle or status in the nameserver object is not
included."</p>
<p>}</p>
<p>If the <em>nameservers</em> member is included within the domain
object, validate that all <em>status</em> elements included in the
nameserver objects comply with the following:"active" status MAY only be
combined with "associated" status."associated" status MAY be combined
with any status."pending delete" status MUST NOT be combined with either
"client delete prohibited" or "server delete prohibited" status."pending
update" status MUST NOT be combined with either "client update
prohibited" or "server update prohibited" status.The pending create,
pending delete, pending renew, pending transfer, and pending update
status values MUST NOT be combined with each other.{</p>
<p>"code": -47204,</p>
<p>"value": "&lt;status data structure&gt;",</p>
<p>"message": "The values of the status data structure does not comply
with RFC5732."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_4_1_Validation"></a><h3>5.127. rdap-rdapResponseProfile_4_1_Validation - presence of ldhName/unicodeName property for A-label/U-label nameserver lookup responses, respectively</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 4.1 of the RDAP_Response_Profile_2_1:</strong></p>
<p>If nameserver/&lt;nameserver name&gt; in the RDAP Query URI contains
only A-label or NR-LDH labels, the topmost domain object shall contain a
<em>ldhName</em>.{</p>
<p>"code": -49099-49100,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The RDAP Query URI contains only A-label or NR-LDH
labels, the topmost nameserver object does not contain a ldhName member.
See section 2.1 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
<p>If nameserver/&lt;nameserver name&gt; in the RDAP Query URI contains
one or more U-label, the topmost domain object shall contain an
<em>unicodeName</em>.{</p>
<p>"code": -49101,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": " The RDAP Query URI contains one or more U-label, the
topmost nameserver object does not contain a unicodeName member. See
section 2.1 of the RDAP_Response_Profile_2_1."</p>
<p>}</p>
<p>The handle in the topmost <em>nameserver</em> object shall comply
with the following format specified in RFC5730: "(\w|_){1,80}-\w{1,8}".
{</p>
<p>"code": -49102,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The handle in the nameserver object does not comply with
the format (\w|_){1,80}-\w{1,8} specified in RFC5730"."</p>
<p>}</p>
<p>If the handle in the topmost <em>nameserver</em> object comply with
the format: "(\w|_){1,80}-\w{1,8}", validate that the string followed by
a hyphen ("-", ASCII value 0x002D) is registered in
<strong>EPPROID</strong>.{</p>
<p>"code": -49103,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The globally unique identifier in the nameserver object
handle is not registered in EPPROID."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_4_3_Validation"></a><h3>5.128. rdap-rdapResponseProfile_4_3_Validation - presence and validity of the registrar entity</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 4.3 of the RDAP_Response_Profile_2_1.</strong></p>
<p><strong>The following steps shall only be executed if an entity with
the registrar role exists within the topmost object, and the handle is
different from "not applicable":</strong></p>
<p>For the <em>entity</em> with the registrar role within the topmost
object, validate that a <em>publicIds</em> member is included. {</p>
<p>"code": -49199-49200,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "A publicIds member is not included in the entity with the
registrar role."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, if a <em>publicIds</em> member is included, validate that the
identifier member is a positive integer.{</p>
<p>"code": -49201,</p>
<p>"value": "&lt;publicIds data structure&gt;",</p>
<p>"message": "The identifier of the publicIds member of the entity with
the registrar role is not a positive integer."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, validate that the <em>handle</em> member is a positive
integer.{</p>
<p>"code": -49202,</p>
<p>"value": "&lt;publicIds data structure&gt;",</p>
<p>"message": "The handle of the entity with the registrar role is not a
positive integer."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, if a <em>publicIds</em> member is included, validate that the
<em>identifier</em> member equals the <em>handle</em> member.{</p>
<p>"code": -49203,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "The identifier of the publicIds member of the entity with
the registrar role is not equal to the handle member."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, validate that the value of the <em>handle</em> member exists in
the <strong>registrarId</strong>.{</p>
<p>"code": -49204,</p>
<p>"value": "&lt;handle&gt; + "\n/\n" + &lt;registrarId&gt;",</p>
<p>"message": "The handle references an IANA Registrar ID that does not
exist in the <strong>registrarId</strong>."</p>
<p>}</p>
<p><strong><br />
</strong></p>
<p><strong>The following steps shall only be executed if an entity with
the registrar role exists within the topmost object, and the handle is
"not applicable":</strong></p>
<p>For the <em>entity</em> with the registrar role within the topmost
object, validate that a <em>publicIds</em> member is not included. {</p>
<p>"code": -49205,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "A publicIds member is included in the entity with the
registrar role."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_notices_included_Validation"></a><h3>5.129. rdap-rdapResponseProfile_notices_included_Validation - presence of &#34;notices&#34; property</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a notices
member appear in the RDAP response:</strong></p>
<p>Validate that a <em>notices</em> member appears in the RDAP
response.{</p>
<p>"code": -46499-46500,</p>
<p>"value": "&lt;RDAP response&gt;",</p>
<p>"message": "A notices members does not appear in the RDAP
response."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_rfc3915_Validation"></a><h3>5.130. rdap-rdapResponseProfile_rfc3915_Validation - RGP status code validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that the status
values comply with RFC3915:</strong></p>
<ol type="1">
<li></li>
</ol>
<p>Validate that the values of the <em>status</em> member in the topmost
object comply with the following:"redemption period" status MUST only be
combined with "pending delete"."pending restore" status MUST only be
combined with "pending delete".{</p>
<p>"code": -46999-47000,</p>
<p>"value": "&lt;status data structure&gt;",</p>
<p>"message": "The values of the status data structure does not comply
with RFC3915."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdapResponseProfile_rfc5731_Validation"></a><h3>5.131. rdap-rdapResponseProfile_rfc5731_Validation - domain status code validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that the status
values comply with RFC5731:</strong></p>
<ol type="1">
<li></li>
</ol>
<p>Validate that the values of the <em>status</em> member in the topmost
object comply with the following:"active" status MUST NOT be combined
with any other status."pending delete" status MUST NOT be combined with
either "client delete prohibited" or "server delete prohibited"
status."pending renew" status MUST NOT be combined with either "client
renew prohibited" or "server renew prohibited" status."pending transfer"
status MUST NOT be combined with either "client transfer prohibited" or
"server transfer prohibited" status."pending update" status MUST NOT be
combined with either "client update prohibited" or "server update
prohibited" status.The pending create, pending delete, pending renew,
pending transfer, and pending update status values MUST NOT be combined
with each other.{</p>
<p>"code": -46899-46900,</p>
<p>"value": "&lt;status data structure&gt;",</p>
<p>"message": "The values of the status data structure does not comply
with RFC5731."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdaptigSection_1_1_3_redactionExtension"></a><h3>5.132. rdap-rdaptigSection_1_1_3_redactionExtension - use of Redacted Fields extension, validation of redacted paths</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-rdaptigSection_3_3_3_termsOfService"></a><h3>5.133. rdap-rdaptigSection_3_3_3_termsOfService - presence of terms-of-service link</h3><h4>Description</h4><p>No information available.</p>
<h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapAsEventActorValidation"></a><h3>5.134. rdap-stdRdapAsEventActorValidation - asEventActor Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an
asEventActor data structure is valid:</strong></p>
<p>The <em>asEventActor</em> data structure must be a syntactically
valid <u>JSON array</u>.{</p>
<p>"code": -11299-11300,</p>
<p>"value": "&lt;asEventActor structure&gt;",</p>
<p>"message": "The asEventActor structure is not syntactically
valid."</p>
<p>}</p>
<p>The <em>asEventActor</em> data structure must be embedded within an
entity object, and the entity object must be embedded within another
object.{</p>
<p>"code": -11301,</p>
<p>"value": "&lt;asEventActor structure&gt;",</p>
<p>"message": "The asEventActor structure is not embedded within an
entity object and the entity object is not embedded within another
object."</p>
<p>}</p>
<p>For every object of the JSON array, verify that the structure
complies with:</p>
<p>The name of every name/value pair shall be any of:
<em>eventAction</em> or <em>eventDate</em>. {</p>
<p>"code": -11302,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: eventAction
and eventDate."</p>
<p>}</p>
<p>The JSON name/values of <em>eventAction</em> or <em>eventDate</em>
shall appear only once. {</p>
<p>"code": -11303,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>The JSON name <em>eventAction</em> shall exist.{</p>
<p>"code": -11304,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The eventAction element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>eventAction</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -11305,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>For the JSON name <em>eventAction</em>, the value shall be included
in the <strong>RDAPJSONValues</strong> with Type="event action".{</p>
<p>"code": -11306,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="event action" in the RDAPJSONValues dataset."</p>
<p>}</p>
<p>The JSON name <em>eventDate</em> shall exist.{</p>
<p>"code": -11307,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The eventDate element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>eventDate</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -11308,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>For the JSON name <em>eventDate</em>, the value shall be
syntactically valid time and date according to RFC3339.{</p>
<p>"code": -11309,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value shall be a syntactically valid time and
date according to RFC3339."</p>
<p>}</p>
<p>An <em>eventAction</em> shall only appear once within the events
array.{</p>
<p>"code": -11310,</p>
<p>"value": "&lt;events structure&gt;",</p>
<p>"message": "An <em>eventAction</em> exists more than once within the
events array."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC3339RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapConformanceValidation"></a><h3>5.135. rdap-stdRdapConformanceValidation - RDAP Conformance validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an <em>RDAP
Conformance</em> data structure is valid:</strong></p>
<p>The <em>RDAP Conformance</em> data structure must be a syntactically
valid <u>JSON array</u>.{</p>
<p>"code": -10499-10500,</p>
<p>"value": "&lt;rdapConformance structure&gt;",</p>
<p>"message": "The RDAP Conformance structure is not syntactically
valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -10501,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>Each of the <u>JSON string</u> values in the <u>JSON array</u>, with
the exception of "rdap_level_0", shall be included as an Extension
Identifier in <strong>RDAPExtensions</strong>.{</p>
<p>"code": -10502,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as an Extension
Identifier in RDAPExtensions."</p>
<p>}</p>
<p>The <u>JSON string</u> value "rdap_level_0" is not included in the
<em>RDAP Conformance</em> data structure.{</p>
<p>"code": -10503,</p>
<p>"value": "&lt;rdapConformance&gt;",</p>
<p>"message": "The RDAP Conformance data structure does not include
rdap_level_0."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs<strong><br />
</strong></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapDomainLookupValidation"></a><h3>5.136. rdap-stdRdapDomainLookupValidation - Domain Lookup Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a domain data
structure is valid:</strong></p>
<p>The <em>domain</em> data structure must be a syntactically valid JSON
object.{</p>
<p>"code": -12199-12200,</p>
<p>"value": "&lt;domain structure&gt;",</p>
<p>"message": "The domain structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be any of:
<em>objectClassName</em>, <em>handle</em>, <em>ldhName</em>,
<em>unicodeName</em>, <em>variants</em>, <em>nameservers</em>,
<em>secureDNS</em>, <em>entities</em>, <em>status</em>,
<em>publicIds</em>, <em>remarks</em>, <em>links</em>, <em>port43</em>,
<em>events</em>, <em>notices</em> or <em>rdapConformance</em>. {</p>
<p>"code": -12201,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of:
objectClassName, handle, ldhName, unicodeName, variants, nameservers,
secureDNS, entities, status, publicIds, remarks, links, port43, events,
notices or rdapConformance."</p>
<p>}</p>
<p>The JSON name/values of <em>objectClassName</em>, <em>handle</em>,
<em>ldhName</em>, <em>unicodeName</em>, <em>variants</em>,
<em>nameservers</em>, <em>secureDNS</em>, <em>entities</em>,
<em>status</em>, <em>publicIds</em>, <em>remarks</em>, <em>links</em>,
<em>port43</em>, <em>events</em>, <em>notices</em> or
<em>rdapConformance</em> shall appear only once. {</p>
<p>"code": -12202,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a domain structure was
found more than once."</p>
<p>}</p>
<p>For the JSON name <em>objectClassName</em>, the value shall be
"domain".{</p>
<p>"code": -12203,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not "domain"."</p>
<p>}</p>
<p>If the JSON name <em>handle</em> exists, the value shall be a JSON
string data type.{</p>
<p>"code": -12204,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>ldhName</em>, the value shall pass the test LDH
name [stdRdapLdhNameValidation] defined in this document.{</p>
<p>"code": -12205,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": " The value for the JSON name value does not pass LDH name
[stdRdapLdhNameValidation]."</p>
<p>}</p>
<p>If the JSON name <em>unicodeName</em> exists, the value shall pass
the test Unicode name [stdRdapUnicodeNameValidation] defined in this
document.{</p>
<p>"code": -12206,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Unicode
name [stdRdapUnicodeNameValidation]."</p>
<p>}</p>
<p>If the JSON name <em>variants</em> exists, the value shall pass the
test Variants validation [stdRdapVariantsValidation] defined in this
document.{</p>
<p>"code": -12207,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Variants
validation [stdRdapVariantsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>nameservers</em> exists, the value shall pass
the test Nameserver lookup validation
[stdRdapNameserverLookupValidation] defined in this document.{</p>
<p>"code": -12208,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass
Nameserver lookup validation [stdRdapNameserverLookupValidation]."</p>
<p>}</p>
<p>If the JSON name <em>secureDNS</em> exists, the value shall pass the
test Secure DNS validation [stdRdapSecureDnsValidation] defined in this
document.{</p>
<p>"code": -12209,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Secure
DNS validation [stdRdapSecureDnsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>entities</em> exists, the value shall pass the
test Entities validation [stdRdapEntitiesValidation] defined in this
document.{</p>
<p>"code": -12210,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Entities
validation [stdRdapEntitiesValidation]."</p>
<p>}</p>
<p>If the JSON name <em>status</em> exists, the value shall pass the
test Status validation [stdRdapStatusValidation] defined in this
document.{</p>
<p>"code": -12211,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Status
validation [stdRdapStatusValidation]."</p>
<p>}</p>
<p><mark><br />
</mark></p>
<p>If the JSON name <em>publicIds</em> exists, the value shall pass the
test Public IDs validation [stdRdapPublicIdsValidation] defined in this
document.{</p>
<p>"code": -12212,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Public
IDs validation [stdRdapPublicIdsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>remarks</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12213,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -12214,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>port43</em> exists, the value shall pass the
test Port 43 WHOIS Server [stdRdapPort43WhoisServerValidation] defined
in this document.{</p>
<p>"code": -12215,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Port 43
WHOIS Server [stdRdapPort43WhoisServerValidation]."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12216,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12217,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists and the domain object is not
the topmost JSON object.{</p>
<p>"code": -12218,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name notices exists but nameserver
object is not the topmost JSON object."</p>
<p>}</p>
<p>If the JSON name <em>rdapConformance</em> exists, the value shall
pass the test RDAP Conformance validation [stdRdapConformanceValidation]
defined in this document.{</p>
<p>"code": -12219,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass RDAP
Conformance validation [stdRdapConformanceValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapEntitiesValidation"></a><h3>5.137. rdap-stdRdapEntitiesValidation - Entities validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an entities
data structure is valid:</strong></p>
<p>The <em>entities</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -11899-11900,</p>
<p>"value": "&lt;entities structure&gt;",</p>
<p>"message": "The entities structure is not syntactically valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> shall pass the test Entity
lookup validation [stdRdapEntityLookupValidation] defined in this
document.{</p>
<p>"code": -11901,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value does not pass Entity lookup validation
[stdRdapEntityLookupValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapEntityLookupValidation"></a><h3>5.138. rdap-stdRdapEntityLookupValidation - Entity lookup validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an entity
data structure is valid:</strong></p>
<p>The <em>entity</em> data structure must be a syntactically valid JSON
object.{</p>
<p>"code": -12299-12300,</p>
<p>"value": "&lt;entity structure&gt;",</p>
<p>"message": "The entity structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be any of:
<em>objectClassName</em>, <em>handle</em>, <em>vcardArray</em>,
<em>roles</em>, <em>publicIds</em>, <em>entities</em>, <em>remarks</em>,
<em>links</em>, <em>events</em>, <em>asEventActor</em>, <em>status</em>,
<em>port43</em>, <em>notices</em> or <em>rdapConformance</em>. {</p>
<p>"code": -12301,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of:
objectClassName, handle, vcardArray, roles, publicIds, entities,
remarks, links, events, asEventActor, status, port43, notices or
rdapConformance."</p>
<p>}</p>
<p>The JSON name/values of <em>objectClassName</em>, <em>handle</em>,
<em>vcardArray</em>, <em>roles</em>, <em>publicIds</em>,
<em>entities</em>, <em>remarks</em>, <em>links</em>, <em>events</em>,
<em>asEventActor</em>, <em>status</em>, <em>port43</em>,
<em>notices</em> or <em>rdapConformance</em> shall exist only once.
{</p>
<p>"code": -12302,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a domain structure was
found more than once."</p>
<p>}</p>
<p>For the JSON name <em>objectClassName</em>, the value shall be
"entity".{</p>
<p>"code": -12303,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not "entity"."</p>
<p>}</p>
<p>If the JSON name <em>handle</em> exists, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -12304,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name title <em>vcardArray</em> exists, the value shall be
syntactically valid.{</p>
<p>"code": -12305,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": " The value for the JSON name value is not a syntactically
valid vcardArray."</p>
<p>}</p>
<p>Note: it's expected that a library for testing jCard objects will be
used.</p>
<p>If the JSON name <em>roles</em> exists, the value shall pass the test
Roles validation [stdRdapRolesValidation] defined in this document.{</p>
<p>"code": -12306,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Roles
validation [stdRdapRolesValidation]."</p>
<p>}</p>
<p>If the JSON name <em>publicIds</em> exists, the value shall pass the
test Public IDs validation [stdRdapPublicIdsValidation] defined in this
document.{</p>
<p>"code": -12307,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Public
IDs validation [stdRdapPublicIdsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>entities</em> exists, the value shall pass the
test Entities validation [stdRdapEntitiesValidation] defined in this
document.{</p>
<p>"code": -12308,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Entities
validation [stdRdapEntitiesValidation]."</p>
<p>}</p>
<p>If the JSON name <em>remarks</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12309,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -12310,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12311,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>asEventActor</em> exists, the value shall pass
the test asEventActor Validation [stdRdapAsEventActorValidation] defined
in this document.{</p>
<p>"code": -12312,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass
asEventActor Validation [stdRdapAsEventActorValidation]."</p>
<p>}</p>
<p>If the JSON name <em>status</em> exists, the value shall pass the
test Status validation [stdRdapStatusValidation] defined in this
document.{</p>
<p>"code": -12313,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Status
validation [stdRdapStatusValidation]."</p>
<p>}</p>
<p>If the JSON name <em>port43</em> exists, the value shall pass the
test Port 43 WHOIS Server [stdRdapPort43WhoisServerValidation] defined
in this document.{</p>
<p>"code": -12314,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Port 43
WHOIS Server [stdRdapPort43WhoisServerValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12315,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists and the entity object is not
the topmost JSON object.{</p>
<p>"code": -12316,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name notices exists but entity
object is not the topmost JSON object."</p>
<p>}</p>
<p>If the JSON name <em>rdapConformance</em> exists, the value shall
pass the test RDAP Conformance validation [stdRdapConformanceValidation]
defined in this document.{</p>
<p>"code": -12317,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass RDAP
Conformance validation [stdRdapConformanceValidation]."</p>
<p>}</p>
<p><strong><br />
</strong></p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapErrorResponseBodyValidation"></a><h3>5.139. rdap-stdRdapErrorResponseBodyValidation - Error Response Body</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an error data
structure is valid:</strong></p>
<p>The <em>error</em> data structure must be a syntactically valid JSON
object.{</p>
<p>"code": -12099-12100,</p>
<p>"value": "&lt;error structure&gt;",</p>
<p>"message": "The error structure is not syntactically valid."</p>
<p>}</p>
<p>At least the following name/value pairs shall appear:
<em>errorCode</em>, <em>title</em> and <em>description</em>. {</p>
<p>"code": -12101,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "At least the following name/value pairs shall exist:
errorCode, title and description."</p>
<p>}</p>
<p>The JSON name/values of <em>errorCode</em>, <em>title</em>, and
<em>description</em> shall appear only once. {</p>
<p>"code": -12102,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of an error structure was
found more than once."</p>
<p>}</p>
<p>For the JSON name <em>errorCode</em>, the value shall be a <u>JSON
number</u> data type.{</p>
<p>"code": -12103,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a number."</p>
<p>}</p>
<p>For the JSON name <em>title</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -12104,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>The <em>description</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -12105,</p>
<p>"value": "&lt;description structure&gt;",</p>
<p>"message": "The description structure is not syntactically
valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> of the <em>description</em> data
structure shall be a <u>JSON string</u> data type.{</p>
<p>"code": -12106,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p><strong><br />
</strong></p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
<h4 id="standard-rdap-object-classes-validations">Standard RDAP Object
Classes Validations</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapEventsValidation"></a><h3>5.140. rdap-stdRdapEventsValidation - Events Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a events data
structure is valid:</strong></p>
<p>The <em>events</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -10899-10900,</p>
<p>"value": "&lt;events structure&gt;",</p>
<p>"message": "The events structure is not syntactically valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>The name of every name/value pair shall be any of:
<em>eventAction</em>, <em>eventActor</em>, <em>eventDate</em> or
<em>links</em>. {</p>
<p>"code": -10901,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: eventAction,
eventActor, eventDate or links."</p>
<p>}</p>
<p>The JSON name/value pairs of <em>eventAction</em>,
<em>eventActor</em>, <em>eventDate</em> and <em>links</em> shall exist
only once. {</p>
<p>"code": -10902,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once. "</p>
<p>}</p>
<p>The JSON name <em>eventAction</em> shall exist.{</p>
<p>"code": -10903,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The eventAction element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>eventAction</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -10904,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>For the JSON name <em>eventAction</em>, the value shall be included
in the <strong>RDAPJSONValues</strong> with Type="event action".{</p>
<p>"code": -10905,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="event action" in the RDAPJSONValues data set.</p>
<p>}</p>
<p>The JSON name <em>eventDate</em> shall exist.{</p>
<p>"code": -10906,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The eventDate element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>eventDate</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -10907,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>For the JSON name <em>eventDate</em>, the value shall be
syntactically valid time and date according to RFC3339.{</p>
<p>"code": -10908,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value shall be a syntactically valid time and
date according to RFC3339."</p>
<p>}</p>
<p>If the JSON name <em>eventActor</em> exists, the value shall be a
<u>JSON string</u> data type.{</p>
<p>"code": -10909,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the JSON name
<em>eventActor</em> shall also exist.{</p>
<p>"code": -10910,</p>
<p>"value": "&lt;events structure&gt;",</p>
<p>"message": "A links structure was found but an eventActor was
not."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -10911,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>An <em>eventAction</em> value shall only appears once within the
events array.{</p>
<p>"code": -10912,</p>
<p>"value": "&lt;events structure&gt;",</p>
<p>"message": "An eventAction value exists more than once within the
events array."</p>
<p>}</p>
<p><strong><br />
</strong></p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC3339RFC7159RDAP_RFCs<strong><br />
</strong></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapHelpValidation"></a><h3>5.141. rdap-stdRdapHelpValidation - Help validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a help data
structure is valid:</strong></p>
<p>The <em>help</em> data structure must be a syntactically valid JSON
object.{</p>
<p>"code": -12499-12500,</p>
<p>"value": "&lt;help structure&gt;",</p>
<p>"message": "The help structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be <em>notices</em> or
<em>rdapConformance</em>. {</p>
<p>"code": -12501,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: notices or
rdapConformance."</p>
<p>}</p>
<p>The JSON name/values of <em>notices</em> or <em>rdapConformance</em>
shall exist only once. {</p>
<p>"code": -12502,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12503,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists and the entity object is not
the topmost JSON object.{</p>
<p>"code": -12504,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name notices exists but entity
object is not the topmost JSON object."</p>
<p>}</p>
<p>If the JSON name <em>rdapConformance</em> exists, the value shall
pass the test RDAP Conformance validation [stdRdapConformanceValidation]
defined in this document.{</p>
<p>"code": -12505,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass RDAP
Conformance validation [stdRdapConformanceValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapIpAddressesValidation"></a><h3>5.142. rdap-stdRdapIpAddressesValidation - IP Addresses Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that an
ipAddresses data structure is valid:</strong></p>
<p>The <em>ipAddresses</em> data structure must be a syntactically valid
JSON object.{</p>
<p>"code": -11399-11400,</p>
<p>"value": "&lt;ipAddresses structure&gt;",</p>
<p>"message": "The ipAddresses structure is not syntactically
valid."</p>
<p>}</p>
<p>The name of every name/value pair shall be any of: <em>v4</em> or
<em>v6</em>. {</p>
<p>"code": -11401,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: v4 or v6."</p>
<p>}</p>
<p>The JSON name/values of <em>v4</em> and <em>v6</em> shall appear only
once. {</p>
<p>"code": -11402,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of an ipAddresses
structure was found more than once."</p>
<p>}</p>
<p>One <em>v4</em> name/values or one <em>v6</em> name/value shall
appear. {</p>
<p>"code": -11403,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "v4 nor v6 name/value pair exists."</p>
<p>}</p>
<p>If the JSON name <em>v4</em> exists, the value shall pass the
following:</p>
<p>The <em>v4</em> data structure must be a syntactically valid <u>JSON
array</u>.{</p>
<p>"code": -11404,</p>
<p>"value": "&lt;v4 structure&gt;",</p>
<p>"message": "The v4 structure is not syntactically valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -11405,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>The IPv4 address is syntactically valid in dot-decimal notation.{</p>
<p>"code": -11406,</p>
<p>"value": "&lt;IPv4 address string&gt;",</p>
<p>"message": "The IPv4 address is not syntactically valid in
dot-decimal notation."</p>
<p>}</p>
<p>If the JSON name <em>v6</em> exists, the value shall pass the
following:</p>
<p>The <em>v6</em> data structure must be a syntactically valid <u>JSON
array</u>.{</p>
<p>"code": -11407,</p>
<p>"value": "&lt;v6 structure&gt;",</p>
<p>"message": "The v6 structure is not syntactically valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -11408,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>The IPv6 address is syntactically valid.{</p>
<p>"code": -11409,</p>
<p>"value": "&lt;IPv6 address string&gt;",</p>
<p>"message": "The IPv6 address is not syntactically valid."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC791RFC5952RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapLanguageIdentifierValidation"></a><h3>5.143. rdap-stdRdapLanguageIdentifierValidation - Language Identifier Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a lang data
structure is valid:</strong></p>
<p>For the JSON name <em>lang</em>, the value shall conform to the
Language-Tag syntax.{</p>
<p>"code": -10799-10800,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value of the JSON string data in lang does not
conform to Language-Tag syntax."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC5646RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapLdhNameValidation"></a><h3>5.144. rdap-stdRdapLdhNameValidation - LDH name</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a ldhName is
valid:</strong></p>
<p>The length of each label is between 1 and 63.{</p>
<p>"code": -11699-11700,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A DNS label with length not between 1 and 63 was
found."</p>
<p>}</p>
<p>A maximum total length of 253 characters not including the last
".".{</p>
<p>"code": -11701,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name of more than 253 characters was found."</p>
<p>}</p>
<p>At least two labels shall exist in the domain name. See,
RDAP_Technical_Implementation_Guide_2_1 section 1.10.{</p>
<p>"code": -11702,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name with less than two labels was found. See
RDAP_Technical_Implementation_Guide_2_1 section 1.10"</p>
<p>}</p>
<p>Each label of the domain name is a valid "A-label or "NR-LDH
label".{</p>
<p>"code": -11703,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A label not being a valid "A-label" or "NR-LDH label" was
found."</p>
<p>}</p>
<p>Note: the latest version of the IANA IDNA Rules and Derived Property
Values shall be used. See, <a
href="https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml"
class="uri">https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml</a></p>
<p>Note: some legacy gTLDs may fail this test, because they have a few
domain name registrations that comply with IDNA2003 but not IDNA2018.
Such names are not recommended to be used when testing an RDAP response
with this tool.</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>DNS_RFCsIDNA_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapLinksValidation"></a><h3>5.145. rdap-stdRdapLinksValidation - Links validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a links data
structure is valid:</strong></p>
<p>The <em>links</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -10599-10600,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The links structure is not syntactically valid."</p>
<p>}</p>
<p>For every object (i.e. link) of the <u>JSON array</u>, verify that
the <em>link</em> structure complies with:</p>
<p>The name of every name/value pair shall be <em>value</em>,
<em>rel</em>, <em>href</em>, <em>hreflang</em>, <em>title</em>,
<em>media</em> or <em>type</em>.{</p>
<p>"code": -10601,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: value, rel,
href, hreflang, title, media or type."</p>
<p>}</p>
<p>The JSON name/value pairs of <em>rel</em>, <em>href</em>,
<em>hreflang</em>, <em>title</em>, <em>media</em> and <em>type</em>
shall appear only once.{</p>
<p>"code": -10602,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>If the JSON name <em>media</em> exists, the allowed values are:
screen, tty, tv, projection, handheld, print, braille, embossed, speech,
and all.{</p>
<p>"code": -10603,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name media is not of: screen, tty,
tv, projection, handheld, print, braille, embossed, speech, or all."</p>
<p>}</p>
<p>If the JSON name <em>rel</em> exists, the value shall be included as
a "Relation Name" in <strong>linkRelations</strong>.{</p>
<p>"code": -10604,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not included as a Relation Name in
linkRelations."</p>
<p>}</p>
<p>If the JSON name <em>type</em> exists, the value shall be included as
a "Name" in <strong>mediaTypes</strong>.{</p>
<p>"code": -10605,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not included as a Name in
mediaTypes."</p>
<p>}</p>
<p>If the JSON name <em>title</em> exists, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -10606,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>hreflang</em> exists, the value shall be <u>a
JSON string</u> data type or a valid <u>JSON array</u> where every value
is a <u>JSON string</u> data type.{</p>
<p>"code": -10607,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name hreflang is not a JSON string
data type or a valid JSON array where every value is a JSON string data
type."</p>
<p>}</p>
<p>If the JSON name <em>hreflang</em> exists, every one of the <em>JSON
string</em> data values shall conform to the Language-Tag syntax. {</p>
<p>"code": -10608,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value of the JSON string data in the hreflang does
not conform to Language-Tag syntax."</p>
<p>}</p>
<p>If the JSON name <em>value</em> exists, the value shall pass the test
Web URI validation [webUriValidation] defined in this document.{</p>
<p>"code": -10609,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Web URI
validation [webUriValidation]."</p>
<p>}</p>
<p>The JSON name <em>href</em> shall exist.{</p>
<p>"code": -10610,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The href element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>href</em>, the value shall pass the test Web
URI validation [webUriValidation] defined in this document.{</p>
<p>"code": -10611,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name href does not pass Web URI
validation [webUriValidation]."</p>
<p>}</p>
<p><strong><br />
</strong></p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC5646RFC7159RFC8288RDAP_RFCsMedia_Queries</p>
<p><strong><br />
</strong></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapNameserverLookupValidation"></a><h3>5.146. rdap-stdRdapNameserverLookupValidation - Nameserver lookup validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a nameserver
data structure is valid:</strong></p>
<p>The <em>nameserver</em> data structure must be a syntactically valid
JSON object.{</p>
<p>"code": -12399-12400,</p>
<p>"value": "&lt;nameserver structure&gt;",</p>
<p>"message": "The nameserver structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be any of:
<em>objectClassName</em>, <em>handle</em>, <em>ldhName</em>,
<em>unicodeName</em>, <em>ipAddresses</em>, <em>entities</em>,
<em>status</em>, <em>remarks</em>, <em>links</em>, <em>port43</em>,
<em>events</em>, <em>notices</em> or <em>rdapConformance</em>. {</p>
<p>"code": -12401,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of:
objectClassName, handle, ldhName, unicodeName, ipAddresses, entities,
status, remarks, links, port43, events, notices or rdapConformance."</p>
<p>}</p>
<p>The JSON name/values of <em>objectClassName</em>, <em>handle</em>,
<em>ldhName</em>, <em>unicodeName</em>, <em>ipAddresses</em>,
<em>entities</em>, <em>status</em>, <em>remarks</em>, <em>links</em>,
<em>port43</em>, <em>events</em>, <em>notices</em> or
<em>rdapConformance</em> shall exist only once. {</p>
<p>"code": -12402,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>For the JSON name <em>objectClassName</em>, the value shall be
"nameserver".{</p>
<p>"code": -12403,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not "nameserver"."</p>
<p>}</p>
<p>If the JSON name <em>handle</em> exists, the value shall be a JSON
string data type.{</p>
<p>"code": -12404,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>ldhName</em> exists, the value shall pass the
test LDH name [stdRdapLdhNameValidation] defined in this document.{</p>
<p>"code": -12405,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": " The value for the JSON name value does not pass LDH name
[stdRdapLdhNameValidation]."</p>
<p>}</p>
<p>If the JSON name <em>unicodeName</em> exists, the value shall pass
the test Unicode name [stdRdapUnicodeNameValidation] defined in this
document.{</p>
<p>"code": -12406,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Unicode
name [stdRdapUnicodeNameValidation]."</p>
<p>}</p>
<p>If the JSON name <em>ipAddresses</em> exists, the value shall pass
the test IP Addresses Validation [stdRdapIpAddressesValidation] defined
in this document.{</p>
<p>"code": -12407,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass IP
Addresses Validation [stdRdapIpAddressesValidation]."</p>
<p>}</p>
<p>If the JSON name <em>entities</em> exists, the value shall pass the
test Entities validation [stdRdapEntitiesValidation] defined in this
document.{</p>
<p>"code": -12408,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Entities
validation [stdRdapEntitiesValidation]."</p>
<p>}</p>
<p>If the JSON name <em>status</em> exists, the value shall pass the
test Status validation [stdRdapStatusValidation] defined in this
document.{</p>
<p>"code": -12409,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Status
validation [stdRdapStatusValidation]."</p>
<p>}</p>
<p>If the JSON name <em>remarks</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12410,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -12411,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>port43</em> exists, the value shall pass the
test Port 43 WHOIS Server [stdRdapPort43WhoisServerValidation] defined
in this document.{</p>
<p>"code": -12412,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Port 43
WHOIS Server [stdRdapPort43WhoisServerValidation]."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12413,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12414,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists and the entity object is not
the topmost JSON object.{</p>
<p>"code": -12415,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name notices exists but entity
object is not the topmost JSON object."</p>
<p>}</p>
<p>If the JSON name <em>rdapConformance</em> exists, the value shall
pass the test RDAP Conformance validation [stdRdapConformanceValidation]
defined in this document.{</p>
<p>"code": -12416,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass RDAP
Conformance validation [stdRdapConformanceValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapNameserversSearchValidation"></a><h3>5.147. rdap-stdRdapNameserversSearchValidation - Nameservers search validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a
nameserverSearchResults data structure is valid:</strong></p>
<p>The <em>nameserverSearchResults</em> data structure must be a
syntactically valid JSON object.{</p>
<p>"code": -12599-12600,</p>
<p>"value": "&lt;nameserver structure&gt;",</p>
<p>"message": "The nameserver structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be any of:
<em>nameserverSearchResults</em>, <em>remarks</em>, <em>events</em>,
<em>notices</em> or <em>rdapConformance</em>. {</p>
<p>"code": -12601,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of:
nameserverSearchResults, remarks, events, notices or
rdapConformance."</p>
<p>}</p>
<p>The JSON name/values of <em>nameserverSearchResults</em>,
<em>remarks</em>, <em>events</em>, <em>notices</em> or
<em>rdapConformance</em> shall exist only once. {</p>
<p>"code": -12602,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>The <em>nameserverSearchResults</em> data structure must be a
syntactically valid JSON array.{</p>
<p>"code": -12603,</p>
<p>"value": "&lt;nameserverSearchResults structure&gt;",</p>
<p>"message": "The nameserverSearchResults structure is not
syntactically valid."</p>
<p>}</p>
<p>For every object (i.e. nameserver) of the <u>JSON array</u>, verify
that the <em>nameserverSearchResults</em> structure complies with:</p>
<p>The object (i.e. nameserver) shall pass the Nameserver lookup
validation [stdRdapNameserverLookupValidation] test.{</p>
<p>"code": -12604,</p>
<p>"value": "&lt;nameserver object&gt;",</p>
<p>"message": "The nameserver object does not pass Nameserver lookup
validation [stdRdapNameserverLookupValidation]."</p>
<p>}</p>
<p>If the JSON name <em>remarks</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12605,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12606,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists, the value shall pass the
test Notices and Remarks Validation [stdRdapNoticesRemarksValidation]
defined in this document.{</p>
<p>"code": -12607,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Notices
and Remarks Validation [stdRdapNoticesRemarksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>notices</em> exists and the entity object is not
the topmost JSON object.{</p>
<p>"code": -12608,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name notices exists but entity
object is not the topmost JSON object."</p>
<p>}</p>
<p>If the JSON name <em>rdapConformance</em> exists, the value shall
pass the test RDAP Conformance validation [stdRdapConformanceValidation]
defined in this document.{</p>
<p>"code": -12609,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass RDAP
Conformance validation [stdRdapConformanceValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
<h3 id="collection-of-rdap-profile-february-2019-tests">Collection of
RDAP Profile February-2019 tests</h3>
<h4 id="technical-implementation-guide-general">Technical Implementation
Guide – General</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapNoticesRemarksValidation"></a><h3>5.148. rdap-stdRdapNoticesRemarksValidation - Notices and Remarks Validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a notices or
remarks data structure is valid:</strong></p>
<p>The <em>notices</em> or <em>remarks</em> data structure must be a
syntactically valid <u>JSON array</u>.{</p>
<p>"code": -10699-10700,</p>
<p>"value": "&lt;notices or remarks structure&gt;",</p>
<p>"message": "The notices or remarks structure is not syntactically
valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>The name of every name/value pair shall be <em>title</em>,
<em>type</em>, <em>description</em> or <em>links</em>. {</p>
<p>"code": -10701,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: title, type,
description or links."</p>
<p>}</p>
<p>The JSON name/values of <em>title</em>, <em>type</em>,
<em>description</em> and <em>links</em> shall exist only once. {</p>
<p>"code": -10702,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>If the JSON name <em>title</em> exists, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -10703,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -10704,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>type</em> exists, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -10705,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>If the JSON name <em>type</em> exists, the value shall be included in
the <strong>RDAPJSONValues</strong> with Type="notice and remark
type".{</p>
<p>"code": -10706,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="notice and remark type" in the RDAPJSONValues dataset.</p>
<p>}</p>
<p>The JSON name <em>description</em> shall exist.{</p>
<p>"code": -10707,</p>
<p>"value": "&lt;notices or remarks structure&gt;",</p>
<p>"message": "The description element does not exist."</p>
<p>}</p>
<p>The <em>description</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -10708,</p>
<p>"value": "&lt;description structure&gt;",</p>
<p>"message": "The description structure is not syntactically
valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> of the <em>description</em> data
structure shall be a <u>JSON string</u> data type.{</p>
<p>"code": -10709,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapPort43WhoisServerValidation"></a><h3>5.149. rdap-stdRdapPort43WhoisServerValidation - Port 43 WHOIS Server</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a port43 data
structure is valid:</strong></p>
<p>For the JSON name <em>port43</em>, the value shall pass the test
[IPv4Validation], [IPv6Validation] or [DomainNameValidation] defined in
this document.{</p>
<p>"code": -11099-11100,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name port43 does not pass
[IPv4Validation], [IPv6Validation] or [DomainNameValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapPublicIdsValidation"></a><h3>5.150. rdap-stdRdapPublicIdsValidation - Public IDs validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a publicIds
data structure is valid:</strong></p>
<p>The <em>publicIds</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -11199-11200,</p>
<p>"value": "&lt;publicIds structure&gt;",</p>
<p>"message": "The publicIds structure is not syntactically valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>The name of every name/value pairs shall be <em>type</em> or
<em>identifier</em>. {</p>
<p>"code": -11201,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: type or
identifier."</p>
<p>}</p>
<p>The JSON name/values of <em>type</em> or <em>identifier</em> shall
appear only once. {</p>
<p>"code": -11202,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a domain structure was
found more than once."</p>
<p>}</p>
<p>The JSON name/values of <em>type</em> and <em>identifier</em> shall
appear. {</p>
<p>"code": -11203,</p>
<p>"value": "&lt;publicIds structure&gt;",</p>
<p>"message": "The following name/values shall exist: type or
identifier."</p>
<p>}</p>
<p>For the JSON name <em>type</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -11204,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>For the JSON name <em>identifier</em>, the value shall be a <u>JSON
string</u> data type.{</p>
<p>"code": -11205,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapRolesValidation"></a><h3>5.151. rdap-stdRdapRolesValidation - Roles validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a roles data
structure is valid:</strong></p>
<p>The <em>roles</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -11799-11800,</p>
<p>"value": "&lt;roles structure&gt;",</p>
<p>"message": "The roles structure is not syntactically valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -11801,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>Each of the <u>JSON string</u> values in the <u>JSON array</u> shall
be included in the <strong>RDAPJSONValues</strong> with
Type="role".{</p>
<p>"code": -11802,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="role"."</p>
<p>}</p>
<p>The role value shall only appear once in the <u>JSON array</u>.{</p>
<p>"code": -11803,</p>
<p>"value": "&lt;roles structure&gt;",</p>
<p>"message": "A role value appeared more than once."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapSecureDnsValidation"></a><h3>5.152. rdap-stdRdapSecureDnsValidation - Secure DNS validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a secureDNS
data structure is valid:</strong></p>
<p>The <em>secureDNS</em> data structure must be a syntactically valid
JSON object.{</p>
<p>"code": -11999-12000,</p>
<p>"value": "&lt;secureDNS structure&gt;",</p>
<p>"message": "The domain structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pairs shall be <em>zoneSigned</em>,
<em>delegationSigned</em>, <em>maxSigLife</em>, <em>dsData</em> or
<em>keyData</em>. {</p>
<p>"code": -12001,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: zoneSigned,
delegationSigned, maxSigLife, dsData or keyData."</p>
<p>}</p>
<p>The JSON name/values of <em>zoneSigned</em>,
<em>delegationSigned</em>, <em>maxSigLife</em>, <em>dsData</em> and
<em>keyData</em> shall appear only once. {</p>
<p>"code": -12002,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a domain structure was
found more than once."</p>
<p>}</p>
<p>If the JSON name <em>zoneSigned</em> appears, the value shall be a
<u>JSON boolean</u> data type.{</p>
<p>"code": -12003,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a boolean."</p>
<p>}</p>
<p>The JSON name <em>delegationSigned</em> shall appear.{</p>
<p>"code": -12004,</p>
<p>"value": "&lt;links structure&gt;",</p>
<p>"message": "The delegationSigned element does not exist."</p>
<p>}</p>
<p>For the JSON name <em>delegationSigned</em>, the value shall be a
<u>JSON boolean</u> data type.{</p>
<p>"code": -12005,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a boolean."</p>
<p>}</p>
<p>If the JSON name <em>maxSigLife</em> exists, the value shall be a
<u>JSON number</u> data type between 1 and 2147483647.{</p>
<p>"code": -12006,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a number between 1 and
2147483647."</p>
<p>}</p>
<p>One <em>dsData</em> name/values or one <em>keyData</em> name/value
shall appear. {</p>
<p>"code": -12007,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "dsData nor keyData name/value pair exists."</p>
<p>}</p>
<p>If the JSON name <em>dsData</em> appears, the value shall pass the
following:</p>
<p>The <em>dsData</em> data structure must be a syntactically valid JSON
object.{</p>
<p>"code": -12008,</p>
<p>"value": "&lt;dsData structure&gt;",</p>
<p>"message": "The dsData structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pair shall be any of: <em>keyTag</em>,
<em>algorithm</em>, <em>digest</em>, <em>digestType</em>,
<em>events</em> or <em>links</em>. {</p>
<p>"code": -12009,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: keyTag,
algorithm, digest, digestType, events or links."</p>
<p>}</p>
<p>The JSON name/values of <em>keyTag</em>, <em>algorithm</em>,
<em>digest</em>, <em>digestType</em>, <em>events</em> or <em>links</em>
shall appear only once. {</p>
<p>"code": -12010,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a dsData structure was
found more than once."</p>
<p>}</p>
<p>The JSON name/values of <em>keyTag</em>, <em>algorithm</em>,
<em>digest</em> and <em>digestType</em> shall appear. {</p>
<p>"code": -12011,</p>
<p>"value": "&lt;dsData structure&gt;",</p>
<p>"message": "The following name/values shall exist: keyTag, algorithm,
digest and digestType."</p>
<p>}</p>
<p>For the JSON name <em>keyTag</em>, the value shall be a JSON number
data type between 1 and 65535.{</p>
<p>"code": -12012,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a number between 1 and 65535."</p>
<p>}</p>
<p>For the JSON name <em>algorithm</em>, the value shall be a <u>JSON
number</u> listed with Zone Signing=Y in
<strong>dnsSecAlgNumbers</strong>. The values 253 and 254 are not valid
for this test.{</p>
<p>"code": -12013,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not listed with Zone Signing=Y in
dnsSecAlgNumbers, or it's 253 or 254."</p>
<p>}</p>
<p>For the JSON name <em>digest</em>, the value shall be a <u>JSON
string</u> of case-insensitive hexadecimal digits. Whitespace is allowed
within the hexadecimal text.{</p>
<p>"code": -12014,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string of case-insensitive
hexadecimal digits. Whitespace is allowed within the hexadecimal
test."</p>
<p>}</p>
<p>For the JSON name <em>digestType</em>, the value shall be a <u>JSON
number</u> assigned in <strong>dsRrTypes</strong>. {</p>
<p>"code": -12015,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not assigned in dsRrTypes."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12016,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -12017,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p>If the JSON name <em>keyData</em> exists, the value shall pass the
following:</p>
<p>The <em>keyData</em> data structure must be a syntactically valid
JSON object.{</p>
<p>"code": -12018,</p>
<p>"value": "&lt;keyData structure&gt;",</p>
<p>"message": "The keyData structure is not syntactically valid."</p>
<p>}</p>
<p>The name of every name/value pair shall be <em>flags</em>,
<em>protocol</em>, <em>publicKey</em>, <em>algorithm</em>,
<em>events</em> or <em>links</em>. {</p>
<p>"code": -12019,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: flags,
protocol, publicKey, algorithm, events or links."</p>
<p>}</p>
<p>The JSON name/values of <em>flags</em>, <em>protocol</em>,
<em>publicKey</em>, <em>algorithm</em>, <em>events</em> or
<em>links</em> shall appear only once. {</p>
<p>"code": -12020,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a keyData structure
was found more than once."</p>
<p>}</p>
<p>The JSON name/values of <em>flags</em>, <em>protocol</em>,
<em>publicKey</em> and <em>algorithm</em> shall appear. {</p>
<p>"code": -12021,</p>
<p>"value": "&lt;dsData structure&gt;",</p>
<p>"message": "The following name/values shall exist: flags, protocol,
publicKey and algorithm."</p>
<p>}</p>
<p>For the JSON name <em>flags</em>, the value shall be a <u>JSON
number</u> data type with values: 256 or 257.{</p>
<p>"code": -12022,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not 256 or 257."</p>
<p>}</p>
<p>For the JSON name <em>protocol</em>, the value shall be a <u>JSON
number</u> data type with value: 3.{</p>
<p>"code": -12023,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not 3."</p>
<p>}</p>
<p>For the JSON name <em>publicKey</em>, the value shall be a <u>JSON
string</u>, and the key is represented as a Base64. Whitespace is
allowed within the text.{</p>
<p>"code": -12024,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string of case-insensitive
hexadecimal digits. Whitespace is allowed within the hexadecimal
text."</p>
<p>}</p>
<p>For the JSON name <em>algorithm</em>, the value shall be a JSON
number listed with Zone Signing=Y in <strong>dnsSecAlgNumbers</strong>.
The values 253 and 254 are not valid for this test.{</p>
<p>"code": -12025,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not listed with Zone Signing=Y in
dnsSecAlgNumbers, or it's 253 or 254."</p>
<p>}</p>
<p>If the JSON name <em>events</em> exists, the value shall pass the
test Events Validation [stdRdapEventsValidation] defined in this
document.{</p>
<p>"code": -12026,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Events
Validation [stdRdapEventsValidation]."</p>
<p>}</p>
<p>If the JSON name <em>links</em> exists, the value shall pass the test
Links validation [stdRdapLinksValidation] defined in this document.{</p>
<p>"code": -12027,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Links
validation [stdRdapLinksValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCsDNSSEC_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapStatusValidation"></a><h3>5.153. rdap-stdRdapStatusValidation - Status validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a status data
structure is valid:</strong></p>
<p>The <em>status</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -10999-11000,</p>
<p>"value": "&lt;status structure&gt;",</p>
<p>"message": "The status structure is not syntactically valid."</p>
<p>}</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -11001,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>Each of the <u>JSON string</u> values in the <u>JSON array</u> shall
be included in the <strong>RDAPJSONValues</strong> with
Type="status".{</p>
<p>"code": -11002,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="status"."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC7159RDAP_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapUnicodeNameValidation"></a><h3>5.154. rdap-stdRdapUnicodeNameValidation - Unicode name</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a unicodeName
is valid:</strong></p>
<p>The length of each label is between 1 and 63.{</p>
<p>"code": -11599-11600,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A DNS label with length not between 1 and 63 was
found."</p>
<p>}</p>
<p>A maximum total length of 253 characters not including the last
".".{</p>
<p>"code": -11601,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name of more than 253 characters was found."</p>
<p>}</p>
<p>At least two labels shall exist in the domain name. See,
RDAP_Technical_Implementation_Guide_2_1 section 1.10.{</p>
<p>"code": -11602,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A domain name with less than two labels was found. See
RDAP_Technical_Implementation_Guide_2_1 section 1.10"</p>
<p>}</p>
<p>Each label of the domain name is a valid "U-label or "NR-LDH label".
{</p>
<p>"code": -11603,</p>
<p>"value": "&lt;domain name&gt;",</p>
<p>"message": "A label not being a valid "U-label" or "NR-LDH label" was
found."</p>
<p>}</p>
<p>Note: the latest version of the IANA IDNA Rules and Derived Property
Values shall be used. See, <a
href="https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml"
class="uri">https://www.iana.org/assignments/idna-tables-11.0.0/idna-tables-11.0.0.xml</a></p>
<p>Note: some legacy gTLDs may fail this test, because they have a few
domain name registrations that comply with IDNA2003 but not IDNA2018.
Such names are not recommended to be used when testing an RDAP response
with this tool.</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>DNS_RFCsIDNA_RFCs</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-stdRdapVariantsValidation"></a><h3>5.155. rdap-stdRdapVariantsValidation - Variants validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a variants
data structure is valid:</strong></p>
<p>The <em>variants</em> data structure must be a syntactically valid
<u>JSON array</u>.{</p>
<p>"code": -11499-11500,</p>
<p>"value": "&lt;variants structure&gt;",</p>
<p>"message": "The variants structure is not syntactically valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>The name of every name/value pair shall be <em>relation</em>,
<em>idnTable</em> or <em>variantNames</em>. {</p>
<p>"code": -11501,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: relation,
idnTable or variantNames."</p>
<p>}</p>
<p>The JSON name/value pairs of <em>relation</em>, <em>idnTable</em> and
<em>variantNames</em> shall appear only once. {</p>
<p>"code": -11502,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>The RDAP <em>relation</em> data structure must be a syntactically
valid <em>JSON array</em>.{</p>
<p>"code": -11503,</p>
<p>"value": "&lt;relation structure&gt;",</p>
<p>"message": "The RDAP Conformance structure is not syntactically
valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>Every value of the <u>JSON array</u> shall be a <u>JSON string</u>
data type.{</p>
<p>"code": -11504,</p>
<p>"value": "&lt;JSON value&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>Each of the <u>JSON string</u> values in the <u>JSON array</u> shall
be included in the <strong>RDAPJSONValues</strong> with Type="domain
variant relation".{</p>
<p>"code": -11505,</p>
<p>"value": "&lt;JSON string&gt;",</p>
<p>"message": "The JSON string is not included as a Value with
Type="domain variant relation "."</p>
<p>}</p>
<p>If the JSON name <em>idnTable</em> exists, the value shall be a
<u>JSON string</u> data type.{</p>
<p>"code": -11506,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The JSON value is not a string."</p>
<p>}</p>
<p>The <em>variantNames</em> data structure must be a syntactically
valid <u>JSON array</u>.{</p>
<p>"code": -11507,</p>
<p>"value": "&lt;variantNames structure&gt;",</p>
<p>"message": "The variantNames structure is not syntactically
valid."</p>
<p>}</p>
<p>For every object of the <u>JSON array</u>, verify that the structure
complies with:</p>
<p>The name of every name/value pair shall be any of: <em>ldhName</em>
or <em>unicodeName</em>{</p>
<p>"code": -11508,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair is not of: ldhName or
unicodeName."</p>
<p>}</p>
<p>The JSON name/value pairs of <em>ldhName</em> or <em>unicodeName</em>
shall exist only once. {</p>
<p>"code": -11509,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The name in the name/value pair of a link structure was
found more than once."</p>
<p>}</p>
<p>If the JSON name title <em>ldhName</em> exists, the value shall pass
the test LDH name [stdRdapLdhNameValidation] defined in this
document.{</p>
<p>"code": -11510,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": " The value for the JSON name value does not pass LDH name
[stdRdapLdhNameValidation]."</p>
<p>}</p>
<p>If the JSON name <em>unicodeName</em> exists, the value shall pass
the test Unicode name [stdRdapUnicodeNameValidation] defined in this
document.{</p>
<p>"code": -11511,</p>
<p>"value": "&lt;name/value pair&gt;",</p>
<p>"message": "The value for the JSON name value does not pass Unicode
name [stdRdapUnicodeNameValidation]."</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_11_1_Validation"></a><h3>5.156. rdap-tigSection_1_11_1_Validation - bootstrap registration</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.11.1 and 1.2 of the
RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Verify that the TLD of the domain name is listed in the
bootstrapDomainNameSpace.{</p>
<p>"code": -23099-23100,</p>
<p>"value": "&lt;TLD&gt; + "\n/\n"
&lt;bootstrapDomainNameSpace&gt;",</p>
<p>"message": "The TLD is not included in the bootstrapDomainNameSpace.
See section 1.11.1 of the RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p>Validate that at least one base URL exists in the
bootstrapDomainNameSpace for the TLD.{</p>
<p>"code": -23101,</p>
<p>"value": "&lt;TLD element in bootstrapDomainNameSpace&gt;",</p>
<p>"message": "The TLD entry in bootstrapDomainNameSpace does not
contain a base URL. See section 1.11.1 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p>For the entry of the TLD in bootstrapDomainNameSpace verify that
every of the base URLs contain a schema of "https".{</p>
<p>"code": -23102,</p>
<p>"value": "&lt;TLD entry in bootstrapDomainNameSpace&gt;",</p>
<p>"message": "One or more of the base URLs for the TLD contain a schema
different from https. See section 1.2 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_13_Validation"></a><h3>5.157. rdap-tigSection_1_13_Validation - Access-Control-Allow-Origin header</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.13 of the
RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Validate that the HTTP header "Access-Control-Allow-Origin: *" is
included in the RDAP response.{</p>
<p>"code": -20499-20500,</p>
<p>"value": "&lt;HTTP headers&gt;",</p>
<p>"message": "The HTTP header "Access-Control-Allow-Origin: *" is not
included in the HTTP headers. See section 1.13 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p>Note: the test [tigSection_1_13_Validation] shall be performed on the
URL on every HTTP redirect.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_14_Validation"></a><h3>5.158. rdap-tigSection_1_14_Validation - presence of &#34;icann_rdap_technical_implementation_guide_0&#34; in &#34;rdapConformance&#34;</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.14 of the
RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Validate that the JSON string value
"icann_rdap_technical_implementation_guide_0" is included in the RDAP
Conformance data structure.{</p>
<p>"code": -20599-20600,</p>
<p>"value": "&lt;rdapConformance data structure&gt;",</p>
<p>"message": "The RDAP Conformance data structure does not include
icann_rdap_technical_implementation_guide_0. See section 1.14 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_2_Validation"></a><h3>5.159. rdap-tigSection_1_2_Validation - use of HTTPS</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.2 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>If the scheme of the URI to be tested is "http":{</p>
<p>"code": -20099-20100,</p>
<p>"value": "&lt;URI&gt;",</p>
<p>"message": "The URL is HTTP, per section 1.2 of the
RDAP_Technical_Implementation_Guide_2_1 shall be HTTPS only."</p>
<p>}</p>
<p>If the scheme of the URI to be tested is "https", perform the same
RDAP query using "http". If the RDAP response provided over "HTTP" and
"HTTPS" without considering the value of "last update of RDAP database"
is the same: {</p>
<p>"code": -20101,</p>
<p>"value": "&lt;RDAP response provided over HTTP&gt; + "\n/\n" &lt;RDAP
response provided over HTTPS&gt;",</p>
<p>"message": "The RDAP response was provided over HTTP, per section 1.2
of the RDAP_Technical_Implementation_Guide_2_1 shall be HTTPS only."</p>
<p>}</p>
<p>Note: the test [tigSection_1_2_Validation] shall be performed on the
URL on every HTTP redirect.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_3_Validation"></a><h3>5.160. rdap-tigSection_1_3_Validation - use of obsolete SSL/TLS versions</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.3 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>If the scheme of the URI to be tested is "https", verify that SSLv2
and SSLv3 are not offered by the RDAP server.{</p>
<p>"code": -20199-20200,</p>
<p>"value": "&lt;URI&gt;",</p>
<p>"message": "The RDAP server is offering SSLv2 and/or SSLv3."</p>
<p>}</p>
<p>Note: the test [tigSection_1_3_Validation] shall be performed on the
URL on every HTTP redirect.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_6_Validation"></a><h3>5.161. rdap-tigSection_1_6_Validation - support for HEAD</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.6 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>The tool shall use the HTTP HEAD method on the URI to be tested. If
the HTTP Status code is different from the status code obtained when
doing the GET method:{</p>
<p>"code": -20299-20300,</p>
<p>"value": "&lt;HTTP Status code when using the GET method&gt; "\n/\n"
"&lt;HTTP Status code when using the HEAD method&gt;",</p>
<p>"message": "The HTTP Status code obtained when using the HEAD method
is different from the GET method. See section 1.6 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_1_8_Validation"></a><h3>5.162. rdap-tigSection_1_8_Validation - IPv4/IPv6 resolvability</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 1.8 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Obtain the Resource Record for the A QTYPE for the host in the URI.
Validate that the status of the DNS response is not NOERROR. Validate
that all IPv4 addresses in the RDATA pass IPv4 address validation
[ipv4Validation]:{</p>
<p>"code": -20399-20400,</p>
<p>"value": "&lt;IPv4 addresses&gt;",</p>
<p>"message": "The RDAP service is not provided over IPv4. See section
1.8 of the RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p>Obtain the Resource Record for the AAAA QTYPE for the host in the
URI. Validate that the status of the DNS response is not NOERROR.
Validate that all IPv6 addresses in the RDATA pass IPv6 address
validation [ipv6Validation]:{</p>
<p>"code": -20401,</p>
<p>"value": "&lt;IPv6 addresses&gt;",</p>
<p>"message": "The RDAP service is not provided over IPv6. See section
1.8 of the RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p>Note: the test [tigSection_1_8_Validation] shall be performed on the
URL on every HTTP redirect.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_3_2_Validation"></a><h3>5.163. rdap-tigSection_3_2_Validation - rel=&#34;related&#34; link in topmost object</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 3.2 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Validate that a links data structure in the topmost object exists,
and the links object shall contain the elements <em>rel</em>:related and
<em>href</em>.{</p>
<p>"code": -23199-23200,</p>
<p>"value": "&lt;links data structure&gt;",</p>
<p>"message": "A links data structure in the topmost object exists, and
the links object shall contain the elements rel:related and href, but
they were not found. See section 3.2 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p><mark><br />
</mark></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_3_3_and_3_4_Validation"></a><h3>5.164. rdap-tigSection_3_3_and_3_4_Validation - presence of link object(s) in notice(s)</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 3.3 and 3.4 of the
RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>Validate that at least one links data structure exists within the
notices object in the topmost object.{</p>
<p>"code": -20699-20700,</p>
<p>"value": "&lt;notices data structure&gt;",</p>
<p>"message": "A links object was not found in the notices object in the
topmost object. See section 3.3 and 3.4 of the
RDAP_Technical_Implementation_Guide_2_1."</p>
<p>}</p>
<p><mark><br />
</mark></p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_4_1_Validation"></a><h3>5.165. rdap-tigSection_4_1_Validation - structured addresses in entity jCards</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 4.1 of the TIG:</strong></p>
<p>Validate that all the <em>entities</em> in the RDAP Response contain
structured address. If a street address has more than one line, it MUST
be structured as an array of strings. {</p>
<p>"code": -20799-20800,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "An entity with a non-structured address was found. See
section 4.1 of the TIG."</p>
<p>}</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_6_1_Validation"></a><h3>5.166. rdap-tigSection_6_1_Validation - publicIds property of registrar entity</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 6.1 of the RDAP_Technical_Implementation_Guide_2_1:</strong></p>
<p>For the <em>entity</em> with the registrar role within the domain
object, validate that a <em>publicIds</em> member is included. {</p>
<p>"code": -23299-23300,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "A publicIds member is not included in the entity with the
registrar role."</p>
<p>}</p>
<p>For the <em>entity</em> with the registrar role within the domain
object, if a <em>publicIds</em> member is included, validate that the
identifier member is a positive integer.{</p>
<p>"code": -23301,</p>
<p>"value": "&lt;publicIds data structure&gt;",</p>
<p>"message": "The identifier of the publicIds member of the entity with
the registrar role is not a positive integer."</p>
<p>}</p>
<h4 id="technical-implementation-guide-registrar">Technical
Implementation Guide – Registrar</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-tigSection_7_1_and_7_2_Validation"></a><h3>5.167. rdap-tigSection_7_1_and_7_2_Validation - voice/fax type for tel nodes in entity jCards</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test the RDAP protocol
section 7.1 and 7.2 of the TIG:</strong></p>
<p>Validate that at all the <em>tel</em> properties in the
<em>entities</em> in the RDAP Response contain voice or fax as type
parameter. {</p>
<p>"code": -20899-20900,</p>
<p>"value": "&lt;entity data structure&gt;",</p>
<p>"message": "An entity with a tel property without a voice or fax type
was found. See section 7.1 and 7.2 of the TIG."</p>
<p>}</p>
<h4 id="technical-implementation-guide---registry">Technical
Implementation Guide - Registry</h4>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rdap-webUriValidation"></a><h3>5.168. rdap-webUriValidation - Web URI validation</h3><h4>Description</h4><div class="markdown-content"><p><strong>The following steps should be used to test that a <em>Web
URI</em> is valid:</strong></p>
<p>The URI shall be syntactically valid according to RFC3986.{</p>
<p>"code": -10399-10400,</p>
<p>"value": "&lt;URI&gt;",</p>
<p>"message": "The URI is not syntactically valid according to
RFC3986."</p>
<p>}</p>
<p>The scheme of the URI shall be "http" or "https".{</p>
<p>"code": -10401,</p>
<p>"value": "&lt;URI&gt;",</p>
<p>"message": "The scheme of the URI is not 'http' nor 'https'".</p>
<p>}</p>
<p>The host of the URI shall pass the test Domain Name validation
[domainNameValidation], IPv4 address validation [ipv4Validation] or IPv6
address validation [ipv6Validation].{</p>
<p>"code": -10402,</p>
<p>"value": "&lt;URI&gt;",</p>
<p>"message": "The host does not pass Domain Name validation
[domainNameValidation], IPv4 address validation [ipv4Validation] nor
IPv6 address validation [ipv6Validation]".</p>
<p>}</p>
<p><strong>The following normative references are required to understand
this test group:</strong></p>
<p>RFC3986</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDDS">Registration Data Directory Services (RDDS)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-01"></a><h3>5.169. rde-01 - validate filename format</h3><h4>Description</h4><div class="markdown-content"><p>the deposit filename must conform to the format specified in the
RA.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-02"></a><h3>5.170. rde-02 - validate signature(s)</h3><h4>Description</h4><div class="markdown-content"><p>the signature must be valid for the deposit file and the RSP’s
key.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li><li><a href="#Input-Parameter-rde.signature">rde.signature</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-03"></a><h3>5.171. rde-03 - decrypt deposit file(s)</h3><h4>Description</h4><div class="markdown-content"><p>it must be possible to decrypt the deposit file using the RST
key.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-04"></a><h3>5.172. rde-04 - validate object types</h3><h4>Description</h4><div class="markdown-content"><p>the header object must reference the correct object XML namespace
URIs.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-06"></a><h3>5.173. rde-06 - validate object counts</h3><h4>Description</h4><div class="markdown-content"><p>the number of each type of object must match the number of objects
actually present in the deposit file.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-07"></a><h3>5.174. rde-07 - validate domain objects</h3><h4>Description</h4><div class="markdown-content"><p>domain objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
<p>Contact and/or host objects which are referenced in domain objects
must be present in the deposit.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-08"></a><h3>5.175. rde-08 - validate host objects (if applicable)</h3><h4>Description</h4><div class="markdown-content"><p>host objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-09"></a><h3>5.176. rde-09 - validate contact objects (if applicable)</h3><h4>Description</h4><div class="markdown-content"><p>contact objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-10"></a><h3>5.177. rde-10 - validate registrar objects</h3><h4>Description</h4><div class="markdown-content"><p>registrar objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-11"></a><h3>5.178. rde-11 - validate IDN table objects</h3><h4>Description</h4><div class="markdown-content"><p>IDN table objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
<p>All IDN table objects present in the deposit must correspond to IDN
tables approved for the TLD, and all approved tables must have a
corresponding object in the deposit.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-idn.tableIDs">idn.tableIDs</a></li><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-12"></a><h3>5.179. rde-12 - validate NNDN objects</h3><h4>Description</h4><div class="markdown-content"><p>NNDN table objects (whether CSV or XML) must have the required object
properties, and the values of those object properties must be
well-formed.</p>
<p>The aName property of NNDN objects must not match the name property
of a domain object.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-rde.deposit">rde.deposit</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-13"></a><h3>5.180. rde-13 - validate EPP parameters object</h3><h4>Description</h4><div class="markdown-content"><p>The EPP Parameters object must match the
<code>&lt;greeting&gt;</code> element returned by the EPP server.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-epp.extensionURIs">epp.extensionURIs</a></li><li><a href="#Input-Parameter-epp.hostModel">epp.hostModel</a></li><li><a href="#Input-Parameter-epp.objectURIs">epp.objectURIs</a></li><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><section><a name="Test-Case-rde-14"></a><h3>5.181. rde-14 - validate policy object</h3><h4>Description</h4><div class="markdown-content"><p>The object policies included in the
<code>&lt;rdePolicy:policy&gt;</code> object must conform to the
Registration Data Policy and the applicable data model.</p>
</div><h4>Dependencies</h4><p>This test case requires the following test cases to have successfully passed:</p>
<ul></ul><h4>Dependants</h4><p>The following test cases require this test case to have successfully passed:</p>
<ul></ul><h4>Input parameters</h4><p>This test case requires the following input parameters:</p>
<ul><li><a href="#Input-Parameter-general.minimumPublicDataSet">general.minimumPublicDataSet</a></li></ul><h4>Test suites</h4><p>This test case is used in the following test suites:</p>
<ul><li><a href="#Test-Suite-StandardRDE">Registry Data Escrow (RDE)</a></li><li><a href="#Test-Suite-LaunchExtensionAndTMCH">Main RSP - Launch Extension &amp; Trademark Clearinghouse (TMCH) Support</a></li></ul></section><a name="input-parameters"></a><h2>6. Input Parameters</h2><section><a name="Input-Parameter-epp.clid"></a><h4>Description</h4><div class="markdown-content"><p>the username used to log in to the EPP server.</p>
</div><h4>Type</h4><pre>string</pre><h4>Example</h4><pre>{
   &#34;epp.clid&#34; : &#34;clid-01&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul></section><section><a name="Input-Parameter-epp.extensionURIs"></a><h4>Description</h4><div class="markdown-content"><p>the list of supported extension namespace URIs.</p>
</div><h4>Type</h4><pre>array</pre><h4>Example</h4><pre>{
   &#34;epp.extensionURIs&#34; : [
      &#34;urn:ietf:params:xml:ns:epp:loginSec-1.0&#34;,
      &#34;urn:ietf:params:xml:ns:epp:fee-1.0&#34;
   ]
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li><li><a href="#Test-Case-epp-39">epp-39 - domain restore test (if applicable)</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li></ul></section><section><a name="Input-Parameter-epp.hostModel"></a><h4>Description</h4><div class="markdown-content"><p>whether the EPP server supports host <code>objects</code> or host
<code>attributes</code>.</p>
</div><h4>Type</h4><pre>string</pre><h4>Example</h4><pre>{
   &#34;epp.hostModel&#34; : &#34;objects&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-22">epp-22 - host &lt;check&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-28">epp-28 - host &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-29">epp-29 - host &lt;info&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-30">epp-30 - host &lt;update&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-31">epp-31 - host &lt;delete&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-32">epp-32 - domain &lt;create&gt; command test (if applicable)</a></li><li><a href="#Test-Case-epp-38">epp-38 - host rename test (if applicable)</a></li><li><a href="#Test-Case-rde-08">rde-08 - validate host objects (if applicable)</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li></ul></section><section><a name="Input-Parameter-epp.hostname"></a><h4>Description</h4><div class="markdown-content"><p>the fully-qualified domain name of the EPP server.</p>
</div><h4>Type</h4><pre>string</pre><h4>Example</h4><pre>{
   &#34;epp.hostname&#34; : &#34;epp.rsp.tech&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-01">epp-01 - EPP server must have at least one A record</a></li><li><a href="#Test-Case-epp-02">epp-02 - EPP server must have at least one AAAA record</a></li><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul></section><section><a name="Input-Parameter-epp.objectURIs"></a><h4>Description</h4><div class="markdown-content"><p>the list of supported object namespace URIs.</p>
</div><h4>Type</h4><pre>array</pre><h4>Example</h4><pre>{
   &#34;epp.objectURIs&#34; : [
      &#34;urn:ietf:params:xml:ns:domain-1.0&#34;,
      &#34;urn:ietf:params:xml:ns:host-1.0&#34;
   ]
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li></ul></section><section><a name="Input-Parameter-epp.port"></a><h4>Description</h4><div class="markdown-content"><p>the TCP port of the EPP service.</p>
</div><h4>Type</h4><pre>integer</pre><h4>Example</h4><pre>{
   &#34;epp.port&#34; : 700
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li></ul></section><section><a name="Input-Parameter-epp.pwd"></a><h4>Description</h4><div class="markdown-content"><p>the password used to log in to the EPP server.</p>
</div><h4>Type</h4><pre>string</pre><h4>Example</h4><pre>{
   &#34;epp.pwd&#34; : &#34;foo2bar&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-17">epp-17 - &lt;login&gt; command must return a successful response</a></li></ul></section><section><a name="Input-Parameter-general.minimumPublicDataSet"></a><h4>Description</h4><div class="markdown-content"><p>if true, then the registry only supports the minimum public data set,
and does not collect registrant and/or technical contact information
from registrars.</p>
</div><h4>Type</h4><pre>boolean</pre><h4>Example</h4><pre>{
   &#34;general.minimumPublicDataSet&#34; : &#34;1&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-epp-09">epp-09 - All service ports must send a &lt;greeting&gt; frame after successful connection</a></li><li><a href="#Test-Case-epp-15">epp-15 - &lt;objURI&gt; element(s) in the &lt;greeting&gt; must be valid for the registry type</a></li><li><a href="#Test-Case-epp-16">epp-16 - &lt;extURI&gt; element(s) in the &lt;greeting&gt; must be valid</a></li><li><a href="#Test-Case-epp-23">epp-23 - contact &lt;check&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-24">epp-24 - contact &lt;create&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-25">epp-25 - contact &lt;info&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-26">epp-26 - contact &lt;update&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-epp-27">epp-27 - contact &lt;delete&gt; command test (if applicable for the registry type)</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-07">rde-07 - validate domain objects</a></li><li><a href="#Test-Case-rde-09">rde-09 - validate contact objects (if applicable)</a></li><li><a href="#Test-Case-rde-13">rde-13 - validate EPP parameters object</a></li><li><a href="#Test-Case-rde-14">rde-14 - validate policy object</a></li></ul></section><section><a name="Input-Parameter-general.sunriseModel"></a><h4>Description</h4><div class="markdown-content"><p>whether the EPP server supports <code>startDate</code> or
<code>endDate</code> sunrises.</p>
</div><h4>Type</h4><pre>string</pre><h4>Example</h4><pre>{
   &#34;general.sunriseModel&#34; : &#34;startDate&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-eppLaunch-01">eppLaunch-01 - launch application sunrise &lt;info&gt; command test</a></li><li><a href="#Test-Case-eppLaunch-02">eppLaunch-02 - domain/launch application sunrise &lt;create&gt; command test
</a></li></ul></section><section><a name="Input-Parameter-idn.tableIDs"></a><h4>Description</h4><div class="markdown-content"><p>the list of supported IDN tables.</p>
</div><h4>Type</h4><pre>array</pre><h4>Example</h4><pre>{
   &#34;idn.tableIDs&#34; : [
      &#34;latn&#34;,
      &#34;arab&#34;,
      &#34;zh&#34;,
      &#34;fr_FR&#34;
   ]
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-rde-11">rde-11 - validate IDN table objects</a></li></ul></section><section><a name="Input-Parameter-rde.deposit"></a><h4>Description</h4><div class="markdown-content"><p>an RDE deposit file.</p>
</div><h4>Type</h4><pre>file</pre><h4>Example</h4><pre>{
   &#34;rde.deposit&#34; : &#34;example_20231004_FULL_S1_R0.ryde&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-rde-01">rde-01 - validate filename format</a></li><li><a href="#Test-Case-rde-02">rde-02 - validate signature(s)</a></li><li><a href="#Test-Case-rde-03">rde-03 - decrypt deposit file(s)</a></li><li><a href="#Test-Case-rde-04">rde-04 - validate object types</a></li><li><a href="#Test-Case-rde-06">rde-06 - validate object counts</a></li><li><a href="#Test-Case-rde-07">rde-07 - validate domain objects</a></li><li><a href="#Test-Case-rde-08">rde-08 - validate host objects (if applicable)</a></li><li><a href="#Test-Case-rde-09">rde-09 - validate contact objects (if applicable)</a></li><li><a href="#Test-Case-rde-10">rde-10 - validate registrar objects</a></li><li><a href="#Test-Case-rde-11">rde-11 - validate IDN table objects</a></li><li><a href="#Test-Case-rde-12">rde-12 - validate NNDN objects</a></li></ul></section><section><a name="Input-Parameter-rde.signature"></a><h4>Description</h4><div class="markdown-content"><p>an RDE deposit signature.</p>
</div><h4>Type</h4><pre>file</pre><h4>Example</h4><pre>{
   &#34;rde.signature&#34; : &#34;example_20231004_FULL_S1_R0.sig&#34;
}
</pre><h4>Test cases</h4><p>This input parameter is used in the following test cases:</p>
<ul><li><a href="#Test-Case-rde-02">rde-02 - validate signature(s)</a></li></ul></section></main></body></html>